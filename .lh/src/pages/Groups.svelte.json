{
    "sourceFile": "src/pages/Groups.svelte",
    "activeCommit": 0,
    "commits": [
        {
            "activePatchIndex": 34,
            "patches": [
                {
                    "date": 1763988763215,
                    "content": "Index: \n===================================================================\n--- \n+++ \n"
                },
                {
                    "date": 1763988773413,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -129,11 +129,11 @@\n   async function handleGenerateBrackets() {\r\n       if (confirm('Finish Group Stage and Generate Brackets?')) {\r\n           try {\r\n               console.log('[Groups] Generating brackets...');\r\n-              await generateBrackets();\r\n+              await generateBrackets(tournamentId);\r\n               console.log('[Groups] Brackets generated, redirecting...');\r\n-              window.location.href = '/brackets';\r\n+              window.location.href = `/tournament/${tournamentId}/brackets`;\r\n           } catch (error) {\r\n               console.error('[Groups] Error generating brackets:', error);\r\n               alert('Failed to generate brackets. Check console for details.');\r\n           }\r\n"
                },
                {
                    "date": 1763989545492,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1,8 +1,10 @@\n <script lang=\"ts\">\r\n   import { onMount } from 'svelte';\r\n   import { getState, submitMatch, generateBrackets } from '$lib/api';\r\n \r\n+  let { tournamentId } = $props<{ tournamentId: string }>();\r\n+\r\n   let pods = $state([]) as any[];\r\n   let matches = $state([]) as any[];\r\n   let players = $state([]) as any[];\r\n   let tournamentState = $state('');\r\n"
                },
                {
                    "date": 1764013184444,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1,7 +1,7 @@\n <script lang=\"ts\">\r\n   import { onMount } from 'svelte';\r\n-  import { getState, submitMatch, generateBrackets } from '$lib/api';\r\n+  import { getState, submitMatch, generateBrackets, updateGroupName, resetGroupData } from '$lib/api';\r\n \r\n   let { tournamentId } = $props<{ tournamentId: string }>();\r\n \r\n   let pods = $state([]) as any[];\r\n"
                },
                {
                    "date": 1764013221835,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -11,8 +11,12 @@\n   let currentRound = $state(1);\r\n \r\n   // Local state to track UI selections before submission\r\n   let matchSelections = $state({}) as Record<string, { [pid: string]: 'win' | 'loss' | 'tie' }>;\r\n+\r\n+  // Group editing state\r\n+  let editingGroupId = $state(null) as string | null;\r\n+  let editingGroupName = $state('');\r\n   \r\n   // Reactive derived values using $derived\r\n   let currentRoundMatches = $derived(getMatchesForRound(currentRound));\r\n   let groupsWithPlayers = $derived(getGroupsWithPlayers());\r\n"
                },
                {
                    "date": 1764013232380,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -15,8 +15,48 @@\n \r\n   // Group editing state\r\n   let editingGroupId = $state(null) as string | null;\r\n   let editingGroupName = $state('');\r\n+\r\n+  // Group name editing functions\r\n+  function startEditingGroup(groupId: string, currentName: string) {\r\n+    editingGroupId = groupId;\r\n+    editingGroupName = currentName || `Group ${groupId}`;\r\n+  }\r\n+\r\n+  function cancelEditingGroup() {\r\n+    editingGroupId = null;\r\n+    editingGroupName = '';\r\n+  }\r\n+\r\n+  async function saveGroupName(groupId: string) {\r\n+    try {\r\n+      await updateGroupName(tournamentId, groupId, editingGroupName.trim());\r\n+      await loadState();\r\n+      editingGroupId = null;\r\n+      editingGroupName = '';\r\n+    } catch (error) {\r\n+      console.error('Failed to update group name:', error);\r\n+      alert('Failed to update group name');\r\n+    }\r\n+  }\r\n+\r\n+  async function handleResetGroup(groupId: string) {\r\n+    if (confirm('Reset all match results for this group? This will clear all player stats in this group.')) {\r\n+      try {\r\n+        await resetGroupData(tournamentId, groupId);\r\n+        await loadState();\r\n+      } catch (error) {\r\n+        console.error('Failed to reset group data:', error);\r\n+        alert('Failed to reset group data');\r\n+      }\r\n+    }\r\n+  }\r\n+\r\n+  function getGroupDisplayName(groupId: string) {\r\n+    const pod = pods.find(p => p.id === groupId);\r\n+    return pod?.name || `Group ${groupId}`;\r\n+  }\r\n   \r\n   // Reactive derived values using $derived\r\n   let currentRoundMatches = $derived(getMatchesForRound(currentRound));\r\n   let groupsWithPlayers = $derived(getGroupsWithPlayers());\r\n@@ -43,19 +83,19 @@\n     \r\n     // With $state, direct assignment triggers reactivity\r\n     pods = data.pods;\r\n     matches = data.matches;\r\n-    players = data.players;\r\n-    tournamentState = data.state;\r\n-    \r\n-    // Initialize selections from existing results\r\n-    matches.forEach(m => {\r\n-        if (m.result) {\r\n-            matchSelections[m.id] = {};\r\n-            Object.entries(m.result).forEach(([pid, res]: [string, any]) => {\r\n-                if (res.points === 3) matchSelections[m.id][pid] = 'win';\r\n-                else if (res.points === 1) matchSelections[m.id][pid] = 'tie';\r\n-                else matchSelections[m.id][pid] = 'loss';\r\n+        await loadState();\r\n+      } catch (error) {\r\n+        console.error('Failed to reset group data:', error);\r\n+        alert('Failed to reset group data');\r\n+      }\r\n+    }\r\n+  }\r\n+\r\n+  function getGroupDisplayName(groupId: string) {\r\n+    const pod = pods.find(p => p.id === groupId);\r\n+    return pod?.name || `Group ${groupId}`;\r\n             });\r\n         }\r\n     });\r\n     \r\n"
                },
                {
                    "date": 1764013261322,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -79,27 +79,27 @@\n       matchesCount: data.matches.length,\r\n       playersCount: data.players.length,\r\n       state: data.state\r\n     });\r\n-    \r\n+\r\n     // With $state, direct assignment triggers reactivity\r\n     pods = data.pods;\r\n     matches = data.matches;\r\n-        await loadState();\r\n-      } catch (error) {\r\n-        console.error('Failed to reset group data:', error);\r\n-        alert('Failed to reset group data');\r\n-      }\r\n-    }\r\n-  }\r\n+    players = data.players;\r\n+    tournamentState = data.state;\r\n \r\n-  function getGroupDisplayName(groupId: string) {\r\n-    const pod = pods.find(p => p.id === groupId);\r\n-    return pod?.name || `Group ${groupId}`;\r\n+    // Initialize selections from existing results\r\n+    matches.forEach(m => {\r\n+        if (m.result) {\r\n+            matchSelections[m.id] = {};\r\n+            Object.entries(m.result).forEach(([pid, res]: [string, any]) => {\r\n+                if (res.points === 3) matchSelections[m.id][pid] = 'win';\r\n+                else if (res.points === 1) matchSelections[m.id][pid] = 'tie';\r\n+                else matchSelections[m.id][pid] = 'loss';\r\n             });\r\n         }\r\n     });\r\n-    \r\n+\r\n     console.log('[Groups] loadState() complete - matchSelections:', matchSelections);\r\n   }\r\n \r\n   function getPlayerName(id: string) {\r\n"
                },
                {
                    "date": 1764013275546,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -285,9 +285,56 @@\n       </h2>\r\n       <div class=\"grid grid-cols-1 md:grid-cols-2 gap-3\">\r\n         {#each Object.entries(groupsWithPlayers) as [groupId, groupPlayers] (groupId)}\r\n           <div class=\"glass rounded-lg p-2\">\r\n-            <h3 class=\"text-xs font-bold text-cyber-blue mb-1.5 px-2\">Group {groupId}</h3>\r\n+            <!-- Group Header with Edit and Reset -->\r\n+            <div class=\"flex items-center justify-between mb-1.5 px-2\">\r\n+              {#if editingGroupId === groupId}\r\n+                <div class=\"flex items-center gap-2 flex-1\">\r\n+                  <input\r\n+                    type=\"text\"\r\n+                    bind:value={editingGroupName}\r\n+                    class=\"flex-1 px-2 py-1 text-xs bg-space-700 border border-cyber-blue rounded text-white placeholder-gray-400 focus:outline-none focus:ring-1 focus:ring-cyber-green\"\r\n+                    placeholder=\"Group name...\"\r\n+                    onkeydown={(e) => {\r\n+                      if (e.key === 'Enter') saveGroupName(groupId);\r\n+                      if (e.key === 'Escape') cancelEditingGroup();\r\n+                    }}\r\n+                  />\r\n+                  <button\r\n+                    onclick={() => saveGroupName(groupId)}\r\n+                    class=\"px-2 py-1 text-xs bg-cyber-green text-space-900 rounded font-bold hover:bg-cyber-green/80\"\r\n+                  >\r\n+                    ✓\r\n+                  </button>\r\n+                  <button\r\n+                    onclick={cancelEditingGroup}\r\n+                    class=\"px-2 py-1 text-xs bg-gray-600 text-white rounded font-bold hover:bg-gray-500\"\r\n+                  >\r\n+                    ✕\r\n+                  </button>\r\n+                </div>\r\n+              {:else}\r\n+                <h3\r\n+                  class=\"text-xs font-bold text-cyber-blue cursor-pointer hover:text-cyber-green transition-colors flex-1\"\r\n+                  onclick={() => startEditingGroup(groupId, getGroupDisplayName(groupId))}\r\n+                >\r\n+                  {getGroupDisplayName(groupId)}\r\n+                  <svg class=\"w-3 h-3 inline-block ml-1 opacity-50\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n+                    <path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z\"/>\r\n+                  </svg>\r\n+                </h3>\r\n+              {/if}\r\n+              <button\r\n+                onclick={() => handleResetGroup(groupId)}\r\n+                class=\"px-2 py-1 text-xs bg-red-600 text-white rounded font-bold hover:bg-red-500 transition-colors\"\r\n+                title=\"Reset group data\"\r\n+              >\r\n+                <svg class=\"w-3 h-3\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n+                  <path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15\"/>\r\n+                </svg>\r\n+              </button>\r\n+            </div>\r\n             <table class=\"w-full text-xs\">\r\n               <thead>\r\n                 <tr class=\"border-b border-space-600\">\r\n                   <th class=\"text-left py-1 px-1 text-gray-400 font-bold text-xs\">#</th>\r\n"
                },
                {
                    "date": 1764013645935,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -313,10 +313,10 @@\n                     ✕\r\n                   </button>\r\n                 </div>\r\n               {:else}\r\n-                <h3\r\n-                  class=\"text-xs font-bold text-cyber-blue cursor-pointer hover:text-cyber-green transition-colors flex-1\"\r\n+                <button\r\n+                  class=\"text-xs font-bold text-cyber-blue hover:text-cyber-green transition-colors flex-1 text-left\"\r\n                   onclick={() => startEditingGroup(groupId, getGroupDisplayName(groupId))}\r\n                 >\r\n                   {getGroupDisplayName(groupId)}\r\n                   <svg class=\"w-3 h-3 inline-block ml-1 opacity-50\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n"
                },
                {
                    "date": 1764014027317,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1,7 +1,7 @@\n <script lang=\"ts\">\r\n   import { onMount } from 'svelte';\r\n-  import { getState, submitMatch, generateBrackets, updateGroupName, resetGroupData } from '$lib/api';\r\n+  import { getState, submitMatch, generateBrackets, updateGroupName, resetGroupData, resetTournament } from '$lib/api';\r\n \r\n   let { tournamentId } = $props<{ tournamentId: string }>();\r\n \r\n   let pods = $state([]) as any[];\r\n@@ -321,9 +321,9 @@\n                   {getGroupDisplayName(groupId)}\r\n                   <svg class=\"w-3 h-3 inline-block ml-1 opacity-50\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n                     <path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z\"/>\r\n                   </svg>\r\n-                </h3>\r\n+                </button>\r\n               {/if}\r\n               <button\r\n                 onclick={() => handleResetGroup(groupId)}\r\n                 class=\"px-2 py-1 text-xs bg-red-600 text-white rounded font-bold hover:bg-red-500 transition-colors\"\r\n"
                },
                {
                    "date": 1764014882466,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -51,8 +51,20 @@\n       }\r\n     }\r\n   }\r\n \r\n+  async function handleResetTournament() {\r\n+    if (confirm('Reset the entire tournament? This will delete ALL tournament data including players, groups, matches, and brackets. This action cannot be undone.')) {\r\n+      try {\r\n+        await resetTournament(tournamentId);\r\n+        window.location.href = '/';\r\n+      } catch (error) {\r\n+        console.error('Failed to reset tournament:', error);\r\n+        alert('Failed to reset tournament');\r\n+      }\r\n+    }\r\n+  }\r\n+\r\n   function getGroupDisplayName(groupId: string) {\r\n     const pod = pods.find(p => p.id === groupId);\r\n     return pod?.name || `Group ${groupId}`;\r\n   }\r\n"
                },
                {
                    "date": 1764014892777,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -482,8 +482,19 @@\n                 </div>\r\n               {/if}\r\n             </div>\r\n         {/each}\r\n-      </div>\r\n     </div>\r\n+\r\n+    <!-- Full Tournament Reset Button -->\r\n+    <div class=\"text-center pt-8 border-t border-space-600 mt-8\">\r\n+      <button\r\n+        onclick={() => handleResetTournament()}\r\n+        class=\"text-red-400/70 hover:text-red-400 text-base font-semibold transition-colors hover:underline\"\r\n+      >\r\n+        <svg class=\"w-4 h-4 inline-block mr-1\" fill=\"currentColor\" viewBox=\"0 0 20 20\"><path fill-rule=\"evenodd\" d=\"M9 2a1 1 0 00-.894.553L7.382 4H4a1 1 0 000 2v10a2 2 0 002 2h8a2 2 0 002-2V6a1 1 0 100-2h-3.382l-.724-1.447A1 1 0 0011 2H9zM7 8a1 1 0 012 0v6a1 1 0 11-2 0V8zm5-1a1 1 0 00-1 1v6a1 1 0 102 0V8a1 1 0 00-1-1z\" clip-rule=\"evenodd\"/></svg>\r\n+        Reset Entire Tournament\r\n+      </button>\r\n+    </div>\r\n   </div>\r\n </div>\r\n+</div>\r\n"
                },
                {
                    "date": 1764015149051,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -325,17 +325,19 @@\n                     ✕\r\n                   </button>\r\n                 </div>\r\n               {:else}\r\n-                <button\r\n-                  class=\"text-xs font-bold text-cyber-blue hover:text-cyber-green transition-colors flex-1 text-left\"\r\n-                  onclick={() => startEditingGroup(groupId, getGroupDisplayName(groupId))}\r\n-                >\r\n-                  {getGroupDisplayName(groupId)}\r\n-                  <svg class=\"w-3 h-3 inline-block ml-1 opacity-50\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n-                    <path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z\"/>\r\n-                  </svg>\r\n-                </button>\r\n+                <div class=\"flex items-center gap-2 flex-1\">\r\n+                  <span class=\"text-xs font-bold text-cyber-blue hover:text-cyber-green transition-colors\">\r\n+                    {getGroupDisplayName(groupId)}\r\n+                  </span>\r\n+                  <button\r\n+                    class=\"ml-2 px-2 py-1 text-xs bg-cyber-green text-black rounded hover:bg-cyber-green/80\"\r\n+                    on:click={() => startEditingGroup(groupId, getGroupDisplayName(groupId))}\r\n+                  >\r\n+                    Edit\r\n+                  </button>\r\n+                </div>\r\n               {/if}\r\n               <button\r\n                 onclick={() => handleResetGroup(groupId)}\r\n                 class=\"px-2 py-1 text-xs bg-red-600 text-white rounded font-bold hover:bg-red-500 transition-colors\"\r\n"
                },
                {
                    "date": 1764015412859,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -0,0 +1,502 @@\n+<script lang=\"ts\">\r\n+  import { onMount } from 'svelte';\r\n+  import { getState, submitMatch, generateBrackets, updateGroupName, resetGroupData, resetTournament } from '$lib/api';\r\n+\r\n+  let { tournamentId } = $props<{ tournamentId: string }>();\r\n+\r\n+  let pods = $state([]) as any[];\r\n+  let matches = $state([]) as any[];\r\n+  let players = $state([]) as any[];\r\n+  let tournamentState = $state('');\r\n+  let currentRound = $state(1);\r\n+\r\n+  // Local state to track UI selections before submission\r\n+  let matchSelections = $state({}) as Record<string, { [pid: string]: 'win' | 'loss' | 'tie' }>;\r\n+\r\n+  // Group editing state\r\n+  let editingGroupId = $state(null) as string | null;\r\n+  let editingGroupName = $state('');\r\n+\r\n+  // Group name editing functions\r\n+  function startEditingGroup(groupId: string, currentName: string) {\r\n+    editingGroupId = groupId;\r\n+    editingGroupName = currentName || `Group ${groupId}`;\r\n+  }\r\n+\r\n+  function cancelEditingGroup() {\r\n+    editingGroupId = null;\r\n+    editingGroupName = '';\r\n+  }\r\n+\r\n+  async function saveGroupName(groupId: string) {\r\n+    try {\r\n+      await updateGroupName(tournamentId, groupId, editingGroupName.trim());\r\n+      await loadState();\r\n+      editingGroupId = null;\r\n+      editingGroupName = '';\r\n+    } catch (error) {\r\n+      console.error('Failed to update group name:', error);\r\n+      alert('Failed to update group name');\r\n+    }\r\n+  }\r\n+\r\n+  async function handleResetGroup(groupId: string) {\r\n+    if (confirm('Reset all match results for this group? This will clear all player stats in this group.')) {\r\n+      try {\r\n+        await resetGroupData(tournamentId, groupId);\r\n+        await loadState();\r\n+      } catch (error) {\r\n+        console.error('Failed to reset group data:', error);\r\n+        alert('Failed to reset group data');\r\n+      }\r\n+    }\r\n+  }\r\n+\r\n+  async function handleResetTournament() {\r\n+    if (confirm('Reset the entire tournament? This will delete ALL tournament data including players, groups, matches, and brackets. This action cannot be undone.')) {\r\n+      try {\r\n+        await resetTournament(tournamentId);\r\n+        window.location.href = '/';\r\n+      } catch (error) {\r\n+        console.error('Failed to reset tournament:', error);\r\n+        alert('Failed to reset tournament');\r\n+      }\r\n+    }\r\n+  }\r\n+\r\n+  function getGroupDisplayName(groupId: string) {\r\n+    const pod = pods.find(p => p.id === groupId);\r\n+    return pod?.name || `Group ${groupId}`;\r\n+  }\r\n+  \r\n+  // Reactive derived values using $derived\r\n+  let currentRoundMatches = $derived(getMatchesForRound(currentRound));\r\n+  let groupsWithPlayers = $derived(getGroupsWithPlayers());\r\n+  let availableRounds = $derived([...new Set(matches.map(m => m.round))].sort((a, b) => a - b));\r\n+  \r\n+  // Debug logging with $effect\r\n+  $effect(() => {\r\n+    console.log('[Groups] Reactive update - currentRound:', currentRound);\r\n+    console.log('[Groups] Reactive update - matches count:', matches.length);\r\n+    console.log('[Groups] Reactive update - currentRoundMatches count:', currentRoundMatches.length);\r\n+    console.log('[Groups] Reactive update - matchSelections:', matchSelections);\r\n+    console.log('[Groups] Reactive update - pods:', pods.length);\r\n+  });\r\n+\r\n+  async function loadState() {\r\n+    console.log('[Groups] loadState() called');\r\n+    const data = await getState(tournamentId);\r\n+    console.log('[Groups] loadState() received data:', {\r\n+      podsCount: data.pods.length,\r\n+      matchesCount: data.matches.length,\r\n+      playersCount: data.players.length,\r\n+      state: data.state\r\n+    });\r\n+\r\n+    // With $state, direct assignment triggers reactivity\r\n+    pods = data.pods;\r\n+    matches = data.matches;\r\n+    players = data.players;\r\n+    tournamentState = data.state;\r\n+\r\n+    // Initialize selections from existing results\r\n+    matches.forEach(m => {\r\n+        if (m.result) {\r\n+            matchSelections[m.id] = {};\r\n+            Object.entries(m.result).forEach(([pid, res]: [string, any]) => {\r\n+                if (res.points === 3) matchSelections[m.id][pid] = 'win';\r\n+                else if (res.points === 1) matchSelections[m.id][pid] = 'tie';\r\n+                else matchSelections[m.id][pid] = 'loss';\r\n+            });\r\n+        }\r\n+    });\r\n+\r\n+    console.log('[Groups] loadState() complete - matchSelections:', matchSelections);\r\n+  }\r\n+\r\n+  function getPlayerName(id: string) {\r\n+    return players.find(p => p.id === id)?.name || 'Unknown';\r\n+  }\r\n+\r\n+  function getPlayer(id: string) {\r\n+    return players.find(p => p.id === id);\r\n+  }\r\n+\r\n+  function getMatchForPod(podId: string) {\r\n+    return matches.find(m => m.podId === podId);\r\n+  }\r\n+  \r\n+  function getMatchesForPod(podId: string) {\r\n+    return matches.filter(m => m.podId === podId);\r\n+  }\r\n+  \r\n+  function getMatchesForRound(round: number) {\r\n+    return matches.filter(m => m.round === round);\r\n+  }\r\n+  \r\n+  function isRoundComplete(round: number) {\r\n+    const roundMatches = getMatchesForRound(round);\r\n+    return roundMatches.length > 0 && roundMatches.every(m => m.completed);\r\n+  }\r\n+  \r\n+  function getMatchStatus(match: any) {\r\n+    if (!match) return 'pending';\r\n+    if (match.completed) return 'complete';\r\n+    if (matchSelections[match.id]) return 'live';\r\n+    return 'pending';\r\n+  }\r\n+\r\n+  function setWinner(matchId: string, winnerId: string, loserId: string) {\r\n+      console.log('[Groups] setWinner called:', { matchId, winnerId, loserId });\r\n+      matchSelections[matchId] = {\r\n+          [winnerId]: 'win',\r\n+          [loserId]: 'loss'\r\n+      };\r\n+      console.log('[Groups] setWinner complete - matchSelections:', matchSelections);\r\n+  }\r\n+\r\n+  function setTie(matchId: string, p1Id: string, p2Id: string) {\r\n+      console.log('[Groups] setTie called:', { matchId, p1Id, p2Id });\r\n+      matchSelections[matchId] = {\r\n+          [p1Id]: 'tie',\r\n+          [p2Id]: 'tie'\r\n+      };\r\n+      console.log('[Groups] setTie complete - matchSelections:', matchSelections);\r\n+  }\r\n+\r\n+  async function submitMatchResult(matchId: string) {\r\n+      console.log('[Groups] submitMatchResult called:', matchId);\r\n+      const selection = matchSelections[matchId];\r\n+      if (!selection) return;\r\n+\r\n+      const results: any = {};\r\n+      Object.entries(selection).forEach(([pid, status]) => {\r\n+          let points = 0;\r\n+          if (status === 'win') points = 3;\r\n+          if (status === 'tie') points = 1;\r\n+          results[pid] = { points };\r\n+      });\r\n+\r\n+      console.log('[Groups] submitMatchResult - submitting results:', results);\r\n+      await submitMatch(matchId, results);\r\n+      console.log('[Groups] submitMatchResult - match submitted, reloading state');\r\n+      await loadState();\r\n+      console.log('[Groups] submitMatchResult complete');\r\n+  }\r\n+\r\n+  async function handleGenerateBrackets() {\r\n+      if (confirm('Finish Group Stage and Generate Brackets?')) {\r\n+          try {\r\n+              console.log('[Groups] Generating brackets...');\r\n+              await generateBrackets(tournamentId);\r\n+              console.log('[Groups] Brackets generated, redirecting...');\r\n+              window.location.href = `/tournament/${tournamentId}/brackets`;\r\n+          } catch (error) {\r\n+              console.error('[Groups] Error generating brackets:', error);\r\n+              alert('Failed to generate brackets. Check console for details.');\r\n+          }\r\n+      }\r\n+  }\r\n+\r\n+  function getStandings() {\r\n+    return [...players].sort((a, b) => {\r\n+      if (b.points !== a.points) return b.points - a.points;\r\n+      // Tiebreaker: goal difference, then wins\r\n+      if (b.wins !== a.wins) return b.wins - a.wins;\r\n+      return 0;\r\n+    });\r\n+  }\r\n+\r\n+  // Group players by their pod/group\r\n+  function getGroupsWithPlayers() {\r\n+    // Get unique pod IDs for round 1 to determine groups\r\n+    const round1Pods = pods.filter(p => p.round === 1);\r\n+    const groups: Record<string, any[]> = {};\r\n+    \r\n+    round1Pods.forEach(pod => {\r\n+      const groupKey = pod.id;\r\n+      if (!groups[groupKey]) groups[groupKey] = [];\r\n+      \r\n+      // Get players directly from pod.players\r\n+      pod.players.forEach((pid: string) => {\r\n+        const player = getPlayer(pid);\r\n+        if (player && !groups[groupKey].find(p => p.id === pid)) {\r\n+          groups[groupKey].push(player);\r\n+        }\r\n+      });\r\n+    });\r\n+    \r\n+    // Sort players within each group by standings\r\n+    Object.keys(groups).forEach(key => {\r\n+      groups[key].sort((a, b) => {\r\n+        if (b.points !== a.points) return b.points - a.points;\r\n+        if (b.wins !== a.wins) return b.wins - a.wins;\r\n+        return 0;\r\n+      });\r\n+    });\r\n+    \r\n+    return groups;\r\n+  }\r\n+\r\n+  onMount(loadState);\r\n+</script>\r\n+\r\n+<div class=\"min-h-screen bg-gradient-to-br from-space-900 via-space-800 to-space-900 text-gaming-text px-3 py-3\">\r\n+  <div class=\"max-w-7xl mx-auto\">\r\n+    \r\n+    <!-- Header -->\r\n+    <div class=\"flex justify-between items-center mb-3\">\r\n+      <div>\r\n+        <a href=\"/\" class=\"text-gray-400 hover:text-cyber-green transition-colors mb-1 inline-block text-xs flex items-center gap-1\">\r\n+          <svg class=\"w-3 h-3\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\"><path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M10 19l-7-7m0 0l7-7m-7 7h18\"/></svg>\r\n+          Back\r\n+        </a>\r\n+        <h1 class=\"text-xl font-black gradient-text flex items-center gap-1.5\">\r\n+          <svg class=\"w-5 h-5 text-cyber-pink\" fill=\"currentColor\" viewBox=\"0 0 20 20\"><path fill-rule=\"evenodd\" d=\"M12.395 2.553a1 1 0 00-1.45-.385c-.345.23-.614.558-.822.88-.214.33-.403.713-.57 1.116-.334.804-.614 1.768-.84 2.734a31.365 31.365 0 00-.613 3.58 2.64 2.64 0 01-.945-1.067c-.328-.68-.398-1.534-.398-2.654A1 1 0 005.05 6.05 6.981 6.981 0 003 11a7 7 0 1011.95-4.95c-.592-.591-.98-.985-1.348-1.467-.363-.476-.724-1.063-1.207-2.03zM12.12 15.12A3 3 0 017 13s.879.5 2.5.5c0-1 .5-4 1.25-4.5.5 1 .786 1.293 1.371 1.879A2.99 2.99 0 0113 13a2.99 2.99 0 01-.879 2.121z\" clip-rule=\"evenodd\"/></svg>\r\n+          GROUP STAGE • R{currentRound}/3\r\n+        </h1>\r\n+      </div>\r\n+      \r\n+      {#if tournamentState === 'group' && matches.every(m => m.completed)}\r\n+        <button \r\n+          onclick={handleGenerateBrackets}\r\n+          class=\"bg-gradient-to-r from-cyber-pink to-purple-600 text-white font-bold text-xs py-1.5 px-4 rounded-lg shadow-glow-pink hover:scale-105 transition-transform flex items-center gap-1.5\"\r\n+        >\r\n+          Playoffs\r\n+          <svg class=\"w-3 h-3\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\"><path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M13 7l5 5m0 0l-5 5m5-5H6\"/></svg>\r\n+        </button>\r\n+      {/if}\r\n+    </div>\r\n+\r\n+    <!-- Round Progress -->\r\n+    <div class=\"glass rounded-lg p-2 mb-3\">\r\n+      <div class=\"flex items-center gap-2\">\r\n+        {#each availableRounds as round}\r\n+          <button \r\n+            onclick={() => currentRound = round}\r\n+            class=\"flex-1 flex items-center justify-center gap-1.5 py-1.5 px-2 rounded {currentRound === round ? 'bg-cyber-green/20 text-cyber-green' : 'text-gray-500 hover:bg-space-700'} transition-all\"\r\n+          >\r\n+            <div class=\"w-6 h-6 rounded-full border {isRoundComplete(round) ? 'bg-cyber-green border-cyber-green text-space-900' : currentRound === round ? 'border-cyber-green' : 'border-gray-600'} flex items-center justify-center font-bold text-xs\">\r\n+              {#if isRoundComplete(round)}\r\n+                <svg class=\"w-3 h-3\" fill=\"currentColor\" viewBox=\"0 0 20 20\"><path fill-rule=\"evenodd\" d=\"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z\" clip-rule=\"evenodd\"/></svg>\r\n+              {:else}\r\n+                {round}\r\n+              {/if}\r\n+            </div>\r\n+            <span class=\"font-bold text-xs\">R{round}</span>\r\n+          </button>\r\n+        {/each}\r\n+      </div>\r\n+    </div>\r\n+\r\n+    <!-- Group Tables Section -->\r\n+    <div class=\"mb-4\">\r\n+      <h2 class=\"text-base font-bold mb-2 text-white flex items-center gap-1.5\">\r\n+        <svg class=\"w-4 h-4 text-cyber-blue\" fill=\"currentColor\" viewBox=\"0 0 20 20\"><path d=\"M2 11a1 1 0 011-1h2a1 1 0 011 1v5a1 1 0 01-1 1H3a1 1 0 01-1-1v-5zM8 7a1 1 0 011-1h2a1 1 0 011 1v9a1 1 0 01-1 1H9a1 1 0 01-1-1V7zM14 4a1 1 0 011-1h2a1 1 0 011 1v12a1 1 0 01-1 1h-2a1 1 0 01-1-1V4z\"/></svg>\r\n+        Group Tables\r\n+      </h2>\r\n+      <div class=\"grid grid-cols-1 md:grid-cols-2 gap-3\">\r\n+        {#each Object.entries(groupsWithPlayers) as [groupId, groupPlayers] (groupId)}\r\n+          <div class=\"glass rounded-lg p-2\">\r\n+            <!-- Group Header with Edit and Reset -->\r\n+            <div class=\"flex items-center justify-between mb-1.5 px-2\">\r\n+              {#if editingGroupId === groupId}\r\n+                <div class=\"flex items-center gap-2 flex-1\">\r\n+                  <input\r\n+                    type=\"text\"\r\n+                    bind:value={editingGroupName}\r\n+                    class=\"flex-1 px-2 py-1 text-xs bg-space-700 border border-cyber-blue rounded text-white placeholder-gray-400 focus:outline-none focus:ring-1 focus:ring-cyber-green\"\r\n+                    placeholder=\"Group name...\"\r\n+                    onkeydown={(e) => {\r\n+                      if (e.key === 'Enter') saveGroupName(groupId);\r\n+                      if (e.key === 'Escape') cancelEditingGroup();\r\n+                    }}\r\n+                  />\r\n+                  <button\r\n+                    onclick={() => saveGroupName(groupId)}\r\n+                    class=\"px-2 py-1 text-xs bg-cyber-green text-space-900 rounded font-bold hover:bg-cyber-green/80\"\r\n+                  >\r\n+                    ✓\r\n+                  </button>\r\n+                  <button\r\n+                    onclick={cancelEditingGroup}\r\n+                    class=\"px-2 py-1 text-xs bg-gray-600 text-white rounded font-bold hover:bg-gray-500\"\r\n+                  >\r\n+                    ✕\r\n+                  </button>\r\n+                </div>\r\n+              {:else}\r\n+                <div class=\"flex items-center gap-2 flex-1\">\r\n+                  <span class=\"text-xs font-bold text-cyber-blue hover:text-cyber-green transition-colors\">\r\n+                    {getGroupDisplayName(groupId)}\r\n+                  </span>\r\n+                  <button\r\n+                    class=\"ml-2 px-2 py-1 text-xs bg-cyber-green text-black rounded hover:bg-cyber-green/80\"\r\n+                    on:click={() => startEditingGroup(groupId, getGroupDisplayName(groupId))}\r\n+                  >\r\n+                    Edit\r\n+                  </button>\r\n+                </div>\r\n+              {/if}\r\n+              <button\r\n+                onclick={() => handleResetGroup(groupId)}\r\n+                class=\"px-2 py-1 text-xs bg-red-600 text-white rounded font-bold hover:bg-red-500 transition-colors\"\r\n+                title=\"Reset group data\"\r\n+              >\r\n+                <svg class=\"w-3 h-3\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n+                  <path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15\"/>\r\n+                </svg>\r\n+              </button>\r\n+            </div>\r\n+            <table class=\"w-full text-xs\">\r\n+              <thead>\r\n+                <tr class=\"border-b border-space-600\">\r\n+                  <th class=\"text-left py-1 px-1 text-gray-400 font-bold text-xs\">#</th>\r\n+                  <th class=\"text-left py-1 px-1 text-gray-400 font-bold text-xs\">Player</th>\r\n+                  <th class=\"text-center py-1 px-1 text-gray-400 font-bold text-xs\">P</th>\r\n+                  <th class=\"text-center py-1 px-1 text-gray-400 font-bold text-xs\">W</th>\r\n+                  <th class=\"text-center py-1 px-1 text-gray-400 font-bold text-xs\">D</th>\r\n+                  <th class=\"text-center py-1 px-1 text-gray-400 font-bold text-xs\">L</th>\r\n+                  <th class=\"text-center py-1 px-1 text-gray-400 font-bold text-xs\">Pts</th>\r\n+                </tr>\r\n+              </thead>\r\n+              <tbody>\r\n+                {#each groupPlayers as player, index (player.id)}\r\n+                  <tr class=\"border-b border-space-700/50 hover:bg-space-700/30 transition-colors\">\r\n+                    <td class=\"py-1 px-1\">\r\n+                      <div class=\"w-4 h-4 rounded-full flex items-center justify-center font-bold text-xs {index === 0 ? 'bg-gradient-to-br from-yellow-400 to-yellow-600 text-space-900' : index === 1 ? 'bg-gradient-to-br from-gray-300 to-gray-500 text-space-900' : 'bg-space-600 text-gray-400'}\">\r\n+                        {index + 1}\r\n+                      </div>\r\n+                    </td>\r\n+                    <td class=\"py-1 px-1 font-bold text-white text-xs\">{player.name}</td>\r\n+                    <td class=\"text-center py-1 px-1 text-gray-400\">{(player.wins || 0) + (player.draws || 0) + (player.losses || 0)}</td>\r\n+                    <td class=\"text-center py-1 px-1 text-cyber-green font-bold\">{player.wins || 0}</td>\r\n+                    <td class=\"text-center py-1 px-1 text-yellow-500 font-bold\">{player.draws || 0}</td>\r\n+                    <td class=\"text-center py-1 px-1 text-red-400 font-bold\">{player.losses || 0}</td>\r\n+                    <td class=\"text-center py-1 px-1 text-cyber-green font-black\">{player.points || 0}</td>\r\n+                  </tr>\r\n+                {/each}\r\n+              </tbody>\r\n+            </table>\r\n+          </div>\r\n+        {/each}\r\n+      </div>\r\n+    </div>\r\n+\r\n+    <!-- Matches Section -->\r\n+    <div>\r\n+      <h2 class=\"text-base font-bold mb-2 text-white\">Round {currentRound} Matches</h2>\r\n+      <div class=\"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-2\">\r\n+        {#each currentRoundMatches as match (match.id)}\r\n+          {@const player1 = getPlayer(match.player1Id)}\r\n+          {@const player2 = getPlayer(match.player2Id)}\r\n+          {@const status = getMatchStatus(match)}\r\n+            \r\n+            <div class=\"glass rounded-lg p-2 relative\">\r\n+              <!-- Status Badge -->\r\n+              <div class=\"absolute top-1.5 right-1.5 flex items-center gap-0.5 px-1.5 py-0.5 rounded text-xs font-bold {status === 'complete' ? 'bg-cyber-green/20 text-cyber-green' : status === 'live' ? 'bg-yellow-500/20 text-yellow-500' : 'bg-gray-500/20 text-gray-400'}\">\r\n+                {#if status === 'complete'}\r\n+                  <svg class=\"w-2.5 h-2.5\" fill=\"currentColor\" viewBox=\"0 0 20 20\"><path fill-rule=\"evenodd\" d=\"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z\" clip-rule=\"evenodd\"/></svg>\r\n+                  Done\r\n+                {:else if status === 'live'}\r\n+                  <svg class=\"w-2.5 h-2.5\" fill=\"currentColor\" viewBox=\"0 0 20 20\"><path fill-rule=\"evenodd\" d=\"M11.3 1.046A1 1 0 0112 2v5h4a1 1 0 01.82 1.573l-7 10A1 1 0 018 18v-5H4a1 1 0 01-.82-1.573l7-10a1 1 0 011.12-.38z\" clip-rule=\"evenodd\"/></svg>\r\n+                  Live\r\n+                {:else}\r\n+                  Pending\r\n+                {/if}\r\n+              </div>\r\n+\r\n+              <div class=\"space-y-1.5\">\r\n+                <!-- Player 1 -->\r\n+                <div class=\"p-2 rounded bg-space-700/50 {matchSelections[match.id]?.[match.player1Id] === 'win' ? 'ring-1 ring-cyber-green' : matchSelections[match.id]?.[match.player1Id] === 'loss' ? 'opacity-60' : ''} transition-all\">\r\n+                  <div class=\"flex items-center justify-between mb-1.5\">\r\n+                    <div class=\"flex items-center gap-2\">\r\n+                      <div class=\"w-6 h-6 rounded-full bg-gradient-to-br from-cyan-500 to-blue-500 flex items-center justify-center\">\r\n+                        <svg class=\"w-3.5 h-3.5 text-white\" fill=\"currentColor\" viewBox=\"0 0 20 20\"><path fill-rule=\"evenodd\" d=\"M10 9a3 3 0 100-6 3 3 0 000 6zm-7 9a7 7 0 1114 0H3z\" clip-rule=\"evenodd\"/></svg>\r\n+                      </div>\r\n+                      <div>\r\n+                        <div class=\"font-bold text-xs text-white\">{player1?.name || 'Unknown'}</div>\r\n+                        <div class=\"text-xs text-gray-400\">{player1?.points || 0}pts</div>\r\n+                      </div>\r\n+                    </div>\r\n+                    {#if matchSelections[match.id]?.[match.player1Id] === 'win'}\r\n+                      <svg class=\"w-4 h-4 text-cyber-green\" fill=\"currentColor\" viewBox=\"0 0 20 20\"><path d=\"M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z\"/></svg>\r\n+                    {/if}\r\n+                  </div>\r\n+                  \r\n+                  {#if !match.completed}\r\n+                    <button \r\n+                      onclick={() => setWinner(match.id, match.player1Id, match.player2Id)}\r\n+                      class=\"w-full py-1 px-2 text-xs rounded font-bold transition-all {matchSelections[match.id]?.[match.player1Id] === 'win' ? 'bg-gradient-to-r from-cyber-green to-emerald-500 text-space-900' : 'bg-space-600 hover:bg-cyber-green/20 text-gray-300 hover:text-cyber-green'}\"\r\n+                    >\r\n+                      {matchSelections[match.id]?.[match.player1Id] === 'win' ? '✓ Winner' : 'Winner'}\r\n+                    </button>\r\n+                  {/if}\r\n+                </div>\r\n+\r\n+                <!-- Tie Button -->\r\n+                {#if !match.completed}\r\n+                  <button \r\n+                    onclick={() => setTie(match.id, match.player1Id, match.player2Id)}\r\n+                    class=\"w-full py-0.5 text-xs rounded font-bold transition-all {matchSelections[match.id]?.[match.player1Id] === 'tie' ? 'bg-gradient-to-r from-yellow-400 to-yellow-600 text-space-900' : 'bg-space-700 hover:bg-yellow-500/20 text-gray-300 hover:text-yellow-500'}\"\r\n+                  >\r\n+                    {matchSelections[match.id]?.[match.player1Id] === 'tie' ? '✓ Tie' : 'Tie'}\r\n+                  </button>\r\n+                {/if}\r\n+\r\n+                <!-- Player 2 -->\r\n+                <div class=\"p-2 rounded bg-space-700/50 {matchSelections[match.id]?.[match.player2Id] === 'win' ? 'ring-1 ring-cyber-green' : matchSelections[match.id]?.[match.player2Id] === 'loss' ? 'opacity-60' : ''} transition-all\">\r\n+                  <div class=\"flex items-center justify-between mb-1.5\">\r\n+                    <div class=\"flex items-center gap-2\">\r\n+                      <div class=\"w-6 h-6 rounded-full bg-gradient-to-br from-purple-500 to-pink-500 flex items-center justify-center\">\r\n+                        <svg class=\"w-3.5 h-3.5 text-white\" fill=\"currentColor\" viewBox=\"0 0 20 20\"><path fill-rule=\"evenodd\" d=\"M10 9a3 3 0 100-6 3 3 0 000 6zm-7 9a7 7 0 1114 0H3z\" clip-rule=\"evenodd\"/></svg>\r\n+                      </div>\r\n+                      <div>\r\n+                        <div class=\"font-bold text-xs text-white\">{player2?.name || 'Unknown'}</div>\r\n+                        <div class=\"text-xs text-gray-400\">{player2?.points || 0}pts</div>\r\n+                      </div>\r\n+                    </div>\r\n+                    {#if matchSelections[match.id]?.[match.player2Id] === 'win'}\r\n+                      <svg class=\"w-4 h-4 text-cyber-green\" fill=\"currentColor\" viewBox=\"0 0 20 20\"><path d=\"M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z\"/></svg>\r\n+                    {/if}\r\n+                  </div>\r\n+                  \r\n+                  {#if !match.completed}\r\n+                    <button \r\n+                      onclick={() => setWinner(match.id, match.player2Id, match.player1Id)}\r\n+                      class=\"w-full py-1 px-2 text-xs rounded font-bold transition-all {matchSelections[match.id]?.[match.player2Id] === 'win' ? 'bg-gradient-to-r from-cyber-green to-emerald-500 text-space-900' : 'bg-space-600 hover:bg-cyber-green/20 text-gray-300 hover:text-cyber-green'}\"\r\n+                    >\r\n+                      {matchSelections[match.id]?.[match.player2Id] === 'win' ? '✓ Winner' : 'Winner'}\r\n+                    </button>\r\n+                  {/if}\r\n+                </div>\r\n+              </div>\r\n+\r\n+              <!-- Submit Button -->\r\n+              {#if !match.completed && (matchSelections[match.id]?.[match.player1Id] || matchSelections[match.id]?.[match.player2Id])}\r\n+                <div class=\"mt-1.5\">\r\n+                  <button \r\n+                    onclick={() => submitMatchResult(match.id)}\r\n+                    class=\"w-full bg-gradient-to-r from-cyber-blue to-blue-600 text-white font-bold py-1.5 px-3 rounded text-xs hover:scale-102 transition-all\"\r\n+                  >\r\n+                    Submit Result\r\n+                  </button>\r\n+                </div>\r\n+              {/if}\r\n+            </div>\r\n+        {/each}\r\n+    </div>\r\n+\r\n+    <!-- Full Tournament Reset Button -->\r\n+    <div class=\"text-center pt-8 border-t border-space-600 mt-8\">\r\n+      <button\r\n+        onclick={() => handleResetTournament()}\r\n+        class=\"text-red-400/70 hover:text-red-400 text-base font-semibold transition-colors hover:underline\"\r\n+      >\r\n+        <svg class=\"w-4 h-4 inline-block mr-1\" fill=\"currentColor\" viewBox=\"0 0 20 20\"><path fill-rule=\"evenodd\" d=\"M9 2a1 1 0 00-.894.553L7.382 4H4a1 1 0 000 2v10a2 2 0 002 2h8a2 2 0 002-2V6a1 1 0 100-2h-3.382l-.724-1.447A1 1 0 0011 2H9zM7 8a1 1 0 012 0v6a1 1 0 11-2 0V8zm5-1a1 1 0 00-1 1v6a1 1 0 102 0V8a1 1 0 00-1-1z\" clip-rule=\"evenodd\"/></svg>\r\n+        Reset Entire Tournament\r\n+      </button>\r\n+    </div>\r\n+  </div>\r\n+</div>\r\n+</div>\r\n"
                },
                {
                    "date": 1764015477286,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -331,9 +331,9 @@\n                     {getGroupDisplayName(groupId)}\r\n                   </span>\r\n                   <button\r\n                     class=\"ml-2 px-2 py-1 text-xs bg-cyber-green text-black rounded hover:bg-cyber-green/80\"\r\n-                    on:click={() => startEditingGroup(groupId, getGroupDisplayName(groupId))}\r\n+                    onclick={() => startEditingGroup(groupId, getGroupDisplayName(groupId))}\r\n                   >\r\n                     Edit\r\n                   </button>\r\n                 </div>\r\n@@ -499,506 +499,4 @@\n     </div>\r\n   </div>\r\n </div>\r\n </div>\r\n-<script lang=\"ts\">\r\n-  import { onMount } from 'svelte';\r\n-  import { getState, submitMatch, generateBrackets, updateGroupName, resetGroupData, resetTournament } from '$lib/api';\r\n-\r\n-  let { tournamentId } = $props<{ tournamentId: string }>();\r\n-\r\n-  let pods = $state([]) as any[];\r\n-  let matches = $state([]) as any[];\r\n-  let players = $state([]) as any[];\r\n-  let tournamentState = $state('');\r\n-  let currentRound = $state(1);\r\n-\r\n-  // Local state to track UI selections before submission\r\n-  let matchSelections = $state({}) as Record<string, { [pid: string]: 'win' | 'loss' | 'tie' }>;\r\n-\r\n-  // Group editing state\r\n-  let editingGroupId = $state(null) as string | null;\r\n-  let editingGroupName = $state('');\r\n-\r\n-  // Group name editing functions\r\n-  function startEditingGroup(groupId: string, currentName: string) {\r\n-    editingGroupId = groupId;\r\n-    editingGroupName = currentName || `Group ${groupId}`;\r\n-  }\r\n-\r\n-  function cancelEditingGroup() {\r\n-    editingGroupId = null;\r\n-    editingGroupName = '';\r\n-  }\r\n-\r\n-  async function saveGroupName(groupId: string) {\r\n-    try {\r\n-      await updateGroupName(tournamentId, groupId, editingGroupName.trim());\r\n-      await loadState();\r\n-      editingGroupId = null;\r\n-      editingGroupName = '';\r\n-    } catch (error) {\r\n-      console.error('Failed to update group name:', error);\r\n-      alert('Failed to update group name');\r\n-    }\r\n-  }\r\n-\r\n-  async function handleResetGroup(groupId: string) {\r\n-    if (confirm('Reset all match results for this group? This will clear all player stats in this group.')) {\r\n-      try {\r\n-        await resetGroupData(tournamentId, groupId);\r\n-        await loadState();\r\n-      } catch (error) {\r\n-        console.error('Failed to reset group data:', error);\r\n-        alert('Failed to reset group data');\r\n-      }\r\n-    }\r\n-  }\r\n-\r\n-  async function handleResetTournament() {\r\n-    if (confirm('Reset the entire tournament? This will delete ALL tournament data including players, groups, matches, and brackets. This action cannot be undone.')) {\r\n-      try {\r\n-        await resetTournament(tournamentId);\r\n-        window.location.href = '/';\r\n-      } catch (error) {\r\n-        console.error('Failed to reset tournament:', error);\r\n-        alert('Failed to reset tournament');\r\n-      }\r\n-    }\r\n-  }\r\n-\r\n-  function getGroupDisplayName(groupId: string) {\r\n-    const pod = pods.find(p => p.id === groupId);\r\n-    return pod?.name || `Group ${groupId}`;\r\n-  }\r\n-  \r\n-  // Reactive derived values using $derived\r\n-  let currentRoundMatches = $derived(getMatchesForRound(currentRound));\r\n-  let groupsWithPlayers = $derived(getGroupsWithPlayers());\r\n-  let availableRounds = $derived([...new Set(matches.map(m => m.round))].sort((a, b) => a - b));\r\n-  \r\n-  // Debug logging with $effect\r\n-  $effect(() => {\r\n-    console.log('[Groups] Reactive update - currentRound:', currentRound);\r\n-    console.log('[Groups] Reactive update - matches count:', matches.length);\r\n-    console.log('[Groups] Reactive update - currentRoundMatches count:', currentRoundMatches.length);\r\n-    console.log('[Groups] Reactive update - matchSelections:', matchSelections);\r\n-    console.log('[Groups] Reactive update - pods:', pods.length);\r\n-  });\r\n-\r\n-  async function loadState() {\r\n-    console.log('[Groups] loadState() called');\r\n-    const data = await getState(tournamentId);\r\n-    console.log('[Groups] loadState() received data:', {\r\n-      podsCount: data.pods.length,\r\n-      matchesCount: data.matches.length,\r\n-      playersCount: data.players.length,\r\n-      state: data.state\r\n-    });\r\n-\r\n-    // With $state, direct assignment triggers reactivity\r\n-    pods = data.pods;\r\n-    matches = data.matches;\r\n-    players = data.players;\r\n-    tournamentState = data.state;\r\n-\r\n-    // Initialize selections from existing results\r\n-    matches.forEach(m => {\r\n-        if (m.result) {\r\n-            matchSelections[m.id] = {};\r\n-            Object.entries(m.result).forEach(([pid, res]: [string, any]) => {\r\n-                if (res.points === 3) matchSelections[m.id][pid] = 'win';\r\n-                else if (res.points === 1) matchSelections[m.id][pid] = 'tie';\r\n-                else matchSelections[m.id][pid] = 'loss';\r\n-            });\r\n-        }\r\n-    });\r\n-\r\n-    console.log('[Groups] loadState() complete - matchSelections:', matchSelections);\r\n-  }\r\n-\r\n-  function getPlayerName(id: string) {\r\n-    return players.find(p => p.id === id)?.name || 'Unknown';\r\n-  }\r\n-\r\n-  function getPlayer(id: string) {\r\n-    return players.find(p => p.id === id);\r\n-  }\r\n-\r\n-  function getMatchForPod(podId: string) {\r\n-    return matches.find(m => m.podId === podId);\r\n-  }\r\n-  \r\n-  function getMatchesForPod(podId: string) {\r\n-    return matches.filter(m => m.podId === podId);\r\n-  }\r\n-  \r\n-  function getMatchesForRound(round: number) {\r\n-    return matches.filter(m => m.round === round);\r\n-  }\r\n-  \r\n-  function isRoundComplete(round: number) {\r\n-    const roundMatches = getMatchesForRound(round);\r\n-    return roundMatches.length > 0 && roundMatches.every(m => m.completed);\r\n-  }\r\n-  \r\n-  function getMatchStatus(match: any) {\r\n-    if (!match) return 'pending';\r\n-    if (match.completed) return 'complete';\r\n-    if (matchSelections[match.id]) return 'live';\r\n-    return 'pending';\r\n-  }\r\n-\r\n-  function setWinner(matchId: string, winnerId: string, loserId: string) {\r\n-      console.log('[Groups] setWinner called:', { matchId, winnerId, loserId });\r\n-      matchSelections[matchId] = {\r\n-          [winnerId]: 'win',\r\n-          [loserId]: 'loss'\r\n-      };\r\n-      console.log('[Groups] setWinner complete - matchSelections:', matchSelections);\r\n-  }\r\n-\r\n-  function setTie(matchId: string, p1Id: string, p2Id: string) {\r\n-      console.log('[Groups] setTie called:', { matchId, p1Id, p2Id });\r\n-      matchSelections[matchId] = {\r\n-          [p1Id]: 'tie',\r\n-          [p2Id]: 'tie'\r\n-      };\r\n-      console.log('[Groups] setTie complete - matchSelections:', matchSelections);\r\n-  }\r\n-\r\n-  async function submitMatchResult(matchId: string) {\r\n-      console.log('[Groups] submitMatchResult called:', matchId);\r\n-      const selection = matchSelections[matchId];\r\n-      if (!selection) return;\r\n-\r\n-      const results: any = {};\r\n-      Object.entries(selection).forEach(([pid, status]) => {\r\n-          let points = 0;\r\n-          if (status === 'win') points = 3;\r\n-          if (status === 'tie') points = 1;\r\n-          results[pid] = { points };\r\n-      });\r\n-\r\n-      console.log('[Groups] submitMatchResult - submitting results:', results);\r\n-      await submitMatch(matchId, results);\r\n-      console.log('[Groups] submitMatchResult - match submitted, reloading state');\r\n-      await loadState();\r\n-      console.log('[Groups] submitMatchResult complete');\r\n-  }\r\n-\r\n-  async function handleGenerateBrackets() {\r\n-      if (confirm('Finish Group Stage and Generate Brackets?')) {\r\n-          try {\r\n-              console.log('[Groups] Generating brackets...');\r\n-              await generateBrackets(tournamentId);\r\n-              console.log('[Groups] Brackets generated, redirecting...');\r\n-              window.location.href = `/tournament/${tournamentId}/brackets`;\r\n-          } catch (error) {\r\n-              console.error('[Groups] Error generating brackets:', error);\r\n-              alert('Failed to generate brackets. Check console for details.');\r\n-          }\r\n-      }\r\n-  }\r\n-\r\n-  function getStandings() {\r\n-    return [...players].sort((a, b) => {\r\n-      if (b.points !== a.points) return b.points - a.points;\r\n-      // Tiebreaker: goal difference, then wins\r\n-      if (b.wins !== a.wins) return b.wins - a.wins;\r\n-      return 0;\r\n-    });\r\n-  }\r\n-\r\n-  // Group players by their pod/group\r\n-  function getGroupsWithPlayers() {\r\n-    // Get unique pod IDs for round 1 to determine groups\r\n-    const round1Pods = pods.filter(p => p.round === 1);\r\n-    const groups: Record<string, any[]> = {};\r\n-    \r\n-    round1Pods.forEach(pod => {\r\n-      const groupKey = pod.id;\r\n-      if (!groups[groupKey]) groups[groupKey] = [];\r\n-      \r\n-      // Get players directly from pod.players\r\n-      pod.players.forEach((pid: string) => {\r\n-        const player = getPlayer(pid);\r\n-        if (player && !groups[groupKey].find(p => p.id === pid)) {\r\n-          groups[groupKey].push(player);\r\n-        }\r\n-      });\r\n-    });\r\n-    \r\n-    // Sort players within each group by standings\r\n-    Object.keys(groups).forEach(key => {\r\n-      groups[key].sort((a, b) => {\r\n-        if (b.points !== a.points) return b.points - a.points;\r\n-        if (b.wins !== a.wins) return b.wins - a.wins;\r\n-        return 0;\r\n-      });\r\n-    });\r\n-    \r\n-    return groups;\r\n-  }\r\n-\r\n-  onMount(loadState);\r\n-</script>\r\n-\r\n-<div class=\"min-h-screen bg-gradient-to-br from-space-900 via-space-800 to-space-900 text-gaming-text px-3 py-3\">\r\n-  <div class=\"max-w-7xl mx-auto\">\r\n-    \r\n-    <!-- Header -->\r\n-    <div class=\"flex justify-between items-center mb-3\">\r\n-      <div>\r\n-        <a href=\"/\" class=\"text-gray-400 hover:text-cyber-green transition-colors mb-1 inline-block text-xs flex items-center gap-1\">\r\n-          <svg class=\"w-3 h-3\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\"><path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M10 19l-7-7m0 0l7-7m-7 7h18\"/></svg>\r\n-          Back\r\n-        </a>\r\n-        <h1 class=\"text-xl font-black gradient-text flex items-center gap-1.5\">\r\n-          <svg class=\"w-5 h-5 text-cyber-pink\" fill=\"currentColor\" viewBox=\"0 0 20 20\"><path fill-rule=\"evenodd\" d=\"M12.395 2.553a1 1 0 00-1.45-.385c-.345.23-.614.558-.822.88-.214.33-.403.713-.57 1.116-.334.804-.614 1.768-.84 2.734a31.365 31.365 0 00-.613 3.58 2.64 2.64 0 01-.945-1.067c-.328-.68-.398-1.534-.398-2.654A1 1 0 005.05 6.05 6.981 6.981 0 003 11a7 7 0 1011.95-4.95c-.592-.591-.98-.985-1.348-1.467-.363-.476-.724-1.063-1.207-2.03zM12.12 15.12A3 3 0 017 13s.879.5 2.5.5c0-1 .5-4 1.25-4.5.5 1 .786 1.293 1.371 1.879A2.99 2.99 0 0113 13a2.99 2.99 0 01-.879 2.121z\" clip-rule=\"evenodd\"/></svg>\r\n-          GROUP STAGE • R{currentRound}/3\r\n-        </h1>\r\n-      </div>\r\n-      \r\n-      {#if tournamentState === 'group' && matches.every(m => m.completed)}\r\n-        <button \r\n-          onclick={handleGenerateBrackets}\r\n-          class=\"bg-gradient-to-r from-cyber-pink to-purple-600 text-white font-bold text-xs py-1.5 px-4 rounded-lg shadow-glow-pink hover:scale-105 transition-transform flex items-center gap-1.5\"\r\n-        >\r\n-          Playoffs\r\n-          <svg class=\"w-3 h-3\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\"><path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M13 7l5 5m0 0l-5 5m5-5H6\"/></svg>\r\n-        </button>\r\n-      {/if}\r\n-    </div>\r\n-\r\n-    <!-- Round Progress -->\r\n-    <div class=\"glass rounded-lg p-2 mb-3\">\r\n-      <div class=\"flex items-center gap-2\">\r\n-        {#each availableRounds as round}\r\n-          <button \r\n-            onclick={() => currentRound = round}\r\n-            class=\"flex-1 flex items-center justify-center gap-1.5 py-1.5 px-2 rounded {currentRound === round ? 'bg-cyber-green/20 text-cyber-green' : 'text-gray-500 hover:bg-space-700'} transition-all\"\r\n-          >\r\n-            <div class=\"w-6 h-6 rounded-full border {isRoundComplete(round) ? 'bg-cyber-green border-cyber-green text-space-900' : currentRound === round ? 'border-cyber-green' : 'border-gray-600'} flex items-center justify-center font-bold text-xs\">\r\n-              {#if isRoundComplete(round)}\r\n-                <svg class=\"w-3 h-3\" fill=\"currentColor\" viewBox=\"0 0 20 20\"><path fill-rule=\"evenodd\" d=\"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z\" clip-rule=\"evenodd\"/></svg>\r\n-              {:else}\r\n-                {round}\r\n-              {/if}\r\n-            </div>\r\n-            <span class=\"font-bold text-xs\">R{round}</span>\r\n-          </button>\r\n-        {/each}\r\n-      </div>\r\n-    </div>\r\n-\r\n-    <!-- Group Tables Section -->\r\n-    <div class=\"mb-4\">\r\n-      <h2 class=\"text-base font-bold mb-2 text-white flex items-center gap-1.5\">\r\n-        <svg class=\"w-4 h-4 text-cyber-blue\" fill=\"currentColor\" viewBox=\"0 0 20 20\"><path d=\"M2 11a1 1 0 011-1h2a1 1 0 011 1v5a1 1 0 01-1 1H3a1 1 0 01-1-1v-5zM8 7a1 1 0 011-1h2a1 1 0 011 1v9a1 1 0 01-1 1H9a1 1 0 01-1-1V7zM14 4a1 1 0 011-1h2a1 1 0 011 1v12a1 1 0 01-1 1h-2a1 1 0 01-1-1V4z\"/></svg>\r\n-        Group Tables\r\n-      </h2>\r\n-      <div class=\"grid grid-cols-1 md:grid-cols-2 gap-3\">\r\n-        {#each Object.entries(groupsWithPlayers) as [groupId, groupPlayers] (groupId)}\r\n-          <div class=\"glass rounded-lg p-2\">\r\n-            <!-- Group Header with Edit and Reset -->\r\n-            <div class=\"flex items-center justify-between mb-1.5 px-2\">\r\n-              {#if editingGroupId === groupId}\r\n-                <div class=\"flex items-center gap-2 flex-1\">\r\n-                  <input\r\n-                    type=\"text\"\r\n-                    bind:value={editingGroupName}\r\n-                    class=\"flex-1 px-2 py-1 text-xs bg-space-700 border border-cyber-blue rounded text-white placeholder-gray-400 focus:outline-none focus:ring-1 focus:ring-cyber-green\"\r\n-                    placeholder=\"Group name...\"\r\n-                    onkeydown={(e) => {\r\n-                      if (e.key === 'Enter') saveGroupName(groupId);\r\n-                      if (e.key === 'Escape') cancelEditingGroup();\r\n-                    }}\r\n-                  />\r\n-                  <button\r\n-                    onclick={() => saveGroupName(groupId)}\r\n-                    class=\"px-2 py-1 text-xs bg-cyber-green text-space-900 rounded font-bold hover:bg-cyber-green/80\"\r\n-                  >\r\n-                    ✓\r\n-                  </button>\r\n-                  <button\r\n-                    onclick={cancelEditingGroup}\r\n-                    class=\"px-2 py-1 text-xs bg-gray-600 text-white rounded font-bold hover:bg-gray-500\"\r\n-                  >\r\n-                    ✕\r\n-                  </button>\r\n-                </div>\r\n-              {:else}\r\n-                <div class=\"flex items-center gap-2 flex-1\">\r\n-                  <span class=\"text-xs font-bold text-cyber-blue hover:text-cyber-green transition-colors\">\r\n-                    {getGroupDisplayName(groupId)}\r\n-                  </span>\r\n-                  <button\r\n-                    class=\"ml-2 px-2 py-1 text-xs bg-cyber-green text-black rounded hover:bg-cyber-green/80\"\r\n-                    on:click={() => startEditingGroup(groupId, getGroupDisplayName(groupId))}\r\n-                  >\r\n-                    Edit\r\n-                  </button>\r\n-                </div>\r\n-              {/if}\r\n-              <button\r\n-                onclick={() => handleResetGroup(groupId)}\r\n-                class=\"px-2 py-1 text-xs bg-red-600 text-white rounded font-bold hover:bg-red-500 transition-colors\"\r\n-                title=\"Reset group data\"\r\n-              >\r\n-                <svg class=\"w-3 h-3\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n-                  <path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15\"/>\r\n-                </svg>\r\n-              </button>\r\n-            </div>\r\n-            <table class=\"w-full text-xs\">\r\n-              <thead>\r\n-                <tr class=\"border-b border-space-600\">\r\n-                  <th class=\"text-left py-1 px-1 text-gray-400 font-bold text-xs\">#</th>\r\n-                  <th class=\"text-left py-1 px-1 text-gray-400 font-bold text-xs\">Player</th>\r\n-                  <th class=\"text-center py-1 px-1 text-gray-400 font-bold text-xs\">P</th>\r\n-                  <th class=\"text-center py-1 px-1 text-gray-400 font-bold text-xs\">W</th>\r\n-                  <th class=\"text-center py-1 px-1 text-gray-400 font-bold text-xs\">D</th>\r\n-                  <th class=\"text-center py-1 px-1 text-gray-400 font-bold text-xs\">L</th>\r\n-                  <th class=\"text-center py-1 px-1 text-gray-400 font-bold text-xs\">Pts</th>\r\n-                </tr>\r\n-              </thead>\r\n-              <tbody>\r\n-                {#each groupPlayers as player, index (player.id)}\r\n-                  <tr class=\"border-b border-space-700/50 hover:bg-space-700/30 transition-colors\">\r\n-                    <td class=\"py-1 px-1\">\r\n-                      <div class=\"w-4 h-4 rounded-full flex items-center justify-center font-bold text-xs {index === 0 ? 'bg-gradient-to-br from-yellow-400 to-yellow-600 text-space-900' : index === 1 ? 'bg-gradient-to-br from-gray-300 to-gray-500 text-space-900' : 'bg-space-600 text-gray-400'}\">\r\n-                        {index + 1}\r\n-                      </div>\r\n-                    </td>\r\n-                    <td class=\"py-1 px-1 font-bold text-white text-xs\">{player.name}</td>\r\n-                    <td class=\"text-center py-1 px-1 text-gray-400\">{(player.wins || 0) + (player.draws || 0) + (player.losses || 0)}</td>\r\n-                    <td class=\"text-center py-1 px-1 text-cyber-green font-bold\">{player.wins || 0}</td>\r\n-                    <td class=\"text-center py-1 px-1 text-yellow-500 font-bold\">{player.draws || 0}</td>\r\n-                    <td class=\"text-center py-1 px-1 text-red-400 font-bold\">{player.losses || 0}</td>\r\n-                    <td class=\"text-center py-1 px-1 text-cyber-green font-black\">{player.points || 0}</td>\r\n-                  </tr>\r\n-                {/each}\r\n-              </tbody>\r\n-            </table>\r\n-          </div>\r\n-        {/each}\r\n-      </div>\r\n-    </div>\r\n-\r\n-    <!-- Matches Section -->\r\n-    <div>\r\n-      <h2 class=\"text-base font-bold mb-2 text-white\">Round {currentRound} Matches</h2>\r\n-      <div class=\"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-2\">\r\n-        {#each currentRoundMatches as match (match.id)}\r\n-          {@const player1 = getPlayer(match.player1Id)}\r\n-          {@const player2 = getPlayer(match.player2Id)}\r\n-          {@const status = getMatchStatus(match)}\r\n-            \r\n-            <div class=\"glass rounded-lg p-2 relative\">\r\n-              <!-- Status Badge -->\r\n-              <div class=\"absolute top-1.5 right-1.5 flex items-center gap-0.5 px-1.5 py-0.5 rounded text-xs font-bold {status === 'complete' ? 'bg-cyber-green/20 text-cyber-green' : status === 'live' ? 'bg-yellow-500/20 text-yellow-500' : 'bg-gray-500/20 text-gray-400'}\">\r\n-                {#if status === 'complete'}\r\n-                  <svg class=\"w-2.5 h-2.5\" fill=\"currentColor\" viewBox=\"0 0 20 20\"><path fill-rule=\"evenodd\" d=\"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z\" clip-rule=\"evenodd\"/></svg>\r\n-                  Done\r\n-                {:else if status === 'live'}\r\n-                  <svg class=\"w-2.5 h-2.5\" fill=\"currentColor\" viewBox=\"0 0 20 20\"><path fill-rule=\"evenodd\" d=\"M11.3 1.046A1 1 0 0112 2v5h4a1 1 0 01.82 1.573l-7 10A1 1 0 018 18v-5H4a1 1 0 01-.82-1.573l7-10a1 1 0 011.12-.38z\" clip-rule=\"evenodd\"/></svg>\r\n-                  Live\r\n-                {:else}\r\n-                  Pending\r\n-                {/if}\r\n-              </div>\r\n-\r\n-              <div class=\"space-y-1.5\">\r\n-                <!-- Player 1 -->\r\n-                <div class=\"p-2 rounded bg-space-700/50 {matchSelections[match.id]?.[match.player1Id] === 'win' ? 'ring-1 ring-cyber-green' : matchSelections[match.id]?.[match.player1Id] === 'loss' ? 'opacity-60' : ''} transition-all\">\r\n-                  <div class=\"flex items-center justify-between mb-1.5\">\r\n-                    <div class=\"flex items-center gap-2\">\r\n-                      <div class=\"w-6 h-6 rounded-full bg-gradient-to-br from-cyan-500 to-blue-500 flex items-center justify-center\">\r\n-                        <svg class=\"w-3.5 h-3.5 text-white\" fill=\"currentColor\" viewBox=\"0 0 20 20\"><path fill-rule=\"evenodd\" d=\"M10 9a3 3 0 100-6 3 3 0 000 6zm-7 9a7 7 0 1114 0H3z\" clip-rule=\"evenodd\"/></svg>\r\n-                      </div>\r\n-                      <div>\r\n-                        <div class=\"font-bold text-xs text-white\">{player1?.name || 'Unknown'}</div>\r\n-                        <div class=\"text-xs text-gray-400\">{player1?.points || 0}pts</div>\r\n-                      </div>\r\n-                    </div>\r\n-                    {#if matchSelections[match.id]?.[match.player1Id] === 'win'}\r\n-                      <svg class=\"w-4 h-4 text-cyber-green\" fill=\"currentColor\" viewBox=\"0 0 20 20\"><path d=\"M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z\"/></svg>\r\n-                    {/if}\r\n-                  </div>\r\n-                  \r\n-                  {#if !match.completed}\r\n-                    <button \r\n-                      onclick={() => setWinner(match.id, match.player1Id, match.player2Id)}\r\n-                      class=\"w-full py-1 px-2 text-xs rounded font-bold transition-all {matchSelections[match.id]?.[match.player1Id] === 'win' ? 'bg-gradient-to-r from-cyber-green to-emerald-500 text-space-900' : 'bg-space-600 hover:bg-cyber-green/20 text-gray-300 hover:text-cyber-green'}\"\r\n-                    >\r\n-                      {matchSelections[match.id]?.[match.player1Id] === 'win' ? '✓ Winner' : 'Winner'}\r\n-                    </button>\r\n-                  {/if}\r\n-                </div>\r\n-\r\n-                <!-- Tie Button -->\r\n-                {#if !match.completed}\r\n-                  <button \r\n-                    onclick={() => setTie(match.id, match.player1Id, match.player2Id)}\r\n-                    class=\"w-full py-0.5 text-xs rounded font-bold transition-all {matchSelections[match.id]?.[match.player1Id] === 'tie' ? 'bg-gradient-to-r from-yellow-400 to-yellow-600 text-space-900' : 'bg-space-700 hover:bg-yellow-500/20 text-gray-300 hover:text-yellow-500'}\"\r\n-                  >\r\n-                    {matchSelections[match.id]?.[match.player1Id] === 'tie' ? '✓ Tie' : 'Tie'}\r\n-                  </button>\r\n-                {/if}\r\n-\r\n-                <!-- Player 2 -->\r\n-                <div class=\"p-2 rounded bg-space-700/50 {matchSelections[match.id]?.[match.player2Id] === 'win' ? 'ring-1 ring-cyber-green' : matchSelections[match.id]?.[match.player2Id] === 'loss' ? 'opacity-60' : ''} transition-all\">\r\n-                  <div class=\"flex items-center justify-between mb-1.5\">\r\n-                    <div class=\"flex items-center gap-2\">\r\n-                      <div class=\"w-6 h-6 rounded-full bg-gradient-to-br from-purple-500 to-pink-500 flex items-center justify-center\">\r\n-                        <svg class=\"w-3.5 h-3.5 text-white\" fill=\"currentColor\" viewBox=\"0 0 20 20\"><path fill-rule=\"evenodd\" d=\"M10 9a3 3 0 100-6 3 3 0 000 6zm-7 9a7 7 0 1114 0H3z\" clip-rule=\"evenodd\"/></svg>\r\n-                      </div>\r\n-                      <div>\r\n-                        <div class=\"font-bold text-xs text-white\">{player2?.name || 'Unknown'}</div>\r\n-                        <div class=\"text-xs text-gray-400\">{player2?.points || 0}pts</div>\r\n-                      </div>\r\n-                    </div>\r\n-                    {#if matchSelections[match.id]?.[match.player2Id] === 'win'}\r\n-                      <svg class=\"w-4 h-4 text-cyber-green\" fill=\"currentColor\" viewBox=\"0 0 20 20\"><path d=\"M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z\"/></svg>\r\n-                    {/if}\r\n-                  </div>\r\n-                  \r\n-                  {#if !match.completed}\r\n-                    <button \r\n-                      onclick={() => setWinner(match.id, match.player2Id, match.player1Id)}\r\n-                      class=\"w-full py-1 px-2 text-xs rounded font-bold transition-all {matchSelections[match.id]?.[match.player2Id] === 'win' ? 'bg-gradient-to-r from-cyber-green to-emerald-500 text-space-900' : 'bg-space-600 hover:bg-cyber-green/20 text-gray-300 hover:text-cyber-green'}\"\r\n-                    >\r\n-                      {matchSelections[match.id]?.[match.player2Id] === 'win' ? '✓ Winner' : 'Winner'}\r\n-                    </button>\r\n-                  {/if}\r\n-                </div>\r\n-              </div>\r\n-\r\n-              <!-- Submit Button -->\r\n-              {#if !match.completed && (matchSelections[match.id]?.[match.player1Id] || matchSelections[match.id]?.[match.player2Id])}\r\n-                <div class=\"mt-1.5\">\r\n-                  <button \r\n-                    onclick={() => submitMatchResult(match.id)}\r\n-                    class=\"w-full bg-gradient-to-r from-cyber-blue to-blue-600 text-white font-bold py-1.5 px-3 rounded text-xs hover:scale-102 transition-all\"\r\n-                  >\r\n-                    Submit Result\r\n-                  </button>\r\n-                </div>\r\n-              {/if}\r\n-            </div>\r\n-        {/each}\r\n-    </div>\r\n-\r\n-    <!-- Full Tournament Reset Button -->\r\n-    <div class=\"text-center pt-8 border-t border-space-600 mt-8\">\r\n-      <button\r\n-        onclick={() => handleResetTournament()}\r\n-        class=\"text-red-400/70 hover:text-red-400 text-base font-semibold transition-colors hover:underline\"\r\n-      >\r\n-        <svg class=\"w-4 h-4 inline-block mr-1\" fill=\"currentColor\" viewBox=\"0 0 20 20\"><path fill-rule=\"evenodd\" d=\"M9 2a1 1 0 00-.894.553L7.382 4H4a1 1 0 000 2v10a2 2 0 002 2h8a2 2 0 002-2V6a1 1 0 100-2h-3.382l-.724-1.447A1 1 0 0011 2H9zM7 8a1 1 0 012 0v6a1 1 0 11-2 0V8zm5-1a1 1 0 00-1 1v6a1 1 0 102 0V8a1 1 0 00-1-1z\" clip-rule=\"evenodd\"/></svg>\r\n-        Reset Entire Tournament\r\n-      </button>\r\n-    </div>\r\n-  </div>\r\n-</div>\r\n-</div>\r\n"
                },
                {
                    "date": 1764015661753,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -246,9 +246,9 @@\n     \r\n     <!-- Header -->\r\n     <div class=\"flex justify-between items-center mb-3\">\r\n       <div>\r\n-        <a href=\"/\" class=\"text-gray-400 hover:text-cyber-green transition-colors mb-1 inline-block text-xs flex items-center gap-1\">\r\n+        <a href={`/tournament/${tournamentId}`} class=\"text-gray-400 hover:text-cyber-green transition-colors mb-1 inline-block text-xs flex items-center gap-1\">\r\n           <svg class=\"w-3 h-3\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\"><path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M10 19l-7-7m0 0l7-7m-7 7h18\"/></svg>\r\n           Back\r\n         </a>\r\n         <h1 class=\"text-xl font-black gradient-text flex items-center gap-1.5\">\r\n"
                },
                {
                    "date": 1764015815432,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -417,8 +417,9 @@\n                       <div>\r\n                         <div class=\"font-bold text-xs text-white\">{player1?.name || 'Unknown'}</div>\r\n                         <div class=\"text-xs text-gray-400\">{player1?.points || 0}pts</div>\r\n                       </div>\r\n+                      \r\n                     </div>\r\n                     {#if matchSelections[match.id]?.[match.player1Id] === 'win'}\r\n                       <svg class=\"w-4 h-4 text-cyber-green\" fill=\"currentColor\" viewBox=\"0 0 20 20\"><path d=\"M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z\"/></svg>\r\n                     {/if}\r\n"
                },
                {
                    "date": 1764018367602,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -177,9 +177,10 @@\n           results[pid] = { points };\r\n       });\r\n \r\n       console.log('[Groups] submitMatchResult - submitting results:', results);\r\n-      await submitMatch(matchId, results);\r\n+      // FIX: include tournamentId as first arg\r\n+      await submitMatch(tournamentId, matchId, results);\r\n       console.log('[Groups] submitMatchResult - match submitted, reloading state');\r\n       await loadState();\r\n       console.log('[Groups] submitMatchResult complete');\r\n   }\r\n@@ -417,9 +418,8 @@\n                       <div>\r\n                         <div class=\"font-bold text-xs text-white\">{player1?.name || 'Unknown'}</div>\r\n                         <div class=\"text-xs text-gray-400\">{player1?.points || 0}pts</div>\r\n                       </div>\r\n-                      \r\n                     </div>\r\n                     {#if matchSelections[match.id]?.[match.player1Id] === 'win'}\r\n                       <svg class=\"w-4 h-4 text-cyber-green\" fill=\"currentColor\" viewBox=\"0 0 20 20\"><path d=\"M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z\"/></svg>\r\n                     {/if}\r\n"
                },
                {
                    "date": 1764022960358,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -330,14 +330,16 @@\n                 <div class=\"flex items-center gap-2 flex-1\">\r\n                   <span class=\"text-xs font-bold text-cyber-blue hover:text-cyber-green transition-colors\">\r\n                     {getGroupDisplayName(groupId)}\r\n                   </span>\r\n-                  <button\r\n-                    class=\"ml-2 px-2 py-1 text-xs bg-cyber-green text-black rounded hover:bg-cyber-green/80\"\r\n-                    onclick={() => startEditingGroup(groupId, getGroupDisplayName(groupId))}\r\n-                  >\r\n-                    Edit\r\n-                  </button>\r\n+                  {#if tournamentState === 'registration'}\r\n+                    <button\r\n+                      class=\"ml-2 px-2 py-1 text-xs bg-cyber-green text-black rounded hover:bg-cyber-green/80\"\r\n+                      onclick={() => startEditingGroup(groupId, getGroupDisplayName(groupId))}\r\n+                    >\r\n+                      Edit\r\n+                    </button>\r\n+                  {/if}\r\n                 </div>\r\n               {/if}\r\n               <button\r\n                 onclick={() => handleResetGroup(groupId)}\r\n"
                },
                {
                    "date": 1764027789144,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -370,10 +370,14 @@\n                       <div class=\"w-4 h-4 rounded-full flex items-center justify-center font-bold text-xs {index === 0 ? 'bg-gradient-to-br from-yellow-400 to-yellow-600 text-space-900' : index === 1 ? 'bg-gradient-to-br from-gray-300 to-gray-500 text-space-900' : 'bg-space-600 text-gray-400'}\">\r\n                         {index + 1}\r\n                       </div>\r\n                     </td>\r\n-                    <td class=\"py-1 px-1 font-bold text-white text-xs\">{player.name}</td>\r\n-                    <td class=\"text-center py-1 px-1 text-gray-400\">{(player.wins || 0) + (player.draws || 0) + (player.losses || 0)}</td>\r\n+<td class=\"py-1 px-1 font-bold text-white text-xs flex items-center gap-2\">\r\n+  {#if player.profilePhoto}\r\n+    <img src={player.profilePhoto} alt=\"Profile\" class=\"w-6 h-6 rounded-full object-cover inline-block\" />\r\n+  {/if}\r\n+  {player.name}\r\n+</td>                    <td class=\"text-center py-1 px-1 text-gray-400\">{(player.wins || 0) + (player.draws || 0) + (player.losses || 0)}</td>\r\n                     <td class=\"text-center py-1 px-1 text-cyber-green font-bold\">{player.wins || 0}</td>\r\n                     <td class=\"text-center py-1 px-1 text-yellow-500 font-bold\">{player.draws || 0}</td>\r\n                     <td class=\"text-center py-1 px-1 text-red-400 font-bold\">{player.losses || 0}</td>\r\n                     <td class=\"text-center py-1 px-1 text-cyber-green font-black\">{player.points || 0}</td>\r\n"
                },
                {
                    "date": 1764027794685,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -370,14 +370,15 @@\n                       <div class=\"w-4 h-4 rounded-full flex items-center justify-center font-bold text-xs {index === 0 ? 'bg-gradient-to-br from-yellow-400 to-yellow-600 text-space-900' : index === 1 ? 'bg-gradient-to-br from-gray-300 to-gray-500 text-space-900' : 'bg-space-600 text-gray-400'}\">\r\n                         {index + 1}\r\n                       </div>\r\n                     </td>\r\n-<td class=\"py-1 px-1 font-bold text-white text-xs flex items-center gap-2\">\r\n-  {#if player.profilePhoto}\r\n-    <img src={player.profilePhoto} alt=\"Profile\" class=\"w-6 h-6 rounded-full object-cover inline-block\" />\r\n-  {/if}\r\n-  {player.name}\r\n-</td>                    <td class=\"text-center py-1 px-1 text-gray-400\">{(player.wins || 0) + (player.draws || 0) + (player.losses || 0)}</td>\r\n+                    <td class=\"py-1 px-1 font-bold text-white text-xs flex items-center gap-2\">\r\n+                      {#if player.profilePhoto}\r\n+                        <img src={player.profilePhoto} alt=\"Profile\" class=\"w-6 h-6 rounded-full object-cover inline-block\" />\r\n+                      {/if}\r\n+                      {player.name}\r\n+                    </td>                    \r\n+                    <td class=\"text-center py-1 px-1 text-gray-400\">{(player.wins || 0) + (player.draws || 0) + (player.losses || 0)}</td>\r\n                     <td class=\"text-center py-1 px-1 text-cyber-green font-bold\">{player.wins || 0}</td>\r\n                     <td class=\"text-center py-1 px-1 text-yellow-500 font-bold\">{player.draws || 0}</td>\r\n                     <td class=\"text-center py-1 px-1 text-red-400 font-bold\">{player.losses || 0}</td>\r\n                     <td class=\"text-center py-1 px-1 text-cyber-green font-black\">{player.points || 0}</td>\r\n"
                },
                {
                    "date": 1764028099623,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -418,21 +418,21 @@\n                 <!-- Player 1 -->\r\n                 <div class=\"p-2 rounded bg-space-700/50 {matchSelections[match.id]?.[match.player1Id] === 'win' ? 'ring-1 ring-cyber-green' : matchSelections[match.id]?.[match.player1Id] === 'loss' ? 'opacity-60' : ''} transition-all\">\r\n                   <div class=\"flex items-center justify-between mb-1.5\">\r\n                     <div class=\"flex items-center gap-2\">\r\n-                      <div class=\"w-6 h-6 rounded-full bg-gradient-to-br from-cyan-500 to-blue-500 flex items-center justify-center\">\r\n-                        <svg class=\"w-3.5 h-3.5 text-white\" fill=\"currentColor\" viewBox=\"0 0 20 20\"><path fill-rule=\"evenodd\" d=\"M10 9a3 3 0 100-6 3 3 0 000 6zm-7 9a7 7 0 1114 0H3z\" clip-rule=\"evenodd\"/></svg>\r\n-                      </div>\r\n+                      {#if player1?.profilePhoto}\r\n+                        <img src={player1.profilePhoto} alt=\"Profile\" class=\"w-6 h-6 rounded-full object-cover\" />\r\n+                      {:else}\r\n+                        <div class=\"w-6 h-6 rounded-full bg-gradient-to-br from-cyan-500 to-blue-500 flex items-center justify-center\">\r\n+                          <svg class=\"w-3.5 h-3.5 text-white\" fill=\"currentColor\" viewBox=\"0 0 20 20\"><path fill-rule=\"evenodd\" d=\"M10 9a3 3 0 100-6 3 3 0 000 6zm-7 9a7 7 0 1114 0H3z\" clip-rule=\"evenodd\"/></svg>\r\n+                        </div>\r\n+                      {/if}\r\n                       <div>\r\n                         <div class=\"font-bold text-xs text-white\">{player1?.name || 'Unknown'}</div>\r\n                         <div class=\"text-xs text-gray-400\">{player1?.points || 0}pts</div>\r\n                       </div>\r\n                     </div>\r\n                     {#if matchSelections[match.id]?.[match.player1Id] === 'win'}\r\n-                      <svg class=\"w-4 h-4 text-cyber-green\" fill=\"currentColor\" viewBox=\"0 0 20 20\"><path d=\"M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z\"/></svg>\r\n-                    {/if}\r\n-                  </div>\r\n-                  \r\n                   {#if !match.completed}\r\n                     <button \r\n                       onclick={() => setWinner(match.id, match.player1Id, match.player2Id)}\r\n                       class=\"w-full py-1 px-2 text-xs rounded font-bold transition-all {matchSelections[match.id]?.[match.player1Id] === 'win' ? 'bg-gradient-to-r from-cyber-green to-emerald-500 text-space-900' : 'bg-space-600 hover:bg-cyber-green/20 text-gray-300 hover:text-cyber-green'}\"\r\n"
                },
                {
                    "date": 1764028115167,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -431,8 +431,12 @@\n                         <div class=\"text-xs text-gray-400\">{player1?.points || 0}pts</div>\r\n                       </div>\r\n                     </div>\r\n                     {#if matchSelections[match.id]?.[match.player1Id] === 'win'}\r\n+                      <svg class=\"w-4 h-4 text-cyber-green\" fill=\"currentColor\" viewBox=\"0 0 20 20\"><path d=\"M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z\"/></svg>\r\n+                    {/if}\r\n+                  </div>\r\n+                  \r\n                   {#if !match.completed}\r\n                     <button \r\n                       onclick={() => setWinner(match.id, match.player1Id, match.player2Id)}\r\n                       class=\"w-full py-1 px-2 text-xs rounded font-bold transition-all {matchSelections[match.id]?.[match.player1Id] === 'win' ? 'bg-gradient-to-r from-cyber-green to-emerald-500 text-space-900' : 'bg-space-600 hover:bg-cyber-green/20 text-gray-300 hover:text-cyber-green'}\"\r\n@@ -455,11 +459,15 @@\n                 <!-- Player 2 -->\r\n                 <div class=\"p-2 rounded bg-space-700/50 {matchSelections[match.id]?.[match.player2Id] === 'win' ? 'ring-1 ring-cyber-green' : matchSelections[match.id]?.[match.player2Id] === 'loss' ? 'opacity-60' : ''} transition-all\">\r\n                   <div class=\"flex items-center justify-between mb-1.5\">\r\n                     <div class=\"flex items-center gap-2\">\r\n-                      <div class=\"w-6 h-6 rounded-full bg-gradient-to-br from-purple-500 to-pink-500 flex items-center justify-center\">\r\n-                        <svg class=\"w-3.5 h-3.5 text-white\" fill=\"currentColor\" viewBox=\"0 0 20 20\"><path fill-rule=\"evenodd\" d=\"M10 9a3 3 0 100-6 3 3 0 000 6zm-7 9a7 7 0 1114 0H3z\" clip-rule=\"evenodd\"/></svg>\r\n-                      </div>\r\n+                      {#if player2?.profilePhoto}\r\n+                        <img src={player2.profilePhoto} alt=\"Profile\" class=\"w-6 h-6 rounded-full object-cover\" />\r\n+                      {:else}\r\n+                        <div class=\"w-6 h-6 rounded-full bg-gradient-to-br from-purple-500 to-pink-500 flex items-center justify-center\">\r\n+                          <svg class=\"w-3.5 h-3.5 text-white\" fill=\"currentColor\" viewBox=\"0 0 20 20\"><path fill-rule=\"evenodd\" d=\"M10 9a3 3 0 100-6 3 3 0 000 6zm-7 9a7 7 0 1114 0H3z\" clip-rule=\"evenodd\"/></svg>\r\n+                        </div>\r\n+                      {/if}\r\n                       <div>\r\n                         <div class=\"font-bold text-xs text-white\">{player2?.name || 'Unknown'}</div>\r\n                         <div class=\"text-xs text-gray-400\">{player2?.points || 0}pts</div>\r\n                       </div>\r\n"
                },
                {
                    "date": 1764074683399,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1,518 +1,27 @@\n-<script lang=\"ts\">\r\n-  import { onMount } from 'svelte';\r\n-  import { getState, submitMatch, generateBrackets, updateGroupName, resetGroupData, resetTournament } from '$lib/api';\r\n-\r\n-  let { tournamentId } = $props<{ tournamentId: string }>();\r\n-\r\n-  let pods = $state([]) as any[];\r\n-  let matches = $state([]) as any[];\r\n-  let players = $state([]) as any[];\r\n-  let tournamentState = $state('');\r\n-  let currentRound = $state(1);\r\n-\r\n-  // Local state to track UI selections before submission\r\n-  let matchSelections = $state({}) as Record<string, { [pid: string]: 'win' | 'loss' | 'tie' }>;\r\n-\r\n-  // Group editing state\r\n-  let editingGroupId = $state(null) as string | null;\r\n-  let editingGroupName = $state('');\r\n-\r\n-  // Group name editing functions\r\n-  function startEditingGroup(groupId: string, currentName: string) {\r\n-    editingGroupId = groupId;\r\n-    editingGroupName = currentName || `Group ${groupId}`;\r\n-  }\r\n-\r\n-  function cancelEditingGroup() {\r\n-    editingGroupId = null;\r\n-    editingGroupName = '';\r\n-  }\r\n-\r\n-  async function saveGroupName(groupId: string) {\r\n-    try {\r\n-      await updateGroupName(tournamentId, groupId, editingGroupName.trim());\r\n-      await loadState();\r\n-      editingGroupId = null;\r\n-      editingGroupName = '';\r\n-    } catch (error) {\r\n-      console.error('Failed to update group name:', error);\r\n-      alert('Failed to update group name');\r\n-    }\r\n-  }\r\n-\r\n-  async function handleResetGroup(groupId: string) {\r\n-    if (confirm('Reset all match results for this group? This will clear all player stats in this group.')) {\r\n-      try {\r\n-        await resetGroupData(tournamentId, groupId);\r\n-        await loadState();\r\n-      } catch (error) {\r\n-        console.error('Failed to reset group data:', error);\r\n-        alert('Failed to reset group data');\r\n-      }\r\n-    }\r\n-  }\r\n-\r\n-  async function handleResetTournament() {\r\n-    if (confirm('Reset the entire tournament? This will delete ALL tournament data including players, groups, matches, and brackets. This action cannot be undone.')) {\r\n-      try {\r\n-        await resetTournament(tournamentId);\r\n-        window.location.href = '/';\r\n-      } catch (error) {\r\n-        console.error('Failed to reset tournament:', error);\r\n-        alert('Failed to reset tournament');\r\n-      }\r\n-    }\r\n-  }\r\n-\r\n-  function getGroupDisplayName(groupId: string) {\r\n-    const pod = pods.find(p => p.id === groupId);\r\n-    return pod?.name || `Group ${groupId}`;\r\n-  }\r\n-  \r\n-  // Reactive derived values using $derived\r\n-  let currentRoundMatches = $derived(getMatchesForRound(currentRound));\r\n-  let groupsWithPlayers = $derived(getGroupsWithPlayers());\r\n-  let availableRounds = $derived([...new Set(matches.map(m => m.round))].sort((a, b) => a - b));\r\n-  \r\n-  // Debug logging with $effect\r\n-  $effect(() => {\r\n-    console.log('[Groups] Reactive update - currentRound:', currentRound);\r\n-    console.log('[Groups] Reactive update - matches count:', matches.length);\r\n-    console.log('[Groups] Reactive update - currentRoundMatches count:', currentRoundMatches.length);\r\n-    console.log('[Groups] Reactive update - matchSelections:', matchSelections);\r\n-    console.log('[Groups] Reactive update - pods:', pods.length);\r\n-  });\r\n-\r\n-  async function loadState() {\r\n-    console.log('[Groups] loadState() called');\r\n-    const data = await getState(tournamentId);\r\n-    console.log('[Groups] loadState() received data:', {\r\n-      podsCount: data.pods.length,\r\n-      matchesCount: data.matches.length,\r\n-      playersCount: data.players.length,\r\n-      state: data.state\r\n-    });\r\n-\r\n-    // With $state, direct assignment triggers reactivity\r\n-    pods = data.pods;\r\n-    matches = data.matches;\r\n-    players = data.players;\r\n-    tournamentState = data.state;\r\n-\r\n-    // Initialize selections from existing results\r\n-    matches.forEach(m => {\r\n-        if (m.result) {\r\n-            matchSelections[m.id] = {};\r\n-            Object.entries(m.result).forEach(([pid, res]: [string, any]) => {\r\n-                if (res.points === 3) matchSelections[m.id][pid] = 'win';\r\n-                else if (res.points === 1) matchSelections[m.id][pid] = 'tie';\r\n-                else matchSelections[m.id][pid] = 'loss';\r\n-            });\r\n-        }\r\n-    });\r\n-\r\n-    console.log('[Groups] loadState() complete - matchSelections:', matchSelections);\r\n-  }\r\n-\r\n-  function getPlayerName(id: string) {\r\n-    return players.find(p => p.id === id)?.name || 'Unknown';\r\n-  }\r\n-\r\n-  function getPlayer(id: string) {\r\n-    return players.find(p => p.id === id);\r\n-  }\r\n-\r\n-  function getMatchForPod(podId: string) {\r\n-    return matches.find(m => m.podId === podId);\r\n-  }\r\n-  \r\n-  function getMatchesForPod(podId: string) {\r\n-    return matches.filter(m => m.podId === podId);\r\n-  }\r\n-  \r\n-  function getMatchesForRound(round: number) {\r\n-    return matches.filter(m => m.round === round);\r\n-  }\r\n-  \r\n-  function isRoundComplete(round: number) {\r\n-    const roundMatches = getMatchesForRound(round);\r\n-    return roundMatches.length > 0 && roundMatches.every(m => m.completed);\r\n-  }\r\n-  \r\n-  function getMatchStatus(match: any) {\r\n-    if (!match) return 'pending';\r\n-    if (match.completed) return 'complete';\r\n-    if (matchSelections[match.id]) return 'live';\r\n-    return 'pending';\r\n-  }\r\n-\r\n-  function setWinner(matchId: string, winnerId: string, loserId: string) {\r\n-      console.log('[Groups] setWinner called:', { matchId, winnerId, loserId });\r\n-      matchSelections[matchId] = {\r\n-          [winnerId]: 'win',\r\n-          [loserId]: 'loss'\r\n-      };\r\n-      console.log('[Groups] setWinner complete - matchSelections:', matchSelections);\r\n-  }\r\n-\r\n-  function setTie(matchId: string, p1Id: string, p2Id: string) {\r\n-      console.log('[Groups] setTie called:', { matchId, p1Id, p2Id });\r\n-      matchSelections[matchId] = {\r\n-          [p1Id]: 'tie',\r\n-          [p2Id]: 'tie'\r\n-      };\r\n-      console.log('[Groups] setTie complete - matchSelections:', matchSelections);\r\n-  }\r\n-\r\n-  async function submitMatchResult(matchId: string) {\r\n-      console.log('[Groups] submitMatchResult called:', matchId);\r\n-      const selection = matchSelections[matchId];\r\n-      if (!selection) return;\r\n-\r\n-      const results: any = {};\r\n-      Object.entries(selection).forEach(([pid, status]) => {\r\n-          let points = 0;\r\n-          if (status === 'win') points = 3;\r\n-          if (status === 'tie') points = 1;\r\n-          results[pid] = { points };\r\n-      });\r\n-\r\n-      console.log('[Groups] submitMatchResult - submitting results:', results);\r\n-      // FIX: include tournamentId as first arg\r\n-      await submitMatch(tournamentId, matchId, results);\r\n-      console.log('[Groups] submitMatchResult - match submitted, reloading state');\r\n-      await loadState();\r\n-      console.log('[Groups] submitMatchResult complete');\r\n-  }\r\n-\r\n-  async function handleGenerateBrackets() {\r\n-      if (confirm('Finish Group Stage and Generate Brackets?')) {\r\n-          try {\r\n-              console.log('[Groups] Generating brackets...');\r\n-              await generateBrackets(tournamentId);\r\n-              console.log('[Groups] Brackets generated, redirecting...');\r\n-              window.location.href = `/tournament/${tournamentId}/brackets`;\r\n-          } catch (error) {\r\n-              console.error('[Groups] Error generating brackets:', error);\r\n-              alert('Failed to generate brackets. Check console for details.');\r\n-          }\r\n-      }\r\n-  }\r\n-\r\n-  function getStandings() {\r\n-    return [...players].sort((a, b) => {\r\n-      if (b.points !== a.points) return b.points - a.points;\r\n-      // Tiebreaker: goal difference, then wins\r\n-      if (b.wins !== a.wins) return b.wins - a.wins;\r\n-      return 0;\r\n-    });\r\n-  }\r\n-\r\n-  // Group players by their pod/group\r\n-  function getGroupsWithPlayers() {\r\n-    // Get unique pod IDs for round 1 to determine groups\r\n-    const round1Pods = pods.filter(p => p.round === 1);\r\n-    const groups: Record<string, any[]> = {};\r\n-    \r\n-    round1Pods.forEach(pod => {\r\n-      const groupKey = pod.id;\r\n-      if (!groups[groupKey]) groups[groupKey] = [];\r\n-      \r\n-      // Get players directly from pod.players\r\n-      pod.players.forEach((pid: string) => {\r\n-        const player = getPlayer(pid);\r\n-        if (player && !groups[groupKey].find(p => p.id === pid)) {\r\n-          groups[groupKey].push(player);\r\n-        }\r\n-      });\r\n-    });\r\n-    \r\n-    // Sort players within each group by standings\r\n-    Object.keys(groups).forEach(key => {\r\n-      groups[key].sort((a, b) => {\r\n-        if (b.points !== a.points) return b.points - a.points;\r\n-        if (b.wins !== a.wins) return b.wins - a.wins;\r\n-        return 0;\r\n-      });\r\n-    });\r\n-    \r\n-    return groups;\r\n-  }\r\n-\r\n-  onMount(loadState);\r\n-</script>\r\n-\r\n-<div class=\"min-h-screen bg-gradient-to-br from-space-900 via-space-800 to-space-900 text-gaming-text px-3 py-3\">\r\n-  <div class=\"max-w-7xl mx-auto\">\r\n-    \r\n-    <!-- Header -->\r\n-    <div class=\"flex justify-between items-center mb-3\">\r\n-      <div>\r\n-        <a href={`/tournament/${tournamentId}`} class=\"text-gray-400 hover:text-cyber-green transition-colors mb-1 inline-block text-xs flex items-center gap-1\">\r\n-          <svg class=\"w-3 h-3\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\"><path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M10 19l-7-7m0 0l7-7m-7 7h18\"/></svg>\r\n-          Back\r\n-        </a>\r\n-        <h1 class=\"text-xl font-black gradient-text flex items-center gap-1.5\">\r\n-          <svg class=\"w-5 h-5 text-cyber-pink\" fill=\"currentColor\" viewBox=\"0 0 20 20\"><path fill-rule=\"evenodd\" d=\"M12.395 2.553a1 1 0 00-1.45-.385c-.345.23-.614.558-.822.88-.214.33-.403.713-.57 1.116-.334.804-.614 1.768-.84 2.734a31.365 31.365 0 00-.613 3.58 2.64 2.64 0 01-.945-1.067c-.328-.68-.398-1.534-.398-2.654A1 1 0 005.05 6.05 6.981 6.981 0 003 11a7 7 0 1011.95-4.95c-.592-.591-.98-.985-1.348-1.467-.363-.476-.724-1.063-1.207-2.03zM12.12 15.12A3 3 0 017 13s.879.5 2.5.5c0-1 .5-4 1.25-4.5.5 1 .786 1.293 1.371 1.879A2.99 2.99 0 0113 13a2.99 2.99 0 01-.879 2.121z\" clip-rule=\"evenodd\"/></svg>\r\n-          GROUP STAGE • R{currentRound}/3\r\n-        </h1>\r\n-      </div>\r\n-      \r\n-      {#if tournamentState === 'group' && matches.every(m => m.completed)}\r\n-        <button \r\n-          onclick={handleGenerateBrackets}\r\n-          class=\"bg-gradient-to-r from-cyber-pink to-purple-600 text-white font-bold text-xs py-1.5 px-4 rounded-lg shadow-glow-pink hover:scale-105 transition-transform flex items-center gap-1.5\"\r\n-        >\r\n-          Playoffs\r\n-          <svg class=\"w-3 h-3\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\"><path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M13 7l5 5m0 0l-5 5m5-5H6\"/></svg>\r\n-        </button>\r\n-      {/if}\r\n-    </div>\r\n-\r\n-    <!-- Round Progress -->\r\n-    <div class=\"glass rounded-lg p-2 mb-3\">\r\n-      <div class=\"flex items-center gap-2\">\r\n-        {#each availableRounds as round}\r\n-          <button \r\n-            onclick={() => currentRound = round}\r\n-            class=\"flex-1 flex items-center justify-center gap-1.5 py-1.5 px-2 rounded {currentRound === round ? 'bg-cyber-green/20 text-cyber-green' : 'text-gray-500 hover:bg-space-700'} transition-all\"\r\n-          >\r\n-            <div class=\"w-6 h-6 rounded-full border {isRoundComplete(round) ? 'bg-cyber-green border-cyber-green text-space-900' : currentRound === round ? 'border-cyber-green' : 'border-gray-600'} flex items-center justify-center font-bold text-xs\">\r\n-              {#if isRoundComplete(round)}\r\n-                <svg class=\"w-3 h-3\" fill=\"currentColor\" viewBox=\"0 0 20 20\"><path fill-rule=\"evenodd\" d=\"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z\" clip-rule=\"evenodd\"/></svg>\r\n-              {:else}\r\n-                {round}\r\n-              {/if}\r\n-            </div>\r\n-            <span class=\"font-bold text-xs\">R{round}</span>\r\n-          </button>\r\n-        {/each}\r\n-      </div>\r\n-    </div>\r\n-\r\n-    <!-- Group Tables Section -->\r\n-    <div class=\"mb-4\">\r\n-      <h2 class=\"text-base font-bold mb-2 text-white flex items-center gap-1.5\">\r\n-        <svg class=\"w-4 h-4 text-cyber-blue\" fill=\"currentColor\" viewBox=\"0 0 20 20\"><path d=\"M2 11a1 1 0 011-1h2a1 1 0 011 1v5a1 1 0 01-1 1H3a1 1 0 01-1-1v-5zM8 7a1 1 0 011-1h2a1 1 0 011 1v9a1 1 0 01-1 1H9a1 1 0 01-1-1V7zM14 4a1 1 0 011-1h2a1 1 0 011 1v12a1 1 0 01-1 1h-2a1 1 0 01-1-1V4z\"/></svg>\r\n-        Group Tables\r\n-      </h2>\r\n-      <div class=\"grid grid-cols-1 md:grid-cols-2 gap-3\">\r\n-        {#each Object.entries(groupsWithPlayers) as [groupId, groupPlayers] (groupId)}\r\n-          <div class=\"glass rounded-lg p-2\">\r\n-            <!-- Group Header with Edit and Reset -->\r\n-            <div class=\"flex items-center justify-between mb-1.5 px-2\">\r\n-              {#if editingGroupId === groupId}\r\n-                <div class=\"flex items-center gap-2 flex-1\">\r\n-                  <input\r\n-                    type=\"text\"\r\n-                    bind:value={editingGroupName}\r\n-                    class=\"flex-1 px-2 py-1 text-xs bg-space-700 border border-cyber-blue rounded text-white placeholder-gray-400 focus:outline-none focus:ring-1 focus:ring-cyber-green\"\r\n-                    placeholder=\"Group name...\"\r\n-                    onkeydown={(e) => {\r\n-                      if (e.key === 'Enter') saveGroupName(groupId);\r\n-                      if (e.key === 'Escape') cancelEditingGroup();\r\n-                    }}\r\n-                  />\r\n-                  <button\r\n-                    onclick={() => saveGroupName(groupId)}\r\n-                    class=\"px-2 py-1 text-xs bg-cyber-green text-space-900 rounded font-bold hover:bg-cyber-green/80\"\r\n-                  >\r\n-                    ✓\r\n-                  </button>\r\n-                  <button\r\n-                    onclick={cancelEditingGroup}\r\n-                    class=\"px-2 py-1 text-xs bg-gray-600 text-white rounded font-bold hover:bg-gray-500\"\r\n-                  >\r\n-                    ✕\r\n-                  </button>\r\n-                </div>\r\n-              {:else}\r\n-                <div class=\"flex items-center gap-2 flex-1\">\r\n-                  <span class=\"text-xs font-bold text-cyber-blue hover:text-cyber-green transition-colors\">\r\n-                    {getGroupDisplayName(groupId)}\r\n-                  </span>\r\n-                  {#if tournamentState === 'registration'}\r\n-                    <button\r\n-                      class=\"ml-2 px-2 py-1 text-xs bg-cyber-green text-black rounded hover:bg-cyber-green/80\"\r\n-                      onclick={() => startEditingGroup(groupId, getGroupDisplayName(groupId))}\r\n-                    >\r\n-                      Edit\r\n-                    </button>\r\n-                  {/if}\r\n-                </div>\r\n-              {/if}\r\n-              <button\r\n-                onclick={() => handleResetGroup(groupId)}\r\n-                class=\"px-2 py-1 text-xs bg-red-600 text-white rounded font-bold hover:bg-red-500 transition-colors\"\r\n-                title=\"Reset group data\"\r\n-              >\r\n-                <svg class=\"w-3 h-3\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n-                  <path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15\"/>\r\n-                </svg>\r\n-              </button>\r\n-            </div>\r\n-            <table class=\"w-full text-xs\">\r\n-              <thead>\r\n-                <tr class=\"border-b border-space-600\">\r\n-                  <th class=\"text-left py-1 px-1 text-gray-400 font-bold text-xs\">#</th>\r\n-                  <th class=\"text-left py-1 px-1 text-gray-400 font-bold text-xs\">Player</th>\r\n-                  <th class=\"text-center py-1 px-1 text-gray-400 font-bold text-xs\">P</th>\r\n-                  <th class=\"text-center py-1 px-1 text-gray-400 font-bold text-xs\">W</th>\r\n-                  <th class=\"text-center py-1 px-1 text-gray-400 font-bold text-xs\">D</th>\r\n-                  <th class=\"text-center py-1 px-1 text-gray-400 font-bold text-xs\">L</th>\r\n-                  <th class=\"text-center py-1 px-1 text-gray-400 font-bold text-xs\">Pts</th>\r\n-                </tr>\r\n-              </thead>\r\n-              <tbody>\r\n-                {#each groupPlayers as player, index (player.id)}\r\n-                  <tr class=\"border-b border-space-700/50 hover:bg-space-700/30 transition-colors\">\r\n-                    <td class=\"py-1 px-1\">\r\n-                      <div class=\"w-4 h-4 rounded-full flex items-center justify-center font-bold text-xs {index === 0 ? 'bg-gradient-to-br from-yellow-400 to-yellow-600 text-space-900' : index === 1 ? 'bg-gradient-to-br from-gray-300 to-gray-500 text-space-900' : 'bg-space-600 text-gray-400'}\">\r\n-                        {index + 1}\r\n-                      </div>\r\n-                    </td>\r\n-                    <td class=\"py-1 px-1 font-bold text-white text-xs flex items-center gap-2\">\r\n-                      {#if player.profilePhoto}\r\n-                        <img src={player.profilePhoto} alt=\"Profile\" class=\"w-6 h-6 rounded-full object-cover inline-block\" />\r\n-                      {/if}\r\n-                      {player.name}\r\n-                    </td>                    \r\n-                    <td class=\"text-center py-1 px-1 text-gray-400\">{(player.wins || 0) + (player.draws || 0) + (player.losses || 0)}</td>\r\n-                    <td class=\"text-center py-1 px-1 text-cyber-green font-bold\">{player.wins || 0}</td>\r\n-                    <td class=\"text-center py-1 px-1 text-yellow-500 font-bold\">{player.draws || 0}</td>\r\n-                    <td class=\"text-center py-1 px-1 text-red-400 font-bold\">{player.losses || 0}</td>\r\n-                    <td class=\"text-center py-1 px-1 text-cyber-green font-black\">{player.points || 0}</td>\r\n-                  </tr>\r\n-                {/each}\r\n-              </tbody>\r\n-            </table>\r\n-          </div>\r\n-        {/each}\r\n-      </div>\r\n-    </div>\r\n-\r\n-    <!-- Matches Section -->\r\n-    <div>\r\n-      <h2 class=\"text-base font-bold mb-2 text-white\">Round {currentRound} Matches</h2>\r\n-      <div class=\"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-2\">\r\n-        {#each currentRoundMatches as match (match.id)}\r\n-          {@const player1 = getPlayer(match.player1Id)}\r\n-          {@const player2 = getPlayer(match.player2Id)}\r\n-          {@const status = getMatchStatus(match)}\r\n-            \r\n-            <div class=\"glass rounded-lg p-2 relative\">\r\n-              <!-- Status Badge -->\r\n-              <div class=\"absolute top-1.5 right-1.5 flex items-center gap-0.5 px-1.5 py-0.5 rounded text-xs font-bold {status === 'complete' ? 'bg-cyber-green/20 text-cyber-green' : status === 'live' ? 'bg-yellow-500/20 text-yellow-500' : 'bg-gray-500/20 text-gray-400'}\">\r\n-                {#if status === 'complete'}\r\n-                  <svg class=\"w-2.5 h-2.5\" fill=\"currentColor\" viewBox=\"0 0 20 20\"><path fill-rule=\"evenodd\" d=\"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z\" clip-rule=\"evenodd\"/></svg>\r\n-                  Done\r\n-                {:else if status === 'live'}\r\n-                  <svg class=\"w-2.5 h-2.5\" fill=\"currentColor\" viewBox=\"0 0 20 20\"><path fill-rule=\"evenodd\" d=\"M11.3 1.046A1 1 0 0112 2v5h4a1 1 0 01.82 1.573l-7 10A1 1 0 018 18v-5H4a1 1 0 01-.82-1.573l7-10a1 1 0 011.12-.38z\" clip-rule=\"evenodd\"/></svg>\r\n-                  Live\r\n-                {:else}\r\n-                  Pending\r\n-                {/if}\r\n-              </div>\r\n-\r\n-              <div class=\"space-y-1.5\">\r\n-                <!-- Player 1 -->\r\n-                <div class=\"p-2 rounded bg-space-700/50 {matchSelections[match.id]?.[match.player1Id] === 'win' ? 'ring-1 ring-cyber-green' : matchSelections[match.id]?.[match.player1Id] === 'loss' ? 'opacity-60' : ''} transition-all\">\r\n-                  <div class=\"flex items-center justify-between mb-1.5\">\r\n-                    <div class=\"flex items-center gap-2\">\r\n-                      {#if player1?.profilePhoto}\r\n-                        <img src={player1.profilePhoto} alt=\"Profile\" class=\"w-6 h-6 rounded-full object-cover\" />\r\n-                      {:else}\r\n-                        <div class=\"w-6 h-6 rounded-full bg-gradient-to-br from-cyan-500 to-blue-500 flex items-center justify-center\">\r\n-                          <svg class=\"w-3.5 h-3.5 text-white\" fill=\"currentColor\" viewBox=\"0 0 20 20\"><path fill-rule=\"evenodd\" d=\"M10 9a3 3 0 100-6 3 3 0 000 6zm-7 9a7 7 0 1114 0H3z\" clip-rule=\"evenodd\"/></svg>\r\n-                        </div>\r\n-                      {/if}\r\n-                      <div>\r\n-                        <div class=\"font-bold text-xs text-white\">{player1?.name || 'Unknown'}</div>\r\n-                        <div class=\"text-xs text-gray-400\">{player1?.points || 0}pts</div>\r\n-                      </div>\r\n-                    </div>\r\n-                    {#if matchSelections[match.id]?.[match.player1Id] === 'win'}\r\n-                      <svg class=\"w-4 h-4 text-cyber-green\" fill=\"currentColor\" viewBox=\"0 0 20 20\"><path d=\"M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z\"/></svg>\r\n-                    {/if}\r\n-                  </div>\r\n-                  \r\n-                  {#if !match.completed}\r\n-                    <button \r\n-                      onclick={() => setWinner(match.id, match.player1Id, match.player2Id)}\r\n-                      class=\"w-full py-1 px-2 text-xs rounded font-bold transition-all {matchSelections[match.id]?.[match.player1Id] === 'win' ? 'bg-gradient-to-r from-cyber-green to-emerald-500 text-space-900' : 'bg-space-600 hover:bg-cyber-green/20 text-gray-300 hover:text-cyber-green'}\"\r\n-                    >\r\n-                      {matchSelections[match.id]?.[match.player1Id] === 'win' ? '✓ Winner' : 'Winner'}\r\n-                    </button>\r\n-                  {/if}\r\n-                </div>\r\n-\r\n-                <!-- Tie Button -->\r\n-                {#if !match.completed}\r\n-                  <button \r\n-                    onclick={() => setTie(match.id, match.player1Id, match.player2Id)}\r\n-                    class=\"w-full py-0.5 text-xs rounded font-bold transition-all {matchSelections[match.id]?.[match.player1Id] === 'tie' ? 'bg-gradient-to-r from-yellow-400 to-yellow-600 text-space-900' : 'bg-space-700 hover:bg-yellow-500/20 text-gray-300 hover:text-yellow-500'}\"\r\n-                  >\r\n-                    {matchSelections[match.id]?.[match.player1Id] === 'tie' ? '✓ Tie' : 'Tie'}\r\n-                  </button>\r\n-                {/if}\r\n-\r\n-                <!-- Player 2 -->\r\n-                <div class=\"p-2 rounded bg-space-700/50 {matchSelections[match.id]?.[match.player2Id] === 'win' ? 'ring-1 ring-cyber-green' : matchSelections[match.id]?.[match.player2Id] === 'loss' ? 'opacity-60' : ''} transition-all\">\r\n-                  <div class=\"flex items-center justify-between mb-1.5\">\r\n-                    <div class=\"flex items-center gap-2\">\r\n-                      {#if player2?.profilePhoto}\r\n-                        <img src={player2.profilePhoto} alt=\"Profile\" class=\"w-6 h-6 rounded-full object-cover\" />\r\n-                      {:else}\r\n-                        <div class=\"w-6 h-6 rounded-full bg-gradient-to-br from-purple-500 to-pink-500 flex items-center justify-center\">\r\n-                          <svg class=\"w-3.5 h-3.5 text-white\" fill=\"currentColor\" viewBox=\"0 0 20 20\"><path fill-rule=\"evenodd\" d=\"M10 9a3 3 0 100-6 3 3 0 000 6zm-7 9a7 7 0 1114 0H3z\" clip-rule=\"evenodd\"/></svg>\r\n-                        </div>\r\n-                      {/if}\r\n-                      <div>\r\n-                        <div class=\"font-bold text-xs text-white\">{player2?.name || 'Unknown'}</div>\r\n-                        <div class=\"text-xs text-gray-400\">{player2?.points || 0}pts</div>\r\n-                      </div>\r\n-                    </div>\r\n-                    {#if matchSelections[match.id]?.[match.player2Id] === 'win'}\r\n-                      <svg class=\"w-4 h-4 text-cyber-green\" fill=\"currentColor\" viewBox=\"0 0 20 20\"><path d=\"M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z\"/></svg>\r\n-                    {/if}\r\n-                  </div>\r\n-                  \r\n-                  {#if !match.completed}\r\n-                    <button \r\n-                      onclick={() => setWinner(match.id, match.player2Id, match.player1Id)}\r\n-                      class=\"w-full py-1 px-2 text-xs rounded font-bold transition-all {matchSelections[match.id]?.[match.player2Id] === 'win' ? 'bg-gradient-to-r from-cyber-green to-emerald-500 text-space-900' : 'bg-space-600 hover:bg-cyber-green/20 text-gray-300 hover:text-cyber-green'}\"\r\n-                    >\r\n-                      {matchSelections[match.id]?.[match.player2Id] === 'win' ? '✓ Winner' : 'Winner'}\r\n-                    </button>\r\n-                  {/if}\r\n-                </div>\r\n-              </div>\r\n-\r\n-              <!-- Submit Button -->\r\n-              {#if !match.completed && (matchSelections[match.id]?.[match.player1Id] || matchSelections[match.id]?.[match.player2Id])}\r\n-                <div class=\"mt-1.5\">\r\n-                  <button \r\n-                    onclick={() => submitMatchResult(match.id)}\r\n-                    class=\"w-full bg-gradient-to-r from-cyber-blue to-blue-600 text-white font-bold py-1.5 px-3 rounded text-xs hover:scale-102 transition-all\"\r\n-                  >\r\n-                    Submit Result\r\n-                  </button>\r\n-                </div>\r\n-              {/if}\r\n-            </div>\r\n-        {/each}\r\n-    </div>\r\n-\r\n-    <!-- Full Tournament Reset Button -->\r\n-    <div class=\"text-center pt-8 border-t border-space-600 mt-8\">\r\n+<!-- ...inside your Group Header with Edit and Reset... -->\r\n+<div class=\"flex items-center gap-2 flex-1\">\r\n+  <span class=\"text-xs font-bold text-cyber-blue hover:text-cyber-green transition-colors\">\r\n+    {getGroupDisplayName(groupId)}\r\n+  </span>\r\n+  {#if isAdmin}\r\n+    {#if tournamentState === 'registration'}\r\n       <button\r\n-        onclick={() => handleResetTournament()}\r\n-        class=\"text-red-400/70 hover:text-red-400 text-base font-semibold transition-colors hover:underline\"\r\n+        class=\"ml-2 px-2 py-1 text-xs bg-cyber-green text-black rounded hover:bg-cyber-green/80\"\r\n+        onclick={() => startEditingGroup(groupId, getGroupDisplayName(groupId))}\r\n       >\r\n-        <svg class=\"w-4 h-4 inline-block mr-1\" fill=\"currentColor\" viewBox=\"0 0 20 20\"><path fill-rule=\"evenodd\" d=\"M9 2a1 1 0 00-.894.553L7.382 4H4a1 1 0 000 2v10a2 2 0 002 2h8a2 2 0 002-2V6a1 1 0 100-2h-3.382l-.724-1.447A1 1 0 0011 2H9zM7 8a1 1 0 012 0v6a1 1 0 11-2 0V8zm5-1a1 1 0 00-1 1v6a1 1 0 102 0V8a1 1 0 00-1-1z\" clip-rule=\"evenodd\"/></svg>\r\n-        Reset Entire Tournament\r\n+        Edit\r\n       </button>\r\n-    </div>\r\n-  </div>\r\n+    {/if}\r\n+  {/if}\r\n </div>\r\n-</div>\r\n+{#if isAdmin}\r\n+  <button\r\n+    onclick={() => handleResetGroup(groupId)}\r\n+    class=\"px-2 py-1 text-xs bg-red-600 text-white rounded font-bold hover:bg-red-500 transition-colors\"\r\n+    title=\"Reset group data\"\r\n+  >\r\n+    <svg class=\"w-3 h-3\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n+      <path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15\"/>\r\n+    </svg>\r\n+  </button>\r\n+{/if}\r\n"
                },
                {
                    "date": 1764074691193,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1,27 +1,518 @@\n-<!-- ...inside your Group Header with Edit and Reset... -->\r\n-<div class=\"flex items-center gap-2 flex-1\">\r\n-  <span class=\"text-xs font-bold text-cyber-blue hover:text-cyber-green transition-colors\">\r\n-    {getGroupDisplayName(groupId)}\r\n-  </span>\r\n-  {#if isAdmin}\r\n-    {#if tournamentState === 'registration'}\r\n+<script lang=\"ts\">\r\n+  import { onMount } from 'svelte';\r\n+  import { getState, submitMatch, generateBrackets, updateGroupName, resetGroupData, resetTournament } from '$lib/api';\r\n+\r\n+  let { tournamentId } = $props<{ tournamentId: string }>();\r\n+\r\n+  let pods = $state([]) as any[];\r\n+  let matches = $state([]) as any[];\r\n+  let players = $state([]) as any[];\r\n+  let tournamentState = $state('');\r\n+  let currentRound = $state(1);\r\n+\r\n+  // Local state to track UI selections before submission\r\n+  let matchSelections = $state({}) as Record<string, { [pid: string]: 'win' | 'loss' | 'tie' }>;\r\n+\r\n+  // Group editing state\r\n+  let editingGroupId = $state(null) as string | null;\r\n+  let editingGroupName = $state('');\r\n+\r\n+  // Group name editing functions\r\n+  function startEditingGroup(groupId: string, currentName: string) {\r\n+    editingGroupId = groupId;\r\n+    editingGroupName = currentName || `Group ${groupId}`;\r\n+  }\r\n+\r\n+  function cancelEditingGroup() {\r\n+    editingGroupId = null;\r\n+    editingGroupName = '';\r\n+  }\r\n+\r\n+  async function saveGroupName(groupId: string) {\r\n+    try {\r\n+      await updateGroupName(tournamentId, groupId, editingGroupName.trim());\r\n+      await loadState();\r\n+      editingGroupId = null;\r\n+      editingGroupName = '';\r\n+    } catch (error) {\r\n+      console.error('Failed to update group name:', error);\r\n+      alert('Failed to update group name');\r\n+    }\r\n+  }\r\n+\r\n+  async function handleResetGroup(groupId: string) {\r\n+    if (confirm('Reset all match results for this group? This will clear all player stats in this group.')) {\r\n+      try {\r\n+        await resetGroupData(tournamentId, groupId);\r\n+        await loadState();\r\n+      } catch (error) {\r\n+        console.error('Failed to reset group data:', error);\r\n+        alert('Failed to reset group data');\r\n+      }\r\n+    }\r\n+  }\r\n+\r\n+  async function handleResetTournament() {\r\n+    if (confirm('Reset the entire tournament? This will delete ALL tournament data including players, groups, matches, and brackets. This action cannot be undone.')) {\r\n+      try {\r\n+        await resetTournament(tournamentId);\r\n+        window.location.href = '/';\r\n+      } catch (error) {\r\n+        console.error('Failed to reset tournament:', error);\r\n+        alert('Failed to reset tournament');\r\n+      }\r\n+    }\r\n+  }\r\n+\r\n+  function getGroupDisplayName(groupId: string) {\r\n+    const pod = pods.find(p => p.id === groupId);\r\n+    return pod?.name || `Group ${groupId}`;\r\n+  }\r\n+  \r\n+  // Reactive derived values using $derived\r\n+  let currentRoundMatches = $derived(getMatchesForRound(currentRound));\r\n+  let groupsWithPlayers = $derived(getGroupsWithPlayers());\r\n+  let availableRounds = $derived([...new Set(matches.map(m => m.round))].sort((a, b) => a - b));\r\n+  \r\n+  // Debug logging with $effect\r\n+  $effect(() => {\r\n+    console.log('[Groups] Reactive update - currentRound:', currentRound);\r\n+    console.log('[Groups] Reactive update - matches count:', matches.length);\r\n+    console.log('[Groups] Reactive update - currentRoundMatches count:', currentRoundMatches.length);\r\n+    console.log('[Groups] Reactive update - matchSelections:', matchSelections);\r\n+    console.log('[Groups] Reactive update - pods:', pods.length);\r\n+  });\r\n+\r\n+  async function loadState() {\r\n+    console.log('[Groups] loadState() called');\r\n+    const data = await getState(tournamentId);\r\n+    console.log('[Groups] loadState() received data:', {\r\n+      podsCount: data.pods.length,\r\n+      matchesCount: data.matches.length,\r\n+      playersCount: data.players.length,\r\n+      state: data.state\r\n+    });\r\n+\r\n+    // With $state, direct assignment triggers reactivity\r\n+    pods = data.pods;\r\n+    matches = data.matches;\r\n+    players = data.players;\r\n+    tournamentState = data.state;\r\n+\r\n+    // Initialize selections from existing results\r\n+    matches.forEach(m => {\r\n+        if (m.result) {\r\n+            matchSelections[m.id] = {};\r\n+            Object.entries(m.result).forEach(([pid, res]: [string, any]) => {\r\n+                if (res.points === 3) matchSelections[m.id][pid] = 'win';\r\n+                else if (res.points === 1) matchSelections[m.id][pid] = 'tie';\r\n+                else matchSelections[m.id][pid] = 'loss';\r\n+            });\r\n+        }\r\n+    });\r\n+\r\n+    console.log('[Groups] loadState() complete - matchSelections:', matchSelections);\r\n+  }\r\n+\r\n+  function getPlayerName(id: string) {\r\n+    return players.find(p => p.id === id)?.name || 'Unknown';\r\n+  }\r\n+\r\n+  function getPlayer(id: string) {\r\n+    return players.find(p => p.id === id);\r\n+  }\r\n+\r\n+  function getMatchForPod(podId: string) {\r\n+    return matches.find(m => m.podId === podId);\r\n+  }\r\n+  \r\n+  function getMatchesForPod(podId: string) {\r\n+    return matches.filter(m => m.podId === podId);\r\n+  }\r\n+  \r\n+  function getMatchesForRound(round: number) {\r\n+    return matches.filter(m => m.round === round);\r\n+  }\r\n+  \r\n+  function isRoundComplete(round: number) {\r\n+    const roundMatches = getMatchesForRound(round);\r\n+    return roundMatches.length > 0 && roundMatches.every(m => m.completed);\r\n+  }\r\n+  \r\n+  function getMatchStatus(match: any) {\r\n+    if (!match) return 'pending';\r\n+    if (match.completed) return 'complete';\r\n+    if (matchSelections[match.id]) return 'live';\r\n+    return 'pending';\r\n+  }\r\n+\r\n+  function setWinner(matchId: string, winnerId: string, loserId: string) {\r\n+      console.log('[Groups] setWinner called:', { matchId, winnerId, loserId });\r\n+      matchSelections[matchId] = {\r\n+          [winnerId]: 'win',\r\n+          [loserId]: 'loss'\r\n+      };\r\n+      console.log('[Groups] setWinner complete - matchSelections:', matchSelections);\r\n+  }\r\n+\r\n+  function setTie(matchId: string, p1Id: string, p2Id: string) {\r\n+      console.log('[Groups] setTie called:', { matchId, p1Id, p2Id });\r\n+      matchSelections[matchId] = {\r\n+          [p1Id]: 'tie',\r\n+          [p2Id]: 'tie'\r\n+      };\r\n+      console.log('[Groups] setTie complete - matchSelections:', matchSelections);\r\n+  }\r\n+\r\n+  async function submitMatchResult(matchId: string) {\r\n+      console.log('[Groups] submitMatchResult called:', matchId);\r\n+      const selection = matchSelections[matchId];\r\n+      if (!selection) return;\r\n+\r\n+      const results: any = {};\r\n+      Object.entries(selection).forEach(([pid, status]) => {\r\n+          let points = 0;\r\n+          if (status === 'win') points = 3;\r\n+          if (status === 'tie') points = 1;\r\n+          results[pid] = { points };\r\n+      });\r\n+\r\n+      console.log('[Groups] submitMatchResult - submitting results:', results);\r\n+      // FIX: include tournamentId as first arg\r\n+      await submitMatch(tournamentId, matchId, results);\r\n+      console.log('[Groups] submitMatchResult - match submitted, reloading state');\r\n+      await loadState();\r\n+      console.log('[Groups] submitMatchResult complete');\r\n+  }\r\n+\r\n+  async function handleGenerateBrackets() {\r\n+      if (confirm('Finish Group Stage and Generate Brackets?')) {\r\n+          try {\r\n+              console.log('[Groups] Generating brackets...');\r\n+              await generateBrackets(tournamentId);\r\n+              console.log('[Groups] Brackets generated, redirecting...');\r\n+              window.location.href = `/tournament/${tournamentId}/brackets`;\r\n+          } catch (error) {\r\n+              console.error('[Groups] Error generating brackets:', error);\r\n+              alert('Failed to generate brackets. Check console for details.');\r\n+          }\r\n+      }\r\n+  }\r\n+\r\n+  function getStandings() {\r\n+    return [...players].sort((a, b) => {\r\n+      if (b.points !== a.points) return b.points - a.points;\r\n+      // Tiebreaker: goal difference, then wins\r\n+      if (b.wins !== a.wins) return b.wins - a.wins;\r\n+      return 0;\r\n+    });\r\n+  }\r\n+\r\n+  // Group players by their pod/group\r\n+  function getGroupsWithPlayers() {\r\n+    // Get unique pod IDs for round 1 to determine groups\r\n+    const round1Pods = pods.filter(p => p.round === 1);\r\n+    const groups: Record<string, any[]> = {};\r\n+    \r\n+    round1Pods.forEach(pod => {\r\n+      const groupKey = pod.id;\r\n+      if (!groups[groupKey]) groups[groupKey] = [];\r\n+      \r\n+      // Get players directly from pod.players\r\n+      pod.players.forEach((pid: string) => {\r\n+        const player = getPlayer(pid);\r\n+        if (player && !groups[groupKey].find(p => p.id === pid)) {\r\n+          groups[groupKey].push(player);\r\n+        }\r\n+      });\r\n+    });\r\n+    \r\n+    // Sort players within each group by standings\r\n+    Object.keys(groups).forEach(key => {\r\n+      groups[key].sort((a, b) => {\r\n+        if (b.points !== a.points) return b.points - a.points;\r\n+        if (b.wins !== a.wins) return b.wins - a.wins;\r\n+        return 0;\r\n+      });\r\n+    });\r\n+    \r\n+    return groups;\r\n+  }\r\n+\r\n+  onMount(loadState);\r\n+</script>\r\n+\r\n+<div class=\"min-h-screen bg-gradient-to-br from-space-900 via-space-800 to-space-900 text-gaming-text px-3 py-3\">\r\n+  <div class=\"max-w-7xl mx-auto\">\r\n+    \r\n+    <!-- Header -->\r\n+    <div class=\"flex justify-between items-center mb-3\">\r\n+      <div>\r\n+        <a href={`/tournament/${tournamentId}`} class=\"text-gray-400 hover:text-cyber-green transition-colors mb-1 inline-block text-xs flex items-center gap-1\">\r\n+          <svg class=\"w-3 h-3\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\"><path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M10 19l-7-7m0 0l7-7m-7 7h18\"/></svg>\r\n+          Back\r\n+        </a>\r\n+        <h1 class=\"text-xl font-black gradient-text flex items-center gap-1.5\">\r\n+          <svg class=\"w-5 h-5 text-cyber-pink\" fill=\"currentColor\" viewBox=\"0 0 20 20\"><path fill-rule=\"evenodd\" d=\"M12.395 2.553a1 1 0 00-1.45-.385c-.345.23-.614.558-.822.88-.214.33-.403.713-.57 1.116-.334.804-.614 1.768-.84 2.734a31.365 31.365 0 00-.613 3.58 2.64 2.64 0 01-.945-1.067c-.328-.68-.398-1.534-.398-2.654A1 1 0 005.05 6.05 6.981 6.981 0 003 11a7 7 0 1011.95-4.95c-.592-.591-.98-.985-1.348-1.467-.363-.476-.724-1.063-1.207-2.03zM12.12 15.12A3 3 0 017 13s.879.5 2.5.5c0-1 .5-4 1.25-4.5.5 1 .786 1.293 1.371 1.879A2.99 2.99 0 0113 13a2.99 2.99 0 01-.879 2.121z\" clip-rule=\"evenodd\"/></svg>\r\n+          GROUP STAGE • R{currentRound}/3\r\n+        </h1>\r\n+      </div>\r\n+      \r\n+      {#if tournamentState === 'group' && matches.every(m => m.completed)}\r\n+        <button \r\n+          onclick={handleGenerateBrackets}\r\n+          class=\"bg-gradient-to-r from-cyber-pink to-purple-600 text-white font-bold text-xs py-1.5 px-4 rounded-lg shadow-glow-pink hover:scale-105 transition-transform flex items-center gap-1.5\"\r\n+        >\r\n+          Playoffs\r\n+          <svg class=\"w-3 h-3\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\"><path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M13 7l5 5m0 0l-5 5m5-5H6\"/></svg>\r\n+        </button>\r\n+      {/if}\r\n+    </div>\r\n+\r\n+    <!-- Round Progress -->\r\n+    <div class=\"glass rounded-lg p-2 mb-3\">\r\n+      <div class=\"flex items-center gap-2\">\r\n+        {#each availableRounds as round}\r\n+          <button \r\n+            onclick={() => currentRound = round}\r\n+            class=\"flex-1 flex items-center justify-center gap-1.5 py-1.5 px-2 rounded {currentRound === round ? 'bg-cyber-green/20 text-cyber-green' : 'text-gray-500 hover:bg-space-700'} transition-all\"\r\n+          >\r\n+            <div class=\"w-6 h-6 rounded-full border {isRoundComplete(round) ? 'bg-cyber-green border-cyber-green text-space-900' : currentRound === round ? 'border-cyber-green' : 'border-gray-600'} flex items-center justify-center font-bold text-xs\">\r\n+              {#if isRoundComplete(round)}\r\n+                <svg class=\"w-3 h-3\" fill=\"currentColor\" viewBox=\"0 0 20 20\"><path fill-rule=\"evenodd\" d=\"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z\" clip-rule=\"evenodd\"/></svg>\r\n+              {:else}\r\n+                {round}\r\n+              {/if}\r\n+            </div>\r\n+            <span class=\"font-bold text-xs\">R{round}</span>\r\n+          </button>\r\n+        {/each}\r\n+      </div>\r\n+    </div>\r\n+\r\n+    <!-- Group Tables Section -->\r\n+    <div class=\"mb-4\">\r\n+      <h2 class=\"text-base font-bold mb-2 text-white flex items-center gap-1.5\">\r\n+        <svg class=\"w-4 h-4 text-cyber-blue\" fill=\"currentColor\" viewBox=\"0 0 20 20\"><path d=\"M2 11a1 1 0 011-1h2a1 1 0 011 1v5a1 1 0 01-1 1H3a1 1 0 01-1-1v-5zM8 7a1 1 0 011-1h2a1 1 0 011 1v9a1 1 0 01-1 1H9a1 1 0 01-1-1V7zM14 4a1 1 0 011-1h2a1 1 0 011 1v12a1 1 0 01-1 1h-2a1 1 0 01-1-1V4z\"/></svg>\r\n+        Group Tables\r\n+      </h2>\r\n+      <div class=\"grid grid-cols-1 md:grid-cols-2 gap-3\">\r\n+        {#each Object.entries(groupsWithPlayers) as [groupId, groupPlayers] (groupId)}\r\n+          <div class=\"glass rounded-lg p-2\">\r\n+            <!-- Group Header with Edit and Reset -->\r\n+            <div class=\"flex items-center justify-between mb-1.5 px-2\">\r\n+              {#if editingGroupId === groupId}\r\n+                <div class=\"flex items-center gap-2 flex-1\">\r\n+                  <input\r\n+                    type=\"text\"\r\n+                    bind:value={editingGroupName}\r\n+                    class=\"flex-1 px-2 py-1 text-xs bg-space-700 border border-cyber-blue rounded text-white placeholder-gray-400 focus:outline-none focus:ring-1 focus:ring-cyber-green\"\r\n+                    placeholder=\"Group name...\"\r\n+                    onkeydown={(e) => {\r\n+                      if (e.key === 'Enter') saveGroupName(groupId);\r\n+                      if (e.key === 'Escape') cancelEditingGroup();\r\n+                    }}\r\n+                  />\r\n+                  <button\r\n+                    onclick={() => saveGroupName(groupId)}\r\n+                    class=\"px-2 py-1 text-xs bg-cyber-green text-space-900 rounded font-bold hover:bg-cyber-green/80\"\r\n+                  >\r\n+                    ✓\r\n+                  </button>\r\n+                  <button\r\n+                    onclick={cancelEditingGroup}\r\n+                    class=\"px-2 py-1 text-xs bg-gray-600 text-white rounded font-bold hover:bg-gray-500\"\r\n+                  >\r\n+                    ✕\r\n+                  </button>\r\n+                </div>\r\n+              {:else}\r\n+                <div class=\"flex items-center gap-2 flex-1\">\r\n+                  <span class=\"text-xs font-bold text-cyber-blue hover:text-cyber-green transition-colors\">\r\n+                    {getGroupDisplayName(groupId)}\r\n+                  </span>\r\n+                  {#if tournamentState === 'registration'}\r\n+                    <button\r\n+                      class=\"ml-2 px-2 py-1 text-xs bg-cyber-green text-black rounded hover:bg-cyber-green/80\"\r\n+                      onclick={() => startEditingGroup(groupId, getGroupDisplayName(groupId))}\r\n+                    >\r\n+                      Edit\r\n+                    </button>\r\n+                  {/if}\r\n+                </div>\r\n+              {/if}\r\n+              <button\r\n+                onclick={() => handleResetGroup(groupId)}\r\n+                class=\"px-2 py-1 text-xs bg-red-600 text-white rounded font-bold hover:bg-red-500 transition-colors\"\r\n+                title=\"Reset group data\"\r\n+              >\r\n+                <svg class=\"w-3 h-3\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n+                  <path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15\"/>\r\n+                </svg>\r\n+              </button>\r\n+            </div>\r\n+            <table class=\"w-full text-xs\">\r\n+              <thead>\r\n+                <tr class=\"border-b border-space-600\">\r\n+                  <th class=\"text-left py-1 px-1 text-gray-400 font-bold text-xs\">#</th>\r\n+                  <th class=\"text-left py-1 px-1 text-gray-400 font-bold text-xs\">Player</th>\r\n+                  <th class=\"text-center py-1 px-1 text-gray-400 font-bold text-xs\">P</th>\r\n+                  <th class=\"text-center py-1 px-1 text-gray-400 font-bold text-xs\">W</th>\r\n+                  <th class=\"text-center py-1 px-1 text-gray-400 font-bold text-xs\">D</th>\r\n+                  <th class=\"text-center py-1 px-1 text-gray-400 font-bold text-xs\">L</th>\r\n+                  <th class=\"text-center py-1 px-1 text-gray-400 font-bold text-xs\">Pts</th>\r\n+                </tr>\r\n+              </thead>\r\n+              <tbody>\r\n+                {#each groupPlayers as player, index (player.id)}\r\n+                  <tr class=\"border-b border-space-700/50 hover:bg-space-700/30 transition-colors\">\r\n+                    <td class=\"py-1 px-1\">\r\n+                      <div class=\"w-4 h-4 rounded-full flex items-center justify-center font-bold text-xs {index === 0 ? 'bg-gradient-to-br from-yellow-400 to-yellow-600 text-space-900' : index === 1 ? 'bg-gradient-to-br from-gray-300 to-gray-500 text-space-900' : 'bg-space-600 text-gray-400'}\">\r\n+                        {index + 1}\r\n+                      </div>\r\n+                    </td>\r\n+                    <td class=\"py-1 px-1 font-bold text-white text-xs flex items-center gap-2\">\r\n+                      {#if player.profilePhoto}\r\n+                        <img src={player.profilePhoto} alt=\"Profile\" class=\"w-6 h-6 rounded-full object-cover inline-block\" />\r\n+                      {/if}\r\n+                      {player.name}\r\n+                    </td>                    \r\n+                    <td class=\"text-center py-1 px-1 text-gray-400\">{(player.wins || 0) + (player.draws || 0) + (player.losses || 0)}</td>\r\n+                    <td class=\"text-center py-1 px-1 text-cyber-green font-bold\">{player.wins || 0}</td>\r\n+                    <td class=\"text-center py-1 px-1 text-yellow-500 font-bold\">{player.draws || 0}</td>\r\n+                    <td class=\"text-center py-1 px-1 text-red-400 font-bold\">{player.losses || 0}</td>\r\n+                    <td class=\"text-center py-1 px-1 text-cyber-green font-black\">{player.points || 0}</td>\r\n+                  </tr>\r\n+                {/each}\r\n+              </tbody>\r\n+            </table>\r\n+          </div>\r\n+        {/each}\r\n+      </div>\r\n+    </div>\r\n+\r\n+    <!-- Matches Section -->\r\n+    <div>\r\n+      <h2 class=\"text-base font-bold mb-2 text-white\">Round {currentRound} Matches</h2>\r\n+      <div class=\"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-2\">\r\n+        {#each currentRoundMatches as match (match.id)}\r\n+          {@const player1 = getPlayer(match.player1Id)}\r\n+          {@const player2 = getPlayer(match.player2Id)}\r\n+          {@const status = getMatchStatus(match)}\r\n+            \r\n+            <div class=\"glass rounded-lg p-2 relative\">\r\n+              <!-- Status Badge -->\r\n+              <div class=\"absolute top-1.5 right-1.5 flex items-center gap-0.5 px-1.5 py-0.5 rounded text-xs font-bold {status === 'complete' ? 'bg-cyber-green/20 text-cyber-green' : status === 'live' ? 'bg-yellow-500/20 text-yellow-500' : 'bg-gray-500/20 text-gray-400'}\">\r\n+                {#if status === 'complete'}\r\n+                  <svg class=\"w-2.5 h-2.5\" fill=\"currentColor\" viewBox=\"0 0 20 20\"><path fill-rule=\"evenodd\" d=\"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z\" clip-rule=\"evenodd\"/></svg>\r\n+                  Done\r\n+                {:else if status === 'live'}\r\n+                  <svg class=\"w-2.5 h-2.5\" fill=\"currentColor\" viewBox=\"0 0 20 20\"><path fill-rule=\"evenodd\" d=\"M11.3 1.046A1 1 0 0112 2v5h4a1 1 0 01.82 1.573l-7 10A1 1 0 018 18v-5H4a1 1 0 01-.82-1.573l7-10a1 1 0 011.12-.38z\" clip-rule=\"evenodd\"/></svg>\r\n+                  Live\r\n+                {:else}\r\n+                  Pending\r\n+                {/if}\r\n+              </div>\r\n+\r\n+              <div class=\"space-y-1.5\">\r\n+                <!-- Player 1 -->\r\n+                <div class=\"p-2 rounded bg-space-700/50 {matchSelections[match.id]?.[match.player1Id] === 'win' ? 'ring-1 ring-cyber-green' : matchSelections[match.id]?.[match.player1Id] === 'loss' ? 'opacity-60' : ''} transition-all\">\r\n+                  <div class=\"flex items-center justify-between mb-1.5\">\r\n+                    <div class=\"flex items-center gap-2\">\r\n+                      {#if player1?.profilePhoto}\r\n+                        <img src={player1.profilePhoto} alt=\"Profile\" class=\"w-6 h-6 rounded-full object-cover\" />\r\n+                      {:else}\r\n+                        <div class=\"w-6 h-6 rounded-full bg-gradient-to-br from-cyan-500 to-blue-500 flex items-center justify-center\">\r\n+                          <svg class=\"w-3.5 h-3.5 text-white\" fill=\"currentColor\" viewBox=\"0 0 20 20\"><path fill-rule=\"evenodd\" d=\"M10 9a3 3 0 100-6 3 3 0 000 6zm-7 9a7 7 0 1114 0H3z\" clip-rule=\"evenodd\"/></svg>\r\n+                        </div>\r\n+                      {/if}\r\n+                      <div>\r\n+                        <div class=\"font-bold text-xs text-white\">{player1?.name || 'Unknown'}</div>\r\n+                        <div class=\"text-xs text-gray-400\">{player1?.points || 0}pts</div>\r\n+                      </div>\r\n+                    </div>\r\n+                    {#if matchSelections[match.id]?.[match.player1Id] === 'win'}\r\n+                      <svg class=\"w-4 h-4 text-cyber-green\" fill=\"currentColor\" viewBox=\"0 0 20 20\"><path d=\"M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z\"/></svg>\r\n+                    {/if}\r\n+                  </div>\r\n+                  \r\n+                  {#if !match.completed}\r\n+                    <button \r\n+                      onclick={() => setWinner(match.id, match.player1Id, match.player2Id)}\r\n+                      class=\"w-full py-1 px-2 text-xs rounded font-bold transition-all {matchSelections[match.id]?.[match.player1Id] === 'win' ? 'bg-gradient-to-r from-cyber-green to-emerald-500 text-space-900' : 'bg-space-600 hover:bg-cyber-green/20 text-gray-300 hover:text-cyber-green'}\"\r\n+                    >\r\n+                      {matchSelections[match.id]?.[match.player1Id] === 'win' ? '✓ Winner' : 'Winner'}\r\n+                    </button>\r\n+                  {/if}\r\n+                </div>\r\n+\r\n+                <!-- Tie Button -->\r\n+                {#if !match.completed}\r\n+                  <button \r\n+                    onclick={() => setTie(match.id, match.player1Id, match.player2Id)}\r\n+                    class=\"w-full py-0.5 text-xs rounded font-bold transition-all {matchSelections[match.id]?.[match.player1Id] === 'tie' ? 'bg-gradient-to-r from-yellow-400 to-yellow-600 text-space-900' : 'bg-space-700 hover:bg-yellow-500/20 text-gray-300 hover:text-yellow-500'}\"\r\n+                  >\r\n+                    {matchSelections[match.id]?.[match.player1Id] === 'tie' ? '✓ Tie' : 'Tie'}\r\n+                  </button>\r\n+                {/if}\r\n+\r\n+                <!-- Player 2 -->\r\n+                <div class=\"p-2 rounded bg-space-700/50 {matchSelections[match.id]?.[match.player2Id] === 'win' ? 'ring-1 ring-cyber-green' : matchSelections[match.id]?.[match.player2Id] === 'loss' ? 'opacity-60' : ''} transition-all\">\r\n+                  <div class=\"flex items-center justify-between mb-1.5\">\r\n+                    <div class=\"flex items-center gap-2\">\r\n+                      {#if player2?.profilePhoto}\r\n+                        <img src={player2.profilePhoto} alt=\"Profile\" class=\"w-6 h-6 rounded-full object-cover\" />\r\n+                      {:else}\r\n+                        <div class=\"w-6 h-6 rounded-full bg-gradient-to-br from-purple-500 to-pink-500 flex items-center justify-center\">\r\n+                          <svg class=\"w-3.5 h-3.5 text-white\" fill=\"currentColor\" viewBox=\"0 0 20 20\"><path fill-rule=\"evenodd\" d=\"M10 9a3 3 0 100-6 3 3 0 000 6zm-7 9a7 7 0 1114 0H3z\" clip-rule=\"evenodd\"/></svg>\r\n+                        </div>\r\n+                      {/if}\r\n+                      <div>\r\n+                        <div class=\"font-bold text-xs text-white\">{player2?.name || 'Unknown'}</div>\r\n+                        <div class=\"text-xs text-gray-400\">{player2?.points || 0}pts</div>\r\n+                      </div>\r\n+                    </div>\r\n+                    {#if matchSelections[match.id]?.[match.player2Id] === 'win'}\r\n+                      <svg class=\"w-4 h-4 text-cyber-green\" fill=\"currentColor\" viewBox=\"0 0 20 20\"><path d=\"M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z\"/></svg>\r\n+                    {/if}\r\n+                  </div>\r\n+                  \r\n+                  {#if !match.completed}\r\n+                    <button \r\n+                      onclick={() => setWinner(match.id, match.player2Id, match.player1Id)}\r\n+                      class=\"w-full py-1 px-2 text-xs rounded font-bold transition-all {matchSelections[match.id]?.[match.player2Id] === 'win' ? 'bg-gradient-to-r from-cyber-green to-emerald-500 text-space-900' : 'bg-space-600 hover:bg-cyber-green/20 text-gray-300 hover:text-cyber-green'}\"\r\n+                    >\r\n+                      {matchSelections[match.id]?.[match.player2Id] === 'win' ? '✓ Winner' : 'Winner'}\r\n+                    </button>\r\n+                  {/if}\r\n+                </div>\r\n+              </div>\r\n+\r\n+              <!-- Submit Button -->\r\n+              {#if !match.completed && (matchSelections[match.id]?.[match.player1Id] || matchSelections[match.id]?.[match.player2Id])}\r\n+                <div class=\"mt-1.5\">\r\n+                  <button \r\n+                    onclick={() => submitMatchResult(match.id)}\r\n+                    class=\"w-full bg-gradient-to-r from-cyber-blue to-blue-600 text-white font-bold py-1.5 px-3 rounded text-xs hover:scale-102 transition-all\"\r\n+                  >\r\n+                    Submit Result\r\n+                  </button>\r\n+                </div>\r\n+              {/if}\r\n+            </div>\r\n+        {/each}\r\n+    </div>\r\n+\r\n+    <!-- Full Tournament Reset Button -->\r\n+    <div class=\"text-center pt-8 border-t border-space-600 mt-8\">\r\n       <button\r\n-        class=\"ml-2 px-2 py-1 text-xs bg-cyber-green text-black rounded hover:bg-cyber-green/80\"\r\n-        onclick={() => startEditingGroup(groupId, getGroupDisplayName(groupId))}\r\n+        onclick={() => handleResetTournament()}\r\n+        class=\"text-red-400/70 hover:text-red-400 text-base font-semibold transition-colors hover:underline\"\r\n       >\r\n-        Edit\r\n+        <svg class=\"w-4 h-4 inline-block mr-1\" fill=\"currentColor\" viewBox=\"0 0 20 20\"><path fill-rule=\"evenodd\" d=\"M9 2a1 1 0 00-.894.553L7.382 4H4a1 1 0 000 2v10a2 2 0 002 2h8a2 2 0 002-2V6a1 1 0 100-2h-3.382l-.724-1.447A1 1 0 0011 2H9zM7 8a1 1 0 012 0v6a1 1 0 11-2 0V8zm5-1a1 1 0 00-1 1v6a1 1 0 102 0V8a1 1 0 00-1-1z\" clip-rule=\"evenodd\"/></svg>\r\n+        Reset Entire Tournament\r\n       </button>\r\n-    {/if}\r\n-  {/if}\r\n+    </div>\r\n+  </div>\r\n </div>\r\n-{#if isAdmin}\r\n-  <button\r\n-    onclick={() => handleResetGroup(groupId)}\r\n-    class=\"px-2 py-1 text-xs bg-red-600 text-white rounded font-bold hover:bg-red-500 transition-colors\"\r\n-    title=\"Reset group data\"\r\n-  >\r\n-    <svg class=\"w-3 h-3\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n-      <path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15\"/>\r\n-    </svg>\r\n-  </button>\r\n-{/if}\r\n+</div>\r\n"
                },
                {
                    "date": 1764074705468,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1,518 +1,26 @@\n+<!-- ...inside your script tag, add: -->\r\n <script lang=\"ts\">\r\n-  import { onMount } from 'svelte';\r\n-  import { getState, submitMatch, generateBrackets, updateGroupName, resetGroupData, resetTournament } from '$lib/api';\r\n-\r\n-  let { tournamentId } = $props<{ tournamentId: string }>();\r\n-\r\n-  let pods = $state([]) as any[];\r\n-  let matches = $state([]) as any[];\r\n-  let players = $state([]) as any[];\r\n-  let tournamentState = $state('');\r\n-  let currentRound = $state(1);\r\n-\r\n-  // Local state to track UI selections before submission\r\n-  let matchSelections = $state({}) as Record<string, { [pid: string]: 'win' | 'loss' | 'tie' }>;\r\n-\r\n-  // Group editing state\r\n-  let editingGroupId = $state(null) as string | null;\r\n-  let editingGroupName = $state('');\r\n-\r\n-  // Group name editing functions\r\n-  function startEditingGroup(groupId: string, currentName: string) {\r\n-    editingGroupId = groupId;\r\n-    editingGroupName = currentName || `Group ${groupId}`;\r\n-  }\r\n-\r\n-  function cancelEditingGroup() {\r\n-    editingGroupId = null;\r\n-    editingGroupName = '';\r\n-  }\r\n-\r\n-  async function saveGroupName(groupId: string) {\r\n-    try {\r\n-      await updateGroupName(tournamentId, groupId, editingGroupName.trim());\r\n-      await loadState();\r\n-      editingGroupId = null;\r\n-      editingGroupName = '';\r\n-    } catch (error) {\r\n-      console.error('Failed to update group name:', error);\r\n-      alert('Failed to update group name');\r\n-    }\r\n-  }\r\n-\r\n-  async function handleResetGroup(groupId: string) {\r\n-    if (confirm('Reset all match results for this group? This will clear all player stats in this group.')) {\r\n-      try {\r\n-        await resetGroupData(tournamentId, groupId);\r\n-        await loadState();\r\n-      } catch (error) {\r\n-        console.error('Failed to reset group data:', error);\r\n-        alert('Failed to reset group data');\r\n-      }\r\n-    }\r\n-  }\r\n-\r\n-  async function handleResetTournament() {\r\n-    if (confirm('Reset the entire tournament? This will delete ALL tournament data including players, groups, matches, and brackets. This action cannot be undone.')) {\r\n-      try {\r\n-        await resetTournament(tournamentId);\r\n-        window.location.href = '/';\r\n-      } catch (error) {\r\n-        console.error('Failed to reset tournament:', error);\r\n-        alert('Failed to reset tournament');\r\n-      }\r\n-    }\r\n-  }\r\n-\r\n-  function getGroupDisplayName(groupId: string) {\r\n-    const pod = pods.find(p => p.id === groupId);\r\n-    return pod?.name || `Group ${groupId}`;\r\n-  }\r\n-  \r\n-  // Reactive derived values using $derived\r\n-  let currentRoundMatches = $derived(getMatchesForRound(currentRound));\r\n-  let groupsWithPlayers = $derived(getGroupsWithPlayers());\r\n-  let availableRounds = $derived([...new Set(matches.map(m => m.round))].sort((a, b) => a - b));\r\n-  \r\n-  // Debug logging with $effect\r\n-  $effect(() => {\r\n-    console.log('[Groups] Reactive update - currentRound:', currentRound);\r\n-    console.log('[Groups] Reactive update - matches count:', matches.length);\r\n-    console.log('[Groups] Reactive update - currentRoundMatches count:', currentRoundMatches.length);\r\n-    console.log('[Groups] Reactive update - matchSelections:', matchSelections);\r\n-    console.log('[Groups] Reactive update - pods:', pods.length);\r\n-  });\r\n-\r\n-  async function loadState() {\r\n-    console.log('[Groups] loadState() called');\r\n-    const data = await getState(tournamentId);\r\n-    console.log('[Groups] loadState() received data:', {\r\n-      podsCount: data.pods.length,\r\n-      matchesCount: data.matches.length,\r\n-      playersCount: data.players.length,\r\n-      state: data.state\r\n-    });\r\n-\r\n-    // With $state, direct assignment triggers reactivity\r\n-    pods = data.pods;\r\n-    matches = data.matches;\r\n-    players = data.players;\r\n-    tournamentState = data.state;\r\n-\r\n-    // Initialize selections from existing results\r\n-    matches.forEach(m => {\r\n-        if (m.result) {\r\n-            matchSelections[m.id] = {};\r\n-            Object.entries(m.result).forEach(([pid, res]: [string, any]) => {\r\n-                if (res.points === 3) matchSelections[m.id][pid] = 'win';\r\n-                else if (res.points === 1) matchSelections[m.id][pid] = 'tie';\r\n-                else matchSelections[m.id][pid] = 'loss';\r\n-            });\r\n-        }\r\n-    });\r\n-\r\n-    console.log('[Groups] loadState() complete - matchSelections:', matchSelections);\r\n-  }\r\n-\r\n-  function getPlayerName(id: string) {\r\n-    return players.find(p => p.id === id)?.name || 'Unknown';\r\n-  }\r\n-\r\n-  function getPlayer(id: string) {\r\n-    return players.find(p => p.id === id);\r\n-  }\r\n-\r\n-  function getMatchForPod(podId: string) {\r\n-    return matches.find(m => m.podId === podId);\r\n-  }\r\n-  \r\n-  function getMatchesForPod(podId: string) {\r\n-    return matches.filter(m => m.podId === podId);\r\n-  }\r\n-  \r\n-  function getMatchesForRound(round: number) {\r\n-    return matches.filter(m => m.round === round);\r\n-  }\r\n-  \r\n-  function isRoundComplete(round: number) {\r\n-    const roundMatches = getMatchesForRound(round);\r\n-    return roundMatches.length > 0 && roundMatches.every(m => m.completed);\r\n-  }\r\n-  \r\n-  function getMatchStatus(match: any) {\r\n-    if (!match) return 'pending';\r\n-    if (match.completed) return 'complete';\r\n-    if (matchSelections[match.id]) return 'live';\r\n-    return 'pending';\r\n-  }\r\n-\r\n-  function setWinner(matchId: string, winnerId: string, loserId: string) {\r\n-      console.log('[Groups] setWinner called:', { matchId, winnerId, loserId });\r\n-      matchSelections[matchId] = {\r\n-          [winnerId]: 'win',\r\n-          [loserId]: 'loss'\r\n-      };\r\n-      console.log('[Groups] setWinner complete - matchSelections:', matchSelections);\r\n-  }\r\n-\r\n-  function setTie(matchId: string, p1Id: string, p2Id: string) {\r\n-      console.log('[Groups] setTie called:', { matchId, p1Id, p2Id });\r\n-      matchSelections[matchId] = {\r\n-          [p1Id]: 'tie',\r\n-          [p2Id]: 'tie'\r\n-      };\r\n-      console.log('[Groups] setTie complete - matchSelections:', matchSelections);\r\n-  }\r\n-\r\n-  async function submitMatchResult(matchId: string) {\r\n-      console.log('[Groups] submitMatchResult called:', matchId);\r\n-      const selection = matchSelections[matchId];\r\n-      if (!selection) return;\r\n-\r\n-      const results: any = {};\r\n-      Object.entries(selection).forEach(([pid, status]) => {\r\n-          let points = 0;\r\n-          if (status === 'win') points = 3;\r\n-          if (status === 'tie') points = 1;\r\n-          results[pid] = { points };\r\n-      });\r\n-\r\n-      console.log('[Groups] submitMatchResult - submitting results:', results);\r\n-      // FIX: include tournamentId as first arg\r\n-      await submitMatch(tournamentId, matchId, results);\r\n-      console.log('[Groups] submitMatchResult - match submitted, reloading state');\r\n-      await loadState();\r\n-      console.log('[Groups] submitMatchResult complete');\r\n-  }\r\n-\r\n-  async function handleGenerateBrackets() {\r\n-      if (confirm('Finish Group Stage and Generate Brackets?')) {\r\n-          try {\r\n-              console.log('[Groups] Generating brackets...');\r\n-              await generateBrackets(tournamentId);\r\n-              console.log('[Groups] Brackets generated, redirecting...');\r\n-              window.location.href = `/tournament/${tournamentId}/brackets`;\r\n-          } catch (error) {\r\n-              console.error('[Groups] Error generating brackets:', error);\r\n-              alert('Failed to generate brackets. Check console for details.');\r\n-          }\r\n-      }\r\n-  }\r\n-\r\n-  function getStandings() {\r\n-    return [...players].sort((a, b) => {\r\n-      if (b.points !== a.points) return b.points - a.points;\r\n-      // Tiebreaker: goal difference, then wins\r\n-      if (b.wins !== a.wins) return b.wins - a.wins;\r\n-      return 0;\r\n-    });\r\n-  }\r\n-\r\n-  // Group players by their pod/group\r\n-  function getGroupsWithPlayers() {\r\n-    // Get unique pod IDs for round 1 to determine groups\r\n-    const round1Pods = pods.filter(p => p.round === 1);\r\n-    const groups: Record<string, any[]> = {};\r\n-    \r\n-    round1Pods.forEach(pod => {\r\n-      const groupKey = pod.id;\r\n-      if (!groups[groupKey]) groups[groupKey] = [];\r\n-      \r\n-      // Get players directly from pod.players\r\n-      pod.players.forEach((pid: string) => {\r\n-        const player = getPlayer(pid);\r\n-        if (player && !groups[groupKey].find(p => p.id === pid)) {\r\n-          groups[groupKey].push(player);\r\n-        }\r\n-      });\r\n-    });\r\n-    \r\n-    // Sort players within each group by standings\r\n-    Object.keys(groups).forEach(key => {\r\n-      groups[key].sort((a, b) => {\r\n-        if (b.points !== a.points) return b.points - a.points;\r\n-        if (b.wins !== a.wins) return b.wins - a.wins;\r\n-        return 0;\r\n-      });\r\n-    });\r\n-    \r\n-    return groups;\r\n-  }\r\n-\r\n-  onMount(loadState);\r\n+  // ...existing code...\r\n+  // Add this line if not already present:\r\n+  export let isAdmin: boolean = false;\r\n+  // ...existing code...\r\n </script>\r\n \r\n-<div class=\"min-h-screen bg-gradient-to-br from-space-900 via-space-800 to-space-900 text-gaming-text px-3 py-3\">\r\n-  <div class=\"max-w-7xl mx-auto\">\r\n-    \r\n-    <!-- Header -->\r\n-    <div class=\"flex justify-between items-center mb-3\">\r\n-      <div>\r\n-        <a href={`/tournament/${tournamentId}`} class=\"text-gray-400 hover:text-cyber-green transition-colors mb-1 inline-block text-xs flex items-center gap-1\">\r\n-          <svg class=\"w-3 h-3\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\"><path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M10 19l-7-7m0 0l7-7m-7 7h18\"/></svg>\r\n-          Back\r\n-        </a>\r\n-        <h1 class=\"text-xl font-black gradient-text flex items-center gap-1.5\">\r\n-          <svg class=\"w-5 h-5 text-cyber-pink\" fill=\"currentColor\" viewBox=\"0 0 20 20\"><path fill-rule=\"evenodd\" d=\"M12.395 2.553a1 1 0 00-1.45-.385c-.345.23-.614.558-.822.88-.214.33-.403.713-.57 1.116-.334.804-.614 1.768-.84 2.734a31.365 31.365 0 00-.613 3.58 2.64 2.64 0 01-.945-1.067c-.328-.68-.398-1.534-.398-2.654A1 1 0 005.05 6.05 6.981 6.981 0 003 11a7 7 0 1011.95-4.95c-.592-.591-.98-.985-1.348-1.467-.363-.476-.724-1.063-1.207-2.03zM12.12 15.12A3 3 0 017 13s.879.5 2.5.5c0-1 .5-4 1.25-4.5.5 1 .786 1.293 1.371 1.879A2.99 2.99 0 0113 13a2.99 2.99 0 01-.879 2.121z\" clip-rule=\"evenodd\"/></svg>\r\n-          GROUP STAGE • R{currentRound}/3\r\n-        </h1>\r\n-      </div>\r\n-      \r\n-      {#if tournamentState === 'group' && matches.every(m => m.completed)}\r\n-        <button \r\n-          onclick={handleGenerateBrackets}\r\n-          class=\"bg-gradient-to-r from-cyber-pink to-purple-600 text-white font-bold text-xs py-1.5 px-4 rounded-lg shadow-glow-pink hover:scale-105 transition-transform flex items-center gap-1.5\"\r\n-        >\r\n-          Playoffs\r\n-          <svg class=\"w-3 h-3\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\"><path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M13 7l5 5m0 0l-5 5m5-5H6\"/></svg>\r\n-        </button>\r\n-      {/if}\r\n-    </div>\r\n-\r\n-    <!-- Round Progress -->\r\n-    <div class=\"glass rounded-lg p-2 mb-3\">\r\n-      <div class=\"flex items-center gap-2\">\r\n-        {#each availableRounds as round}\r\n-          <button \r\n-            onclick={() => currentRound = round}\r\n-            class=\"flex-1 flex items-center justify-center gap-1.5 py-1.5 px-2 rounded {currentRound === round ? 'bg-cyber-green/20 text-cyber-green' : 'text-gray-500 hover:bg-space-700'} transition-all\"\r\n-          >\r\n-            <div class=\"w-6 h-6 rounded-full border {isRoundComplete(round) ? 'bg-cyber-green border-cyber-green text-space-900' : currentRound === round ? 'border-cyber-green' : 'border-gray-600'} flex items-center justify-center font-bold text-xs\">\r\n-              {#if isRoundComplete(round)}\r\n-                <svg class=\"w-3 h-3\" fill=\"currentColor\" viewBox=\"0 0 20 20\"><path fill-rule=\"evenodd\" d=\"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z\" clip-rule=\"evenodd\"/></svg>\r\n-              {:else}\r\n-                {round}\r\n-              {/if}\r\n-            </div>\r\n-            <span class=\"font-bold text-xs\">R{round}</span>\r\n-          </button>\r\n-        {/each}\r\n-      </div>\r\n-    </div>\r\n-\r\n-    <!-- Group Tables Section -->\r\n-    <div class=\"mb-4\">\r\n-      <h2 class=\"text-base font-bold mb-2 text-white flex items-center gap-1.5\">\r\n-        <svg class=\"w-4 h-4 text-cyber-blue\" fill=\"currentColor\" viewBox=\"0 0 20 20\"><path d=\"M2 11a1 1 0 011-1h2a1 1 0 011 1v5a1 1 0 01-1 1H3a1 1 0 01-1-1v-5zM8 7a1 1 0 011-1h2a1 1 0 011 1v9a1 1 0 01-1 1H9a1 1 0 01-1-1V7zM14 4a1 1 0 011-1h2a1 1 0 011 1v12a1 1 0 01-1 1h-2a1 1 0 01-1-1V4z\"/></svg>\r\n-        Group Tables\r\n-      </h2>\r\n-      <div class=\"grid grid-cols-1 md:grid-cols-2 gap-3\">\r\n-        {#each Object.entries(groupsWithPlayers) as [groupId, groupPlayers] (groupId)}\r\n-          <div class=\"glass rounded-lg p-2\">\r\n-            <!-- Group Header with Edit and Reset -->\r\n-            <div class=\"flex items-center justify-between mb-1.5 px-2\">\r\n-              {#if editingGroupId === groupId}\r\n-                <div class=\"flex items-center gap-2 flex-1\">\r\n-                  <input\r\n-                    type=\"text\"\r\n-                    bind:value={editingGroupName}\r\n-                    class=\"flex-1 px-2 py-1 text-xs bg-space-700 border border-cyber-blue rounded text-white placeholder-gray-400 focus:outline-none focus:ring-1 focus:ring-cyber-green\"\r\n-                    placeholder=\"Group name...\"\r\n-                    onkeydown={(e) => {\r\n-                      if (e.key === 'Enter') saveGroupName(groupId);\r\n-                      if (e.key === 'Escape') cancelEditingGroup();\r\n-                    }}\r\n-                  />\r\n-                  <button\r\n-                    onclick={() => saveGroupName(groupId)}\r\n-                    class=\"px-2 py-1 text-xs bg-cyber-green text-space-900 rounded font-bold hover:bg-cyber-green/80\"\r\n-                  >\r\n-                    ✓\r\n-                  </button>\r\n-                  <button\r\n-                    onclick={cancelEditingGroup}\r\n-                    class=\"px-2 py-1 text-xs bg-gray-600 text-white rounded font-bold hover:bg-gray-500\"\r\n-                  >\r\n-                    ✕\r\n-                  </button>\r\n-                </div>\r\n-              {:else}\r\n-                <div class=\"flex items-center gap-2 flex-1\">\r\n-                  <span class=\"text-xs font-bold text-cyber-blue hover:text-cyber-green transition-colors\">\r\n-                    {getGroupDisplayName(groupId)}\r\n-                  </span>\r\n-                  {#if tournamentState === 'registration'}\r\n-                    <button\r\n-                      class=\"ml-2 px-2 py-1 text-xs bg-cyber-green text-black rounded hover:bg-cyber-green/80\"\r\n-                      onclick={() => startEditingGroup(groupId, getGroupDisplayName(groupId))}\r\n-                    >\r\n-                      Edit\r\n-                    </button>\r\n-                  {/if}\r\n-                </div>\r\n-              {/if}\r\n-              <button\r\n-                onclick={() => handleResetGroup(groupId)}\r\n-                class=\"px-2 py-1 text-xs bg-red-600 text-white rounded font-bold hover:bg-red-500 transition-colors\"\r\n-                title=\"Reset group data\"\r\n-              >\r\n-                <svg class=\"w-3 h-3\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n-                  <path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15\"/>\r\n-                </svg>\r\n-              </button>\r\n-            </div>\r\n-            <table class=\"w-full text-xs\">\r\n-              <thead>\r\n-                <tr class=\"border-b border-space-600\">\r\n-                  <th class=\"text-left py-1 px-1 text-gray-400 font-bold text-xs\">#</th>\r\n-                  <th class=\"text-left py-1 px-1 text-gray-400 font-bold text-xs\">Player</th>\r\n-                  <th class=\"text-center py-1 px-1 text-gray-400 font-bold text-xs\">P</th>\r\n-                  <th class=\"text-center py-1 px-1 text-gray-400 font-bold text-xs\">W</th>\r\n-                  <th class=\"text-center py-1 px-1 text-gray-400 font-bold text-xs\">D</th>\r\n-                  <th class=\"text-center py-1 px-1 text-gray-400 font-bold text-xs\">L</th>\r\n-                  <th class=\"text-center py-1 px-1 text-gray-400 font-bold text-xs\">Pts</th>\r\n-                </tr>\r\n-              </thead>\r\n-              <tbody>\r\n-                {#each groupPlayers as player, index (player.id)}\r\n-                  <tr class=\"border-b border-space-700/50 hover:bg-space-700/30 transition-colors\">\r\n-                    <td class=\"py-1 px-1\">\r\n-                      <div class=\"w-4 h-4 rounded-full flex items-center justify-center font-bold text-xs {index === 0 ? 'bg-gradient-to-br from-yellow-400 to-yellow-600 text-space-900' : index === 1 ? 'bg-gradient-to-br from-gray-300 to-gray-500 text-space-900' : 'bg-space-600 text-gray-400'}\">\r\n-                        {index + 1}\r\n-                      </div>\r\n-                    </td>\r\n-                    <td class=\"py-1 px-1 font-bold text-white text-xs flex items-center gap-2\">\r\n-                      {#if player.profilePhoto}\r\n-                        <img src={player.profilePhoto} alt=\"Profile\" class=\"w-6 h-6 rounded-full object-cover inline-block\" />\r\n-                      {/if}\r\n-                      {player.name}\r\n-                    </td>                    \r\n-                    <td class=\"text-center py-1 px-1 text-gray-400\">{(player.wins || 0) + (player.draws || 0) + (player.losses || 0)}</td>\r\n-                    <td class=\"text-center py-1 px-1 text-cyber-green font-bold\">{player.wins || 0}</td>\r\n-                    <td class=\"text-center py-1 px-1 text-yellow-500 font-bold\">{player.draws || 0}</td>\r\n-                    <td class=\"text-center py-1 px-1 text-red-400 font-bold\">{player.losses || 0}</td>\r\n-                    <td class=\"text-center py-1 px-1 text-cyber-green font-black\">{player.points || 0}</td>\r\n-                  </tr>\r\n-                {/each}\r\n-              </tbody>\r\n-            </table>\r\n-          </div>\r\n-        {/each}\r\n-      </div>\r\n-    </div>\r\n-\r\n-    <!-- Matches Section -->\r\n-    <div>\r\n-      <h2 class=\"text-base font-bold mb-2 text-white\">Round {currentRound} Matches</h2>\r\n-      <div class=\"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-2\">\r\n-        {#each currentRoundMatches as match (match.id)}\r\n-          {@const player1 = getPlayer(match.player1Id)}\r\n-          {@const player2 = getPlayer(match.player2Id)}\r\n-          {@const status = getMatchStatus(match)}\r\n-            \r\n-            <div class=\"glass rounded-lg p-2 relative\">\r\n-              <!-- Status Badge -->\r\n-              <div class=\"absolute top-1.5 right-1.5 flex items-center gap-0.5 px-1.5 py-0.5 rounded text-xs font-bold {status === 'complete' ? 'bg-cyber-green/20 text-cyber-green' : status === 'live' ? 'bg-yellow-500/20 text-yellow-500' : 'bg-gray-500/20 text-gray-400'}\">\r\n-                {#if status === 'complete'}\r\n-                  <svg class=\"w-2.5 h-2.5\" fill=\"currentColor\" viewBox=\"0 0 20 20\"><path fill-rule=\"evenodd\" d=\"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z\" clip-rule=\"evenodd\"/></svg>\r\n-                  Done\r\n-                {:else if status === 'live'}\r\n-                  <svg class=\"w-2.5 h-2.5\" fill=\"currentColor\" viewBox=\"0 0 20 20\"><path fill-rule=\"evenodd\" d=\"M11.3 1.046A1 1 0 0112 2v5h4a1 1 0 01.82 1.573l-7 10A1 1 0 018 18v-5H4a1 1 0 01-.82-1.573l7-10a1 1 0 011.12-.38z\" clip-rule=\"evenodd\"/></svg>\r\n-                  Live\r\n-                {:else}\r\n-                  Pending\r\n-                {/if}\r\n-              </div>\r\n-\r\n-              <div class=\"space-y-1.5\">\r\n-                <!-- Player 1 -->\r\n-                <div class=\"p-2 rounded bg-space-700/50 {matchSelections[match.id]?.[match.player1Id] === 'win' ? 'ring-1 ring-cyber-green' : matchSelections[match.id]?.[match.player1Id] === 'loss' ? 'opacity-60' : ''} transition-all\">\r\n-                  <div class=\"flex items-center justify-between mb-1.5\">\r\n-                    <div class=\"flex items-center gap-2\">\r\n-                      {#if player1?.profilePhoto}\r\n-                        <img src={player1.profilePhoto} alt=\"Profile\" class=\"w-6 h-6 rounded-full object-cover\" />\r\n-                      {:else}\r\n-                        <div class=\"w-6 h-6 rounded-full bg-gradient-to-br from-cyan-500 to-blue-500 flex items-center justify-center\">\r\n-                          <svg class=\"w-3.5 h-3.5 text-white\" fill=\"currentColor\" viewBox=\"0 0 20 20\"><path fill-rule=\"evenodd\" d=\"M10 9a3 3 0 100-6 3 3 0 000 6zm-7 9a7 7 0 1114 0H3z\" clip-rule=\"evenodd\"/></svg>\r\n-                        </div>\r\n-                      {/if}\r\n-                      <div>\r\n-                        <div class=\"font-bold text-xs text-white\">{player1?.name || 'Unknown'}</div>\r\n-                        <div class=\"text-xs text-gray-400\">{player1?.points || 0}pts</div>\r\n-                      </div>\r\n-                    </div>\r\n-                    {#if matchSelections[match.id]?.[match.player1Id] === 'win'}\r\n-                      <svg class=\"w-4 h-4 text-cyber-green\" fill=\"currentColor\" viewBox=\"0 0 20 20\"><path d=\"M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z\"/></svg>\r\n-                    {/if}\r\n-                  </div>\r\n-                  \r\n-                  {#if !match.completed}\r\n-                    <button \r\n-                      onclick={() => setWinner(match.id, match.player1Id, match.player2Id)}\r\n-                      class=\"w-full py-1 px-2 text-xs rounded font-bold transition-all {matchSelections[match.id]?.[match.player1Id] === 'win' ? 'bg-gradient-to-r from-cyber-green to-emerald-500 text-space-900' : 'bg-space-600 hover:bg-cyber-green/20 text-gray-300 hover:text-cyber-green'}\"\r\n-                    >\r\n-                      {matchSelections[match.id]?.[match.player1Id] === 'win' ? '✓ Winner' : 'Winner'}\r\n-                    </button>\r\n-                  {/if}\r\n-                </div>\r\n-\r\n-                <!-- Tie Button -->\r\n-                {#if !match.completed}\r\n-                  <button \r\n-                    onclick={() => setTie(match.id, match.player1Id, match.player2Id)}\r\n-                    class=\"w-full py-0.5 text-xs rounded font-bold transition-all {matchSelections[match.id]?.[match.player1Id] === 'tie' ? 'bg-gradient-to-r from-yellow-400 to-yellow-600 text-space-900' : 'bg-space-700 hover:bg-yellow-500/20 text-gray-300 hover:text-yellow-500'}\"\r\n-                  >\r\n-                    {matchSelections[match.id]?.[match.player1Id] === 'tie' ? '✓ Tie' : 'Tie'}\r\n-                  </button>\r\n-                {/if}\r\n-\r\n-                <!-- Player 2 -->\r\n-                <div class=\"p-2 rounded bg-space-700/50 {matchSelections[match.id]?.[match.player2Id] === 'win' ? 'ring-1 ring-cyber-green' : matchSelections[match.id]?.[match.player2Id] === 'loss' ? 'opacity-60' : ''} transition-all\">\r\n-                  <div class=\"flex items-center justify-between mb-1.5\">\r\n-                    <div class=\"flex items-center gap-2\">\r\n-                      {#if player2?.profilePhoto}\r\n-                        <img src={player2.profilePhoto} alt=\"Profile\" class=\"w-6 h-6 rounded-full object-cover\" />\r\n-                      {:else}\r\n-                        <div class=\"w-6 h-6 rounded-full bg-gradient-to-br from-purple-500 to-pink-500 flex items-center justify-center\">\r\n-                          <svg class=\"w-3.5 h-3.5 text-white\" fill=\"currentColor\" viewBox=\"0 0 20 20\"><path fill-rule=\"evenodd\" d=\"M10 9a3 3 0 100-6 3 3 0 000 6zm-7 9a7 7 0 1114 0H3z\" clip-rule=\"evenodd\"/></svg>\r\n-                        </div>\r\n-                      {/if}\r\n-                      <div>\r\n-                        <div class=\"font-bold text-xs text-white\">{player2?.name || 'Unknown'}</div>\r\n-                        <div class=\"text-xs text-gray-400\">{player2?.points || 0}pts</div>\r\n-                      </div>\r\n-                    </div>\r\n-                    {#if matchSelections[match.id]?.[match.player2Id] === 'win'}\r\n-                      <svg class=\"w-4 h-4 text-cyber-green\" fill=\"currentColor\" viewBox=\"0 0 20 20\"><path d=\"M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z\"/></svg>\r\n-                    {/if}\r\n-                  </div>\r\n-                  \r\n-                  {#if !match.completed}\r\n-                    <button \r\n-                      onclick={() => setWinner(match.id, match.player2Id, match.player1Id)}\r\n-                      class=\"w-full py-1 px-2 text-xs rounded font-bold transition-all {matchSelections[match.id]?.[match.player2Id] === 'win' ? 'bg-gradient-to-r from-cyber-green to-emerald-500 text-space-900' : 'bg-space-600 hover:bg-cyber-green/20 text-gray-300 hover:text-cyber-green'}\"\r\n-                    >\r\n-                      {matchSelections[match.id]?.[match.player2Id] === 'win' ? '✓ Winner' : 'Winner'}\r\n-                    </button>\r\n-                  {/if}\r\n-                </div>\r\n-              </div>\r\n-\r\n-              <!-- Submit Button -->\r\n-              {#if !match.completed && (matchSelections[match.id]?.[match.player1Id] || matchSelections[match.id]?.[match.player2Id])}\r\n-                <div class=\"mt-1.5\">\r\n-                  <button \r\n-                    onclick={() => submitMatchResult(match.id)}\r\n-                    class=\"w-full bg-gradient-to-r from-cyber-blue to-blue-600 text-white font-bold py-1.5 px-3 rounded text-xs hover:scale-102 transition-all\"\r\n-                  >\r\n-                    Submit Result\r\n-                  </button>\r\n-                </div>\r\n-              {/if}\r\n-            </div>\r\n-        {/each}\r\n-    </div>\r\n-\r\n-    <!-- Full Tournament Reset Button -->\r\n-    <div class=\"text-center pt-8 border-t border-space-600 mt-8\">\r\n+<!-- ...inside your markup, replace the edit button section with: -->\r\n+{#if editingGroupId === groupId}\r\n+  <!-- ...existing editing UI... -->\r\n+{:else}\r\n+  <div class=\"flex items-center gap-2 flex-1\">\r\n+    <span class=\"text-xs font-bold text-cyber-blue hover:text-cyber-green transition-colors\">\r\n+      {getGroupDisplayName(groupId)}\r\n+    </span>\r\n+    {#if isAdmin && tournamentState === 'registration'}\r\n       <button\r\n-        onclick={() => handleResetTournament()}\r\n-        class=\"text-red-400/70 hover:text-red-400 text-base font-semibold transition-colors hover:underline\"\r\n+        class=\"ml-2 px-2 py-1 text-xs bg-cyber-green text-black rounded hover:bg-cyber-green/80\"\r\n+        onclick={() => startEditingGroup(groupId, getGroupDisplayName(groupId))}\r\n       >\r\n-        <svg class=\"w-4 h-4 inline-block mr-1\" fill=\"currentColor\" viewBox=\"0 0 20 20\"><path fill-rule=\"evenodd\" d=\"M9 2a1 1 0 00-.894.553L7.382 4H4a1 1 0 000 2v10a2 2 0 002 2h8a2 2 0 002-2V6a1 1 0 100-2h-3.382l-.724-1.447A1 1 0 0011 2H9zM7 8a1 1 0 012 0v6a1 1 0 11-2 0V8zm5-1a1 1 0 00-1 1v6a1 1 0 102 0V8a1 1 0 00-1-1z\" clip-rule=\"evenodd\"/></svg>\r\n-        Reset Entire Tournament\r\n+        Edit\r\n       </button>\r\n-    </div>\r\n+    {/if}\r\n   </div>\r\n-</div>\r\n-</div>\r\n+{/if}\r\n"
                },
                {
                    "date": 1764074748512,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1,26 +1,523 @@\n-<!-- ...inside your script tag, add: -->\r\n <script lang=\"ts\">\r\n-  // ...existing code...\r\n-  // Add this line if not already present:\r\n-  export let isAdmin: boolean = false;\r\n-  // ...existing code...\r\n+  import { onMount } from 'svelte';\r\n+  import { getState, submitMatch, generateBrackets, updateGroupName, resetGroupData, resetTournament } from '$lib/api';\r\n+\r\n+  let { tournamentId } = $props<{ tournamentId: string }>();\r\n+\r\n+  let pods = $state([]) as any[];\r\n+  let matches = $state([]) as any[];\r\n+  let players = $state([]) as any[];\r\n+  let tournamentState = $state('');\r\n+  let currentRound = $state(1);\r\n+\r\n+  // Local state to track UI selections before submission\r\n+  let matchSelections = $state({}) as Record<string, { [pid: string]: 'win' | 'loss' | 'tie' }>;\r\n+\r\n+  // Group editing state\r\n+  let editingGroupId = $state(null) as string | null;\r\n+  let editingGroupName = $state('');\r\n+\r\n+  // Group name editing functions\r\n+  function startEditingGroup(groupId: string, currentName: string) {\r\n+    editingGroupId = groupId;\r\n+    editingGroupName = currentName || `Group ${groupId}`;\r\n+  }\r\n+\r\n+  function cancelEditingGroup() {\r\n+    editingGroupId = null;\r\n+    editingGroupName = '';\r\n+  }\r\n+\r\n+  async function saveGroupName(groupId: string) {\r\n+    try {\r\n+      await updateGroupName(tournamentId, groupId, editingGroupName.trim());\r\n+      await loadState();\r\n+      editingGroupId = null;\r\n+      editingGroupName = '';\r\n+    } catch (error) {\r\n+      console.error('Failed to update group name:', error);\r\n+      alert('Failed to update group name');\r\n+    }\r\n+  }\r\n+\r\n+  async function handleResetGroup(groupId: string) {\r\n+    if (confirm('Reset all match results for this group? This will clear all player stats in this group.')) {\r\n+      try {\r\n+        await resetGroupData(tournamentId, groupId);\r\n+        await loadState();\r\n+      } catch (error) {\r\n+        console.error('Failed to reset group data:', error);\r\n+        alert('Failed to reset group data');\r\n+      }\r\n+    }\r\n+  }\r\n+\r\n+  async function handleResetTournament() {\r\n+    if (confirm('Reset the entire tournament? This will delete ALL tournament data including players, groups, matches, and brackets. This action cannot be undone.')) {\r\n+      try {\r\n+        await resetTournament(tournamentId);\r\n+        window.location.href = '/';\r\n+      } catch (error) {\r\n+        console.error('Failed to reset tournament:', error);\r\n+        alert('Failed to reset tournament');\r\n+      }\r\n+    }\r\n+  }\r\n+\r\n+  function getGroupDisplayName(groupId: string) {\r\n+    const pod = pods.find(p => p.id === groupId);\r\n+    return pod?.name || `Group ${groupId}`;\r\n+  }\r\n+  \r\n+  // Reactive derived values using $derived\r\n+  let currentRoundMatches = $derived(getMatchesForRound(currentRound));\r\n+  let groupsWithPlayers = $derived(getGroupsWithPlayers());\r\n+  let availableRounds = $derived([...new Set(matches.map(m => m.round))].sort((a, b) => a - b));\r\n+  \r\n+  // Debug logging with $effect\r\n+  $effect(() => {\r\n+    console.log('[Groups] Reactive update - currentRound:', currentRound);\r\n+    console.log('[Groups] Reactive update - matches count:', matches.length);\r\n+    console.log('[Groups] Reactive update - currentRoundMatches count:', currentRoundMatches.length);\r\n+    console.log('[Groups] Reactive update - matchSelections:', matchSelections);\r\n+    console.log('[Groups] Reactive update - pods:', pods.length);\r\n+  });\r\n+\r\n+  async function loadState() {\r\n+    console.log('[Groups] loadState() called');\r\n+    const data = await getState(tournamentId);\r\n+    console.log('[Groups] loadState() received data:', {\r\n+      podsCount: data.pods.length,\r\n+      matchesCount: data.matches.length,\r\n+      playersCount: data.players.length,\r\n+      state: data.state\r\n+    });\r\n+\r\n+    // With $state, direct assignment triggers reactivity\r\n+    pods = data.pods;\r\n+    matches = data.matches;\r\n+    players = data.players;\r\n+    tournamentState = data.state;\r\n+\r\n+    // Initialize selections from existing results\r\n+    matches.forEach(m => {\r\n+        if (m.result) {\r\n+            matchSelections[m.id] = {};\r\n+            Object.entries(m.result).forEach(([pid, res]: [string, any]) => {\r\n+                if (res.points === 3) matchSelections[m.id][pid] = 'win';\r\n+                else if (res.points === 1) matchSelections[m.id][pid] = 'tie';\r\n+                else matchSelections[m.id][pid] = 'loss';\r\n+            });\r\n+        }\r\n+    });\r\n+\r\n+    console.log('[Groups] loadState() complete - matchSelections:', matchSelections);\r\n+  }\r\n+\r\n+  function getPlayerName(id: string) {\r\n+    return players.find(p => p.id === id)?.name || 'Unknown';\r\n+  }\r\n+\r\n+  function getPlayer(id: string) {\r\n+    return players.find(p => p.id === id);\r\n+  }\r\n+\r\n+  function getMatchForPod(podId: string) {\r\n+    return matches.find(m => m.podId === podId);\r\n+  }\r\n+  \r\n+  function getMatchesForPod(podId: string) {\r\n+    return matches.filter(m => m.podId === podId);\r\n+  }\r\n+  \r\n+  function getMatchesForRound(round: number) {\r\n+    return matches.filter(m => m.round === round);\r\n+  }\r\n+  \r\n+  function isRoundComplete(round: number) {\r\n+    const roundMatches = getMatchesForRound(round);\r\n+    return roundMatches.length > 0 && roundMatches.every(m => m.completed);\r\n+  }\r\n+  \r\n+  function getMatchStatus(match: any) {\r\n+    if (!match) return 'pending';\r\n+    if (match.completed) return 'complete';\r\n+    if (matchSelections[match.id]) return 'live';\r\n+    return 'pending';\r\n+  }\r\n+\r\n+  function setWinner(matchId: string, winnerId: string, loserId: string) {\r\n+      console.log('[Groups] setWinner called:', { matchId, winnerId, loserId });\r\n+      matchSelections[matchId] = {\r\n+          [winnerId]: 'win',\r\n+          [loserId]: 'loss'\r\n+      };\r\n+      console.log('[Groups] setWinner complete - matchSelections:', matchSelections);\r\n+  }\r\n+\r\n+  function setTie(matchId: string, p1Id: string, p2Id: string) {\r\n+      console.log('[Groups] setTie called:', { matchId, p1Id, p2Id });\r\n+      matchSelections[matchId] = {\r\n+          [p1Id]: 'tie',\r\n+          [p2Id]: 'tie'\r\n+      };\r\n+      console.log('[Groups] setTie complete - matchSelections:', matchSelections);\r\n+  }\r\n+\r\n+  async function submitMatchResult(matchId: string) {\r\n+      console.log('[Groups] submitMatchResult called:', matchId);\r\n+      const selection = matchSelections[matchId];\r\n+      if (!selection) return;\r\n+\r\n+      const results: any = {};\r\n+      Object.entries(selection).forEach(([pid, status]) => {\r\n+          let points = 0;\r\n+          if (status === 'win') points = 3;\r\n+          if (status === 'tie') points = 1;\r\n+          results[pid] = { points };\r\n+      });\r\n+\r\n+      console.log('[Groups] submitMatchResult - submitting results:', results);\r\n+      // FIX: include tournamentId as first arg\r\n+      await submitMatch(tournamentId, matchId, results);\r\n+      console.log('[Groups] submitMatchResult - match submitted, reloading state');\r\n+      await loadState();\r\n+      console.log('[Groups] submitMatchResult complete');\r\n+  }\r\n+\r\n+  async function handleGenerateBrackets() {\r\n+      if (confirm('Finish Group Stage and Generate Brackets?')) {\r\n+          try {\r\n+              console.log('[Groups] Generating brackets...');\r\n+              await generateBrackets(tournamentId);\r\n+              console.log('[Groups] Brackets generated, redirecting...');\r\n+              window.location.href = `/tournament/${tournamentId}/brackets`;\r\n+          } catch (error) {\r\n+              console.error('[Groups] Error generating brackets:', error);\r\n+              alert('Failed to generate brackets. Check console for details.');\r\n+          }\r\n+      }\r\n+  }\r\n+\r\n+  function getStandings() {\r\n+    return [...players].sort((a, b) => {\r\n+      if (b.points !== a.points) return b.points - a.points;\r\n+      // Tiebreaker: goal difference, then wins\r\n+      if (b.wins !== a.wins) return b.wins - a.wins;\r\n+      return 0;\r\n+    });\r\n+  }\r\n+\r\n+  // Group players by their pod/group\r\n+  function getGroupsWithPlayers() {\r\n+    // Get unique pod IDs for round 1 to determine groups\r\n+    const round1Pods = pods.filter(p => p.round === 1);\r\n+    const groups: Record<string, any[]> = {};\r\n+    \r\n+    round1Pods.forEach(pod => {\r\n+      const groupKey = pod.id;\r\n+      if (!groups[groupKey]) groups[groupKey] = [];\r\n+      \r\n+      // Get players directly from pod.players\r\n+      pod.players.forEach((pid: string) => {\r\n+        const player = getPlayer(pid);\r\n+        if (player && !groups[groupKey].find(p => p.id === pid)) {\r\n+          groups[groupKey].push(player);\r\n+        }\r\n+      });\r\n+    });\r\n+    \r\n+    // Sort players within each group by standings\r\n+    Object.keys(groups).forEach(key => {\r\n+      groups[key].sort((a, b) => {\r\n+        if (b.points !== a.points) return b.points - a.points;\r\n+        if (b.wins !== a.wins) return b.wins - a.wins;\r\n+        return 0;\r\n+      });\r\n+    });\r\n+    \r\n+    return groups;\r\n+  }\r\n+\r\n+  onMount(loadState);\r\n </script>\r\n \r\n-<!-- ...inside your markup, replace the edit button section with: -->\r\n-{#if editingGroupId === groupId}\r\n-  <!-- ...existing editing UI... -->\r\n-{:else}\r\n-  <div class=\"flex items-center gap-2 flex-1\">\r\n-    <span class=\"text-xs font-bold text-cyber-blue hover:text-cyber-green transition-colors\">\r\n-      {getGroupDisplayName(groupId)}\r\n-    </span>\r\n-    {#if isAdmin && tournamentState === 'registration'}\r\n+<div class=\"min-h-screen bg-gradient-to-br from-space-900 via-space-800 to-space-900 text-gaming-text px-3 py-3\">\r\n+  <div class=\"max-w-7xl mx-auto\">\r\n+    \r\n+    <!-- Header -->\r\n+    <div class=\"flex justify-between items-center mb-3\">\r\n+      <div>\r\n+        <a href={`/tournament/${tournamentId}`} class=\"text-gray-400 hover:text-cyber-green transition-colors mb-1 inline-block text-xs flex items-center gap-1\">\r\n+          <svg class=\"w-3 h-3\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\"><path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M10 19l-7-7m0 0l7-7m-7 7h18\"/></svg>\r\n+          Back\r\n+        </a>\r\n+        <h1 class=\"text-xl font-black gradient-text flex items-center gap-1.5\">\r\n+          <svg class=\"w-5 h-5 text-cyber-pink\" fill=\"currentColor\" viewBox=\"0 0 20 20\"><path fill-rule=\"evenodd\" d=\"M12.395 2.553a1 1 0 00-1.45-.385c-.345.23-.614.558-.822.88-.214.33-.403.713-.57 1.116-.334.804-.614 1.768-.84 2.734a31.365 31.365 0 00-.613 3.58 2.64 2.64 0 01-.945-1.067c-.328-.68-.398-1.534-.398-2.654A1 1 0 005.05 6.05 6.981 6.981 0 003 11a7 7 0 1011.95-4.95c-.592-.591-.98-.985-1.348-1.467-.363-.476-.724-1.063-1.207-2.03zM12.12 15.12A3 3 0 017 13s.879.5 2.5.5c0-1 .5-4 1.25-4.5.5 1 .786 1.293 1.371 1.879A2.99 2.99 0 0113 13a2.99 2.99 0 01-.879 2.121z\" clip-rule=\"evenodd\"/></svg>\r\n+          GROUP STAGE • R{currentRound}/3\r\n+        </h1>\r\n+      </div>\r\n+      \r\n+      {#if tournamentState === 'group' && matches.every(m => m.completed)}\r\n+        <button \r\n+          onclick={handleGenerateBrackets}\r\n+          class=\"bg-gradient-to-r from-cyber-pink to-purple-600 text-white font-bold text-xs py-1.5 px-4 rounded-lg shadow-glow-pink hover:scale-105 transition-transform flex items-center gap-1.5\"\r\n+        >\r\n+          Playoffs\r\n+          <svg class=\"w-3 h-3\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\"><path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M13 7l5 5m0 0l-5 5m5-5H6\"/></svg>\r\n+        </button>\r\n+      {/if}\r\n+    </div>\r\n+\r\n+    <!-- Round Progress -->\r\n+    <div class=\"glass rounded-lg p-2 mb-3\">\r\n+      <div class=\"flex items-center gap-2\">\r\n+        {#each availableRounds as round}\r\n+          <button \r\n+            onclick={() => currentRound = round}\r\n+            class=\"flex-1 flex items-center justify-center gap-1.5 py-1.5 px-2 rounded {currentRound === round ? 'bg-cyber-green/20 text-cyber-green' : 'text-gray-500 hover:bg-space-700'} transition-all\"\r\n+          >\r\n+            <div class=\"w-6 h-6 rounded-full border {isRoundComplete(round) ? 'bg-cyber-green border-cyber-green text-space-900' : currentRound === round ? 'border-cyber-green' : 'border-gray-600'} flex items-center justify-center font-bold text-xs\">\r\n+              {#if isRoundComplete(round)}\r\n+                <svg class=\"w-3 h-3\" fill=\"currentColor\" viewBox=\"0 0 20 20\"><path fill-rule=\"evenodd\" d=\"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z\" clip-rule=\"evenodd\"/></svg>\r\n+              {:else}\r\n+                {round}\r\n+              {/if}\r\n+            </div>\r\n+            <span class=\"font-bold text-xs\">R{round}</span>\r\n+          </button>\r\n+        {/each}\r\n+      </div>\r\n+    </div>\r\n+\r\n+    <!-- Group Tables Section -->\r\n+    <div class=\"mb-4\">\r\n+      <h2 class=\"text-base font-bold mb-2 text-white flex items-center gap-1.5\">\r\n+        <svg class=\"w-4 h-4 text-cyber-blue\" fill=\"currentColor\" viewBox=\"0 0 20 20\"><path d=\"M2 11a1 1 0 011-1h2a1 1 0 011 1v5a1 1 0 01-1 1H3a1 1 0 01-1-1v-5zM8 7a1 1 0 011-1h2a1 1 0 011 1v9a1 1 0 01-1 1H9a1 1 0 01-1-1V7zM14 4a1 1 0 011-1h2a1 1 0 011 1v12a1 1 0 01-1 1h-2a1 1 0 01-1-1V4z\"/></svg>\r\n+        Group Tables\r\n+      </h2>\r\n+      <div class=\"grid grid-cols-1 md:grid-cols-2 gap-3\">\r\n+        {#each Object.entries(groupsWithPlayers) as [groupId, groupPlayers] (groupId)}\r\n+          <div class=\"glass rounded-lg p-2\">\r\n+        <!-- Group Header with Edit and Reset -->\r\n+        <div class=\"flex items-center justify-between mb-1.5 px-2\">\r\n+          {#if editingGroupId === groupId}\r\n+            <div class=\"flex items-center gap-2 flex-1\">\r\n+          <input\r\n+            type=\"text\"\r\n+            bind:value={editingGroupName}\r\n+            class=\"flex-1 px-2 py-1 text-xs bg-space-700 border border-cyber-blue rounded text-white placeholder-gray-400 focus:outline-none focus:ring-1 focus:ring-cyber-green\"\r\n+            placeholder=\"Group name...\"\r\n+            onkeydown={(e) => {\r\n+              if (e.key === 'Enter') saveGroupName(groupId);\r\n+              if (e.key === 'Escape') cancelEditingGroup();\r\n+            }}\r\n+          />\r\n+          {#if isAdmin}\r\n+            <button\r\n+              onclick={() => saveGroupName(groupId)}\r\n+              class=\"px-2 py-1 text-xs bg-cyber-green text-space-900 rounded font-bold hover:bg-cyber-green/80\"\r\n+            >\r\n+              ✓\r\n+            </button>\r\n+            <button\r\n+              onclick={cancelEditingGroup}\r\n+              class=\"px-2 py-1 text-xs bg-gray-600 text-white rounded font-bold hover:bg-gray-500\"\r\n+            >\r\n+              ✕\r\n+            </button>\r\n+          {/if}\r\n+            </div>\r\n+          {:else}\r\n+            <div class=\"flex items-center gap-2 flex-1\">\r\n+          <span class=\"text-xs font-bold text-cyber-blue hover:text-cyber-green transition-colors\">\r\n+            {getGroupDisplayName(groupId)}\r\n+          </span>\r\n+          {#if isAdmin}\r\n+            {#if tournamentState === 'registration'}\r\n+              <button\r\n+            class=\"ml-2 px-2 py-1 text-xs bg-cyber-green text-black rounded hover:bg-cyber-green/80\"\r\n+            onclick={() => startEditingGroup(groupId, getGroupDisplayName(groupId))}\r\n+              >\r\n+            Edit\r\n+              </button>\r\n+            {/if}\r\n+          {/if}\r\n+            </div>\r\n+          {/if}\r\n+          {#if isAdmin}\r\n+            <button\r\n+          onclick={() => handleResetGroup(groupId)}\r\n+          class=\"px-2 py-1 text-xs bg-red-600 text-white rounded font-bold hover:bg-red-500 transition-colors\"\r\n+          title=\"Reset group data\"\r\n+            >\r\n+          <svg class=\"w-3 h-3\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n+            <path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15\"/>\r\n+          </svg>\r\n+            </button>\r\n+          {/if}\r\n+        </div>\r\n+        <table class=\"w-full text-xs\">\r\n+          <thead>\r\n+            <tr class=\"border-b border-space-600\">\r\n+          <th class=\"text-left py-1 px-1 text-gray-400 font-bold text-xs\">#</th>\r\n+          <th class=\"text-left py-1 px-1 text-gray-400 font-bold text-xs\">Player</th>\r\n+          <th class=\"text-center py-1 px-1 text-gray-400 font-bold text-xs\">P</th>\r\n+          <th class=\"text-center py-1 px-1 text-gray-400 font-bold text-xs\">W</th>\r\n+          <th class=\"text-center py-1 px-1 text-gray-400 font-bold text-xs\">D</th>\r\n+          <th class=\"text-center py-1 px-1 text-gray-400 font-bold text-xs\">L</th>\r\n+          <th class=\"text-center py-1 px-1 text-gray-400 font-bold text-xs\">Pts</th>\r\n+            </tr>\r\n+          </thead>\r\n+          <tbody>\r\n+            {#each groupPlayers as player, index (player.id)}\r\n+          <tr class=\"border-b border-space-700/50 hover:bg-space-700/30 transition-colors\">\r\n+            <td class=\"py-1 px-1\">\r\n+              <div class=\"w-4 h-4 rounded-full flex items-center justify-center font-bold text-xs {index === 0 ? 'bg-gradient-to-br from-yellow-400 to-yellow-600 text-space-900' : index === 1 ? 'bg-gradient-to-br from-gray-300 to-gray-500 text-space-900' : 'bg-space-600 text-gray-400'}\">\r\n+            {index + 1}\r\n+              </div>\r\n+            </td>\r\n+            <td class=\"py-1 px-1 font-bold text-white text-xs flex items-center gap-2\">\r\n+              {#if player.profilePhoto}\r\n+            <img src={player.profilePhoto} alt=\"Profile\" class=\"w-6 h-6 rounded-full object-cover inline-block\" />\r\n+              {/if}\r\n+              {player.name}\r\n+            </td>                    \r\n+            <td class=\"text-center py-1 px-1 text-gray-400\">{(player.wins || 0) + (player.draws || 0) + (player.losses || 0)}</td>\r\n+            <td class=\"text-center py-1 px-1 text-cyber-green font-bold\">{player.wins || 0}</td>\r\n+            <td class=\"text-center py-1 px-1 text-yellow-500 font-bold\">{player.draws || 0}</td>\r\n+            <td class=\"text-center py-1 px-1 text-red-400 font-bold\">{player.losses || 0}</td>\r\n+            <td class=\"text-center py-1 px-1 text-cyber-green font-black\">{player.points || 0}</td>\r\n+          </tr>\r\n+            {/each}\r\n+          </tbody>\r\n+        </table>\r\n+          </div>\r\n+        {/each}\r\n+      </div>\r\n+        </div>\r\n+    <!-- Matches Section -->\r\n+    <div>\r\n+      <h2 class=\"text-base font-bold mb-2 text-white\">Round {currentRound} Matches</h2>\r\n+      <div class=\"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-2\">\r\n+        {#each currentRoundMatches as match (match.id)}\r\n+          {@const player1 = getPlayer(match.player1Id)}\r\n+          {@const player2 = getPlayer(match.player2Id)}\r\n+          {@const status = getMatchStatus(match)}\r\n+            \r\n+            <div class=\"glass rounded-lg p-2 relative\">\r\n+              <!-- Status Badge -->\r\n+              <div class=\"absolute top-1.5 right-1.5 flex items-center gap-0.5 px-1.5 py-0.5 rounded text-xs font-bold {status === 'complete' ? 'bg-cyber-green/20 text-cyber-green' : status === 'live' ? 'bg-yellow-500/20 text-yellow-500' : 'bg-gray-500/20 text-gray-400'}\">\r\n+                {#if status === 'complete'}\r\n+                  <svg class=\"w-2.5 h-2.5\" fill=\"currentColor\" viewBox=\"0 0 20 20\"><path fill-rule=\"evenodd\" d=\"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z\" clip-rule=\"evenodd\"/></svg>\r\n+                  Done\r\n+                {:else if status === 'live'}\r\n+                  <svg class=\"w-2.5 h-2.5\" fill=\"currentColor\" viewBox=\"0 0 20 20\"><path fill-rule=\"evenodd\" d=\"M11.3 1.046A1 1 0 0112 2v5h4a1 1 0 01.82 1.573l-7 10A1 1 0 018 18v-5H4a1 1 0 01-.82-1.573l7-10a1 1 0 011.12-.38z\" clip-rule=\"evenodd\"/></svg>\r\n+                  Live\r\n+                {:else}\r\n+                  Pending\r\n+                {/if}\r\n+              </div>\r\n+\r\n+              <div class=\"space-y-1.5\">\r\n+                <!-- Player 1 -->\r\n+                <div class=\"p-2 rounded bg-space-700/50 {matchSelections[match.id]?.[match.player1Id] === 'win' ? 'ring-1 ring-cyber-green' : matchSelections[match.id]?.[match.player1Id] === 'loss' ? 'opacity-60' : ''} transition-all\">\r\n+                  <div class=\"flex items-center justify-between mb-1.5\">\r\n+                    <div class=\"flex items-center gap-2\">\r\n+                      {#if player1?.profilePhoto}\r\n+                        <img src={player1.profilePhoto} alt=\"Profile\" class=\"w-6 h-6 rounded-full object-cover\" />\r\n+                      {:else}\r\n+                        <div class=\"w-6 h-6 rounded-full bg-gradient-to-br from-cyan-500 to-blue-500 flex items-center justify-center\">\r\n+                          <svg class=\"w-3.5 h-3.5 text-white\" fill=\"currentColor\" viewBox=\"0 0 20 20\"><path fill-rule=\"evenodd\" d=\"M10 9a3 3 0 100-6 3 3 0 000 6zm-7 9a7 7 0 1114 0H3z\" clip-rule=\"evenodd\"/></svg>\r\n+                        </div>\r\n+                      {/if}\r\n+                      <div>\r\n+                        <div class=\"font-bold text-xs text-white\">{player1?.name || 'Unknown'}</div>\r\n+                        <div class=\"text-xs text-gray-400\">{player1?.points || 0}pts</div>\r\n+                      </div>\r\n+                    </div>\r\n+                    {#if matchSelections[match.id]?.[match.player1Id] === 'win'}\r\n+                      <svg class=\"w-4 h-4 text-cyber-green\" fill=\"currentColor\" viewBox=\"0 0 20 20\"><path d=\"M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z\"/></svg>\r\n+                    {/if}\r\n+                  </div>\r\n+                  \r\n+                  {#if !match.completed}\r\n+                    <button \r\n+                      onclick={() => setWinner(match.id, match.player1Id, match.player2Id)}\r\n+                      class=\"w-full py-1 px-2 text-xs rounded font-bold transition-all {matchSelections[match.id]?.[match.player1Id] === 'win' ? 'bg-gradient-to-r from-cyber-green to-emerald-500 text-space-900' : 'bg-space-600 hover:bg-cyber-green/20 text-gray-300 hover:text-cyber-green'}\"\r\n+                    >\r\n+                      {matchSelections[match.id]?.[match.player1Id] === 'win' ? '✓ Winner' : 'Winner'}\r\n+                    </button>\r\n+                  {/if}\r\n+                </div>\r\n+\r\n+                <!-- Tie Button -->\r\n+                {#if !match.completed}\r\n+                  <button \r\n+                    onclick={() => setTie(match.id, match.player1Id, match.player2Id)}\r\n+                    class=\"w-full py-0.5 text-xs rounded font-bold transition-all {matchSelections[match.id]?.[match.player1Id] === 'tie' ? 'bg-gradient-to-r from-yellow-400 to-yellow-600 text-space-900' : 'bg-space-700 hover:bg-yellow-500/20 text-gray-300 hover:text-yellow-500'}\"\r\n+                  >\r\n+                    {matchSelections[match.id]?.[match.player1Id] === 'tie' ? '✓ Tie' : 'Tie'}\r\n+                  </button>\r\n+                {/if}\r\n+\r\n+                <!-- Player 2 -->\r\n+                <div class=\"p-2 rounded bg-space-700/50 {matchSelections[match.id]?.[match.player2Id] === 'win' ? 'ring-1 ring-cyber-green' : matchSelections[match.id]?.[match.player2Id] === 'loss' ? 'opacity-60' : ''} transition-all\">\r\n+                  <div class=\"flex items-center justify-between mb-1.5\">\r\n+                    <div class=\"flex items-center gap-2\">\r\n+                      {#if player2?.profilePhoto}\r\n+                        <img src={player2.profilePhoto} alt=\"Profile\" class=\"w-6 h-6 rounded-full object-cover\" />\r\n+                      {:else}\r\n+                        <div class=\"w-6 h-6 rounded-full bg-gradient-to-br from-purple-500 to-pink-500 flex items-center justify-center\">\r\n+                          <svg class=\"w-3.5 h-3.5 text-white\" fill=\"currentColor\" viewBox=\"0 0 20 20\"><path fill-rule=\"evenodd\" d=\"M10 9a3 3 0 100-6 3 3 0 000 6zm-7 9a7 7 0 1114 0H3z\" clip-rule=\"evenodd\"/></svg>\r\n+                        </div>\r\n+                      {/if}\r\n+                      <div>\r\n+                        <div class=\"font-bold text-xs text-white\">{player2?.name || 'Unknown'}</div>\r\n+                        <div class=\"text-xs text-gray-400\">{player2?.points || 0}pts</div>\r\n+                      </div>\r\n+                    </div>\r\n+                    {#if matchSelections[match.id]?.[match.player2Id] === 'win'}\r\n+                      <svg class=\"w-4 h-4 text-cyber-green\" fill=\"currentColor\" viewBox=\"0 0 20 20\"><path d=\"M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z\"/></svg>\r\n+                    {/if}\r\n+                  </div>\r\n+                  \r\n+                  {#if !match.completed}\r\n+                    <button \r\n+                      onclick={() => setWinner(match.id, match.player2Id, match.player1Id)}\r\n+                      class=\"w-full py-1 px-2 text-xs rounded font-bold transition-all {matchSelections[match.id]?.[match.player2Id] === 'win' ? 'bg-gradient-to-r from-cyber-green to-emerald-500 text-space-900' : 'bg-space-600 hover:bg-cyber-green/20 text-gray-300 hover:text-cyber-green'}\"\r\n+                    >\r\n+                      {matchSelections[match.id]?.[match.player2Id] === 'win' ? '✓ Winner' : 'Winner'}\r\n+                    </button>\r\n+                  {/if}\r\n+                </div>\r\n+              </div>\r\n+\r\n+              <!-- Submit Button -->\r\n+              {#if !match.completed && (matchSelections[match.id]?.[match.player1Id] || matchSelections[match.id]?.[match.player2Id])}\r\n+                <div class=\"mt-1.5\">\r\n+                  <button \r\n+                    onclick={() => submitMatchResult(match.id)}\r\n+                    class=\"w-full bg-gradient-to-r from-cyber-blue to-blue-600 text-white font-bold py-1.5 px-3 rounded text-xs hover:scale-102 transition-all\"\r\n+                  >\r\n+                    Submit Result\r\n+                  </button>\r\n+                </div>\r\n+              {/if}\r\n+            </div>\r\n+        {/each}\r\n+    </div>\r\n+\r\n+    <!-- Full Tournament Reset Button -->\r\n+    <div class=\"text-center pt-8 border-t border-space-600 mt-8\">\r\n       <button\r\n-        class=\"ml-2 px-2 py-1 text-xs bg-cyber-green text-black rounded hover:bg-cyber-green/80\"\r\n-        onclick={() => startEditingGroup(groupId, getGroupDisplayName(groupId))}\r\n+        onclick={() => handleResetTournament()}\r\n+        class=\"text-red-400/70 hover:text-red-400 text-base font-semibold transition-colors hover:underline\"\r\n       >\r\n-        Edit\r\n+        <svg class=\"w-4 h-4 inline-block mr-1\" fill=\"currentColor\" viewBox=\"0 0 20 20\"><path fill-rule=\"evenodd\" d=\"M9 2a1 1 0 00-.894.553L7.382 4H4a1 1 0 000 2v10a2 2 0 002 2h8a2 2 0 002-2V6a1 1 0 100-2h-3.382l-.724-1.447A1 1 0 0011 2H9zM7 8a1 1 0 012 0v6a1 1 0 11-2 0V8zm5-1a1 1 0 00-1 1v6a1 1 0 102 0V8a1 1 0 00-1-1z\" clip-rule=\"evenodd\"/></svg>\r\n+        Reset Entire Tournament\r\n       </button>\r\n-    {/if}\r\n+    </div>\r\n   </div>\r\n-{/if}\r\n+</div>\r\n+</div>\r\n"
                },
                {
                    "date": 1764770226544,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1,74 +1,16 @@\n <script lang=\"ts\">\r\n   import { onMount } from 'svelte';\r\n-  import { getState, submitMatch, generateBrackets, updateGroupName, resetGroupData, resetTournament } from '$lib/api';\r\n+  import { getState, submitMatch, generateBrackets } from '$lib/api';\r\n \r\n-  let { tournamentId } = $props<{ tournamentId: string }>();\r\n-\r\n   let pods = $state([]) as any[];\r\n   let matches = $state([]) as any[];\r\n   let players = $state([]) as any[];\r\n   let tournamentState = $state('');\r\n   let currentRound = $state(1);\r\n \r\n   // Local state to track UI selections before submission\r\n   let matchSelections = $state({}) as Record<string, { [pid: string]: 'win' | 'loss' | 'tie' }>;\r\n-\r\n-  // Group editing state\r\n-  let editingGroupId = $state(null) as string | null;\r\n-  let editingGroupName = $state('');\r\n-\r\n-  // Group name editing functions\r\n-  function startEditingGroup(groupId: string, currentName: string) {\r\n-    editingGroupId = groupId;\r\n-    editingGroupName = currentName || `Group ${groupId}`;\r\n-  }\r\n-\r\n-  function cancelEditingGroup() {\r\n-    editingGroupId = null;\r\n-    editingGroupName = '';\r\n-  }\r\n-\r\n-  async function saveGroupName(groupId: string) {\r\n-    try {\r\n-      await updateGroupName(tournamentId, groupId, editingGroupName.trim());\r\n-      await loadState();\r\n-      editingGroupId = null;\r\n-      editingGroupName = '';\r\n-    } catch (error) {\r\n-      console.error('Failed to update group name:', error);\r\n-      alert('Failed to update group name');\r\n-    }\r\n-  }\r\n-\r\n-  async function handleResetGroup(groupId: string) {\r\n-    if (confirm('Reset all match results for this group? This will clear all player stats in this group.')) {\r\n-      try {\r\n-        await resetGroupData(tournamentId, groupId);\r\n-        await loadState();\r\n-      } catch (error) {\r\n-        console.error('Failed to reset group data:', error);\r\n-        alert('Failed to reset group data');\r\n-      }\r\n-    }\r\n-  }\r\n-\r\n-  async function handleResetTournament() {\r\n-    if (confirm('Reset the entire tournament? This will delete ALL tournament data including players, groups, matches, and brackets. This action cannot be undone.')) {\r\n-      try {\r\n-        await resetTournament(tournamentId);\r\n-        window.location.href = '/';\r\n-      } catch (error) {\r\n-        console.error('Failed to reset tournament:', error);\r\n-        alert('Failed to reset tournament');\r\n-      }\r\n-    }\r\n-  }\r\n-\r\n-  function getGroupDisplayName(groupId: string) {\r\n-    const pod = pods.find(p => p.id === groupId);\r\n-    return pod?.name || `Group ${groupId}`;\r\n-  }\r\n   \r\n   // Reactive derived values using $derived\r\n   let currentRoundMatches = $derived(getMatchesForRound(currentRound));\r\n   let groupsWithPlayers = $derived(getGroupsWithPlayers());\r\n@@ -78,12 +20,33 @@\n   $effect(() => {\r\n     console.log('[Groups] Reactive update - currentRound:', currentRound);\r\n     console.log('[Groups] Reactive update - matches count:', matches.length);\r\n     console.log('[Groups] Reactive update - currentRoundMatches count:', currentRoundMatches.length);\r\n-    console.log('[Groups] Reactive update - matchSelections:', matchSelections);\r\n+    console.log('[Groups] Reactive update - matchScores:', matchScores);\r\n     console.log('[Groups] Reactive update - pods:', pods.length);\r\n   });\r\n \r\n+  // Track if we've done initial auto-advance\r\n+  let hasAutoAdvanced = $state(false);\r\n+\r\n+  // Auto-advance to the first incomplete round on initial load only\r\n+  $effect(() => {\r\n+    if (!hasAutoAdvanced && matches.length > 0) {\r\n+      // Find the first incomplete round\r\n+      const maxRound = Math.max(...availableRounds);\r\n+      for (let round = 1; round <= maxRound; round++) {\r\n+        if (!isRoundComplete(round)) {\r\n+          if (round !== currentRound) {\r\n+            console.log(`[Groups] Initial load: advancing to first incomplete round ${round}`);\r\n+            currentRound = round;\r\n+          }\r\n+          break;\r\n+        }\r\n+      }\r\n+      hasAutoAdvanced = true;\r\n+    }\r\n+  });\r\n+\r\n   async function loadState() {\r\n     console.log('[Groups] loadState() called');\r\n     const data = await getState(tournamentId);\r\n     console.log('[Groups] loadState() received data:', {\r\n@@ -97,21 +60,22 @@\n     pods = data.pods;\r\n     matches = data.matches;\r\n     players = data.players;\r\n     tournamentState = data.state;\r\n-\r\n+    \r\n     // Initialize selections from existing results\r\n     matches.forEach(m => {\r\n         if (m.result) {\r\n-            matchSelections[m.id] = {};\r\n-            Object.entries(m.result).forEach(([pid, res]: [string, any]) => {\r\n-                if (res.points === 3) matchSelections[m.id][pid] = 'win';\r\n-                else if (res.points === 1) matchSelections[m.id][pid] = 'tie';\r\n-                else matchSelections[m.id][pid] = 'loss';\r\n-            });\r\n+            // Try to get stored scores, or calculate from points\r\n+            const p1Result = m.result[m.player1Id];\r\n+            const p2Result = m.result[m.player2Id];\r\n+            matchScores[m.id] = {\r\n+                player1Score: p1Result?.score ?? (p1Result?.points === 3 ? 16 : p1Result?.points === 1 ? 15 : 0),\r\n+                player2Score: p2Result?.score ?? (p2Result?.points === 3 ? 16 : p2Result?.points === 1 ? 15 : 0)\r\n+            };\r\n         }\r\n     });\r\n-\r\n+    \r\n     console.log('[Groups] loadState() complete - matchSelections:', matchSelections);\r\n   }\r\n \r\n   function getPlayerName(id: string) {\r\n@@ -141,46 +105,126 @@\n   \r\n   function getMatchStatus(match: any) {\r\n     if (!match) return 'pending';\r\n     if (match.completed) return 'complete';\r\n-    if (matchSelections[match.id]) return 'live';\r\n+    if (matchScores[match.id] && (matchScores[match.id].player1Score > 0 || matchScores[match.id].player2Score > 0)) return 'live';\r\n     return 'pending';\r\n   }\r\n \r\n-  function setWinner(matchId: string, winnerId: string, loserId: string) {\r\n-      console.log('[Groups] setWinner called:', { matchId, winnerId, loserId });\r\n-      matchSelections[matchId] = {\r\n-          [winnerId]: 'win',\r\n-          [loserId]: 'loss'\r\n-      };\r\n-      console.log('[Groups] setWinner complete - matchSelections:', matchSelections);\r\n+  function updateScore(matchId: string, player: 'player1' | 'player2', value: number) {\r\n+    if (!matchScores[matchId]) {\r\n+      matchScores[matchId] = { player1Score: 0, player2Score: 0 };\r\n+    }\r\n+    // Clamp value between 0 and maxScore (if maxScore is defined)\r\n+    const clampedValue = maxScore !== undefined ? Math.max(0, Math.min(value, maxScore)) : Math.max(0, value);\r\n+    if (player === 'player1') {\r\n+      matchScores[matchId].player1Score = clampedValue;\r\n+    } else {\r\n+      matchScores[matchId].player2Score = clampedValue;\r\n+    }\r\n   }\r\n \r\n-  function setTie(matchId: string, p1Id: string, p2Id: string) {\r\n-      console.log('[Groups] setTie called:', { matchId, p1Id, p2Id });\r\n-      matchSelections[matchId] = {\r\n-          [p1Id]: 'tie',\r\n-          [p2Id]: 'tie'\r\n-      };\r\n-      console.log('[Groups] setTie complete - matchSelections:', matchSelections);\r\n+  function getMatchResult(matchId: string) {\r\n+    const scores = matchScores[matchId];\r\n+    if (!scores) return null;\r\n+    const { player1Score, player2Score } = scores;\r\n+    if (player1Score > player2Score) return 'player1';\r\n+    if (player2Score > player1Score) return 'player2';\r\n+    // For health-based games (Worms), 0-0 is a valid tie (mutual kill)\r\n+    if (player1Score === player2Score && (player1Score > 0 || (tieAllowed && gameConfig?.groupStage.scoreType === 'health'))) return 'tie';\r\n+    return null;\r\n   }\r\n \r\n-  async function submitMatchResult(matchId: string) {\r\n+  function isValidScore(matchId: string) {\r\n+    const scores = matchScores[matchId];\r\n+    if (!scores) return false;\r\n+    const { player1Score, player2Score } = scores;\r\n+    // For health-based games (Worms), 0-0 is valid (mutual kill/tie)\r\n+    const isHealthBased = gameConfig?.groupStage.scoreType === 'health';\r\n+    // Need at least one score, unless it's a health-based game where 0-0 tie is valid\r\n+    if (player1Score === 0 && player2Score === 0 && !isHealthBased) return false;\r\n+    // For games that don't allow ties, scores must be different\r\n+    if (!tieAllowed && player1Score === player2Score) return false;\r\n+    \r\n+    // CS16 specific: MR15 format (first to 15 rounds wins)\r\n+    // Valid results: 15-X where X is 0-14, or 15-15 (tie)\r\n+    if (gameType === 'cs16') {\r\n+      const winScore = 15;\r\n+      const maxLoserScore = 14; // In regulation, loser can have max 14\r\n+      \r\n+      if (player1Score > player2Score) {\r\n+        // Player 1 wins - must have exactly 15, loser max 14\r\n+        if (player1Score !== winScore || player2Score > maxLoserScore) return false;\r\n+      } else if (player2Score > player1Score) {\r\n+        // Player 2 wins - must have exactly 15, loser max 14\r\n+        if (player2Score !== winScore || player1Score > maxLoserScore) return false;\r\n+      } else {\r\n+        // Tie - only valid at 15-15\r\n+        if (player1Score !== 15) return false;\r\n+      }\r\n+    }\r\n+    return true;\r\n+  }\r\n+\r\n+  function getValidationError(matchId: string): string | null {\r\n+    const scores = matchScores[matchId];\r\n+    if (!scores) return null;\r\n+    const { player1Score, player2Score } = scores;\r\n+    \r\n+    if (player1Score === 0 && player2Score === 0) return null;\r\n+    \r\n+    if (!tieAllowed && player1Score === player2Score) {\r\n+      return 'Ties not allowed - scores must be different';\r\n+    }\r\n+    \r\n+    if (gameType === 'cs16') {\r\n+      const winScore = 15;\r\n+      const maxLoserScore = 14;\r\n+      \r\n+      if (player1Score > player2Score) {\r\n+        if (player1Score !== winScore) {\r\n+          return `Winner must have exactly ${winScore} rounds`;\r\n+        }\r\n+        if (player2Score > maxLoserScore) {\r\n+          return `Loser cannot have more than ${maxLoserScore} rounds`;\r\n+        }\r\n+      } else if (player2Score > player1Score) {\r\n+        if (player2Score !== winScore) {\r\n+          return `Winner must have exactly ${winScore} rounds`;\r\n+        }\r\n+        if (player1Score > maxLoserScore) {\r\n+          return `Loser cannot have more than ${maxLoserScore} rounds`;\r\n+        }\r\n+      } else if (player1Score !== 15) {\r\n+        return 'Ties only valid at 15-15';\r\n+      }\r\n+    }\r\n+    \r\n+    return null;\r\n+  }\r\n+\r\n+  async function submitMatchResult(matchId: string, match: any) {\r\n       console.log('[Groups] submitMatchResult called:', matchId);\r\n-      const selection = matchSelections[matchId];\r\n-      if (!selection) return;\r\n+      const scores = matchScores[matchId];\r\n+      if (!scores || !isValidScore(matchId)) return;\r\n \r\n+      const { player1Score, player2Score } = scores;\r\n+      const result = getMatchResult(matchId);\r\n+      \r\n       const results: any = {};\r\n-      Object.entries(selection).forEach(([pid, status]) => {\r\n-          let points = 0;\r\n-          if (status === 'win') points = 3;\r\n-          if (status === 'tie') points = 1;\r\n-          results[pid] = { points };\r\n-      });\r\n+      if (result === 'player1') {\r\n+        results[match.player1Id] = { points: 3, score: player1Score };\r\n+        results[match.player2Id] = { points: 0, score: player2Score };\r\n+      } else if (result === 'player2') {\r\n+        results[match.player1Id] = { points: 0, score: player1Score };\r\n+        results[match.player2Id] = { points: 3, score: player2Score };\r\n+      } else if (result === 'tie') {\r\n+        results[match.player1Id] = { points: 1, score: player1Score };\r\n+        results[match.player2Id] = { points: 1, score: player2Score };\r\n+      }\r\n \r\n       console.log('[Groups] submitMatchResult - submitting results:', results);\r\n-      // FIX: include tournamentId as first arg\r\n-      await submitMatch(tournamentId, matchId, results);\r\n+      await submitMatch(matchId, results);\r\n       console.log('[Groups] submitMatchResult - match submitted, reloading state');\r\n       await loadState();\r\n       console.log('[Groups] submitMatchResult complete');\r\n   }\r\n@@ -188,22 +232,26 @@\n   async function handleGenerateBrackets() {\r\n       if (confirm('Finish Group Stage and Generate Brackets?')) {\r\n           try {\r\n               console.log('[Groups] Generating brackets...');\r\n-              await generateBrackets(tournamentId);\r\n+              await generateBrackets();\r\n               console.log('[Groups] Brackets generated, redirecting...');\r\n-              window.location.href = `/tournament/${tournamentId}/brackets`;\r\n+              window.location.href = '/brackets';\r\n           } catch (error) {\r\n               console.error('[Groups] Error generating brackets:', error);\r\n               alert('Failed to generate brackets. Check console for details.');\r\n           }\r\n       }\r\n+    };\r\n+    showConfirmPopup = true;\r\n   }\r\n \r\n   function getStandings() {\r\n     return [...players].sort((a, b) => {\r\n       if (b.points !== a.points) return b.points - a.points;\r\n-      // Tiebreaker: goal difference, then wins\r\n+      // Tiebreaker: total game score (rounds for CS, kills for UT, etc.)\r\n+      if ((b.totalGameScore || 0) !== (a.totalGameScore || 0)) return (b.totalGameScore || 0) - (a.totalGameScore || 0);\r\n+      // Then wins\r\n       if (b.wins !== a.wins) return b.wins - a.wins;\r\n       return 0;\r\n     });\r\n   }\r\n@@ -230,8 +278,10 @@\n     // Sort players within each group by standings\r\n     Object.keys(groups).forEach(key => {\r\n       groups[key].sort((a, b) => {\r\n         if (b.points !== a.points) return b.points - a.points;\r\n+        // Tiebreaker: total game score (rounds for CS, kills for UT, etc.)\r\n+        if ((b.totalGameScore || 0) !== (a.totalGameScore || 0)) return (b.totalGameScore || 0) - (a.totalGameScore || 0);\r\n         if (b.wins !== a.wins) return b.wins - a.wins;\r\n         return 0;\r\n       });\r\n     });\r\n@@ -260,9 +310,9 @@\n       \r\n       {#if tournamentState === 'group' && matches.every(m => m.completed)}\r\n         <button \r\n           onclick={handleGenerateBrackets}\r\n-          class=\"bg-gradient-to-r from-cyber-pink to-purple-600 text-white font-bold text-xs py-1.5 px-4 rounded-lg shadow-glow-pink hover:scale-105 transition-transform flex items-center gap-1.5\"\r\n+          class=\"bg-gradient-to-r from-brand-orange to-brand-purple text-white font-bold text-xs py-1.5 px-4 rounded-lg shadow-glow-orange hover:scale-105 transition-transform flex items-center gap-1.5\"\r\n         >\r\n           Playoffs\r\n           <svg class=\"w-3 h-3\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\"><path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M13 7l5 5m0 0l-5 5m5-5H6\"/></svg>\r\n         </button>\r\n@@ -274,11 +324,11 @@\n       <div class=\"flex items-center gap-2\">\r\n         {#each availableRounds as round}\r\n           <button \r\n             onclick={() => currentRound = round}\r\n-            class=\"flex-1 flex items-center justify-center gap-1.5 py-1.5 px-2 rounded {currentRound === round ? 'bg-cyber-green/20 text-cyber-green' : 'text-gray-500 hover:bg-space-700'} transition-all\"\r\n+            class=\"flex-1 flex items-center justify-center gap-1.5 py-1.5 px-2 rounded {currentRound === round ? 'bg-brand-cyan/20 text-brand-cyan' : 'text-gray-500 hover:bg-space-700'} transition-all\"\r\n           >\r\n-            <div class=\"w-6 h-6 rounded-full border {isRoundComplete(round) ? 'bg-cyber-green border-cyber-green text-space-900' : currentRound === round ? 'border-cyber-green' : 'border-gray-600'} flex items-center justify-center font-bold text-xs\">\r\n+            <div class=\"w-6 h-6 rounded-full border {isRoundComplete(round) ? 'bg-brand-cyan border-brand-cyan text-space-900' : currentRound === round ? 'border-brand-cyan' : 'border-gray-600'} flex items-center justify-center font-bold text-xs\">\r\n               {#if isRoundComplete(round)}\r\n                 <svg class=\"w-3 h-3\" fill=\"currentColor\" viewBox=\"0 0 20 20\"><path fill-rule=\"evenodd\" d=\"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z\" clip-rule=\"evenodd\"/></svg>\r\n               {:else}\r\n                 {round}\r\n@@ -298,140 +348,76 @@\n       </h2>\r\n       <div class=\"grid grid-cols-1 md:grid-cols-2 gap-3\">\r\n         {#each Object.entries(groupsWithPlayers) as [groupId, groupPlayers] (groupId)}\r\n           <div class=\"glass rounded-lg p-2\">\r\n-        <!-- Group Header with Edit and Reset -->\r\n-        <div class=\"flex items-center justify-between mb-1.5 px-2\">\r\n-          {#if editingGroupId === groupId}\r\n-            <div class=\"flex items-center gap-2 flex-1\">\r\n-          <input\r\n-            type=\"text\"\r\n-            bind:value={editingGroupName}\r\n-            class=\"flex-1 px-2 py-1 text-xs bg-space-700 border border-cyber-blue rounded text-white placeholder-gray-400 focus:outline-none focus:ring-1 focus:ring-cyber-green\"\r\n-            placeholder=\"Group name...\"\r\n-            onkeydown={(e) => {\r\n-              if (e.key === 'Enter') saveGroupName(groupId);\r\n-              if (e.key === 'Escape') cancelEditingGroup();\r\n-            }}\r\n-          />\r\n-          {#if isAdmin}\r\n-            <button\r\n-              onclick={() => saveGroupName(groupId)}\r\n-              class=\"px-2 py-1 text-xs bg-cyber-green text-space-900 rounded font-bold hover:bg-cyber-green/80\"\r\n-            >\r\n-              ✓\r\n-            </button>\r\n-            <button\r\n-              onclick={cancelEditingGroup}\r\n-              class=\"px-2 py-1 text-xs bg-gray-600 text-white rounded font-bold hover:bg-gray-500\"\r\n-            >\r\n-              ✕\r\n-            </button>\r\n-          {/if}\r\n-            </div>\r\n-          {:else}\r\n-            <div class=\"flex items-center gap-2 flex-1\">\r\n-          <span class=\"text-xs font-bold text-cyber-blue hover:text-cyber-green transition-colors\">\r\n-            {getGroupDisplayName(groupId)}\r\n-          </span>\r\n-          {#if isAdmin}\r\n-            {#if tournamentState === 'registration'}\r\n-              <button\r\n-            class=\"ml-2 px-2 py-1 text-xs bg-cyber-green text-black rounded hover:bg-cyber-green/80\"\r\n-            onclick={() => startEditingGroup(groupId, getGroupDisplayName(groupId))}\r\n-              >\r\n-            Edit\r\n-              </button>\r\n-            {/if}\r\n-          {/if}\r\n-            </div>\r\n-          {/if}\r\n-          {#if isAdmin}\r\n-            <button\r\n-          onclick={() => handleResetGroup(groupId)}\r\n-          class=\"px-2 py-1 text-xs bg-red-600 text-white rounded font-bold hover:bg-red-500 transition-colors\"\r\n-          title=\"Reset group data\"\r\n-            >\r\n-          <svg class=\"w-3 h-3\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n-            <path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15\"/>\r\n-          </svg>\r\n-            </button>\r\n-          {/if}\r\n-        </div>\r\n-        <table class=\"w-full text-xs\">\r\n-          <thead>\r\n-            <tr class=\"border-b border-space-600\">\r\n-          <th class=\"text-left py-1 px-1 text-gray-400 font-bold text-xs\">#</th>\r\n-          <th class=\"text-left py-1 px-1 text-gray-400 font-bold text-xs\">Player</th>\r\n-          <th class=\"text-center py-1 px-1 text-gray-400 font-bold text-xs\">P</th>\r\n-          <th class=\"text-center py-1 px-1 text-gray-400 font-bold text-xs\">W</th>\r\n-          <th class=\"text-center py-1 px-1 text-gray-400 font-bold text-xs\">D</th>\r\n-          <th class=\"text-center py-1 px-1 text-gray-400 font-bold text-xs\">L</th>\r\n-          <th class=\"text-center py-1 px-1 text-gray-400 font-bold text-xs\">Pts</th>\r\n-            </tr>\r\n-          </thead>\r\n-          <tbody>\r\n-            {#each groupPlayers as player, index (player.id)}\r\n-          <tr class=\"border-b border-space-700/50 hover:bg-space-700/30 transition-colors\">\r\n-            <td class=\"py-1 px-1\">\r\n-              <div class=\"w-4 h-4 rounded-full flex items-center justify-center font-bold text-xs {index === 0 ? 'bg-gradient-to-br from-yellow-400 to-yellow-600 text-space-900' : index === 1 ? 'bg-gradient-to-br from-gray-300 to-gray-500 text-space-900' : 'bg-space-600 text-gray-400'}\">\r\n-            {index + 1}\r\n-              </div>\r\n-            </td>\r\n-            <td class=\"py-1 px-1 font-bold text-white text-xs flex items-center gap-2\">\r\n-              {#if player.profilePhoto}\r\n-            <img src={player.profilePhoto} alt=\"Profile\" class=\"w-6 h-6 rounded-full object-cover inline-block\" />\r\n-              {/if}\r\n-              {player.name}\r\n-            </td>                    \r\n-            <td class=\"text-center py-1 px-1 text-gray-400\">{(player.wins || 0) + (player.draws || 0) + (player.losses || 0)}</td>\r\n-            <td class=\"text-center py-1 px-1 text-cyber-green font-bold\">{player.wins || 0}</td>\r\n-            <td class=\"text-center py-1 px-1 text-yellow-500 font-bold\">{player.draws || 0}</td>\r\n-            <td class=\"text-center py-1 px-1 text-red-400 font-bold\">{player.losses || 0}</td>\r\n-            <td class=\"text-center py-1 px-1 text-cyber-green font-black\">{player.points || 0}</td>\r\n-          </tr>\r\n-            {/each}\r\n-          </tbody>\r\n-        </table>\r\n+            <h3 class=\"text-xs font-bold text-cyber-blue mb-1.5 px-2\">Group {groupId}</h3>\r\n+            <table class=\"w-full text-xs\">\r\n+              <thead>\r\n+                <tr class=\"border-b border-space-600\">\r\n+                  <th class=\"text-left py-1 px-1 text-gray-400 font-bold text-xs\">#</th>\r\n+                  <th class=\"text-left py-1 px-1 text-gray-400 font-bold text-xs\">Player</th>\r\n+                  <th class=\"text-center py-1 px-1 text-gray-400 font-bold text-xs\">P</th>\r\n+                  <th class=\"text-center py-1 px-1 text-gray-400 font-bold text-xs\">W</th>\r\n+                  <th class=\"text-center py-1 px-1 text-gray-400 font-bold text-xs\">D</th>\r\n+                  <th class=\"text-center py-1 px-1 text-gray-400 font-bold text-xs\">L</th>\r\n+                  <th class=\"text-center py-1 px-1 text-gray-400 font-bold text-xs\">Pts</th>\r\n+                </tr>\r\n+              </thead>\r\n+              <tbody>\r\n+                {#each groupPlayers as player, index (player.id)}\r\n+                  <tr class=\"border-b border-space-700/50 hover:bg-space-700/30 transition-colors\">\r\n+                    <td class=\"py-1 px-1\">\r\n+                      <div class=\"w-4 h-4 rounded-full flex items-center justify-center font-bold text-xs {index === 0 ? 'bg-gradient-to-br from-yellow-400 to-yellow-600 text-space-900' : index === 1 ? 'bg-gradient-to-br from-gray-300 to-gray-500 text-space-900' : 'bg-space-600 text-gray-400'}\">\r\n+                        {index + 1}\r\n+                      </div>\r\n+                    </td>\r\n+                    <td class=\"py-1 px-1 font-bold text-white text-xs\">{player.name}</td>\r\n+                    <td class=\"text-center py-1 px-1 text-gray-400\">{(player.wins || 0) + (player.draws || 0) + (player.losses || 0)}</td>\r\n+                    <td class=\"text-center py-1 px-1 text-cyber-green font-bold\">{player.wins || 0}</td>\r\n+                    <td class=\"text-center py-1 px-1 text-yellow-500 font-bold\">{player.draws || 0}</td>\r\n+                    <td class=\"text-center py-1 px-1 text-red-400 font-bold\">{player.losses || 0}</td>\r\n+                    <td class=\"text-center py-1 px-1 text-cyber-green font-black\">{player.points || 0}</td>\r\n+                  </tr>\r\n+                {/each}\r\n+              </tbody>\r\n+            </table>\r\n           </div>\r\n         {/each}\r\n       </div>\r\n         </div>\r\n     <!-- Matches Section -->\r\n     <div>\r\n       <h2 class=\"text-base font-bold mb-2 text-white\">Round {currentRound} Matches</h2>\r\n-      <div class=\"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-2\">\r\n+      <div class=\"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-3\">\r\n         {#each currentRoundMatches as match (match.id)}\r\n           {@const player1 = getPlayer(match.player1Id)}\r\n           {@const player2 = getPlayer(match.player2Id)}\r\n           {@const status = getMatchStatus(match)}\r\n+          {@const result = getMatchResult(match.id)}\r\n+          {@const scores = matchScores[match.id] || { player1Score: 0, player2Score: 0 }}\r\n             \r\n-            <div class=\"glass rounded-lg p-2 relative\">\r\n-              <!-- Status Badge -->\r\n-              <div class=\"absolute top-1.5 right-1.5 flex items-center gap-0.5 px-1.5 py-0.5 rounded text-xs font-bold {status === 'complete' ? 'bg-cyber-green/20 text-cyber-green' : status === 'live' ? 'bg-yellow-500/20 text-yellow-500' : 'bg-gray-500/20 text-gray-400'}\">\r\n-                {#if status === 'complete'}\r\n-                  <svg class=\"w-2.5 h-2.5\" fill=\"currentColor\" viewBox=\"0 0 20 20\"><path fill-rule=\"evenodd\" d=\"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z\" clip-rule=\"evenodd\"/></svg>\r\n-                  Done\r\n-                {:else if status === 'live'}\r\n-                  <svg class=\"w-2.5 h-2.5\" fill=\"currentColor\" viewBox=\"0 0 20 20\"><path fill-rule=\"evenodd\" d=\"M11.3 1.046A1 1 0 0112 2v5h4a1 1 0 01.82 1.573l-7 10A1 1 0 018 18v-5H4a1 1 0 01-.82-1.573l7-10a1 1 0 011.12-.38z\" clip-rule=\"evenodd\"/></svg>\r\n-                  Live\r\n-                {:else}\r\n-                  Pending\r\n-                {/if}\r\n+            <div class=\"glass rounded-lg overflow-hidden\">\r\n+              <!-- Header with status -->\r\n+              <div class=\"bg-space-700/80 px-3 py-1.5 flex items-center justify-between border-b border-space-600\">\r\n+                <span class=\"text-xs font-bold text-gray-400\">{scoreLabel}</span>\r\n+                <div class=\"flex items-center gap-1 text-xs font-bold {status === 'complete' ? 'text-brand-cyan' : status === 'live' ? 'text-yellow-500' : 'text-gray-500'}\">\r\n+                  {#if status === 'complete'}\r\n+                    <svg class=\"w-3 h-3\" fill=\"currentColor\" viewBox=\"0 0 20 20\"><path fill-rule=\"evenodd\" d=\"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z\" clip-rule=\"evenodd\"/></svg>\r\n+                  {:else if status === 'live'}\r\n+                    <svg class=\"w-3 h-3\" fill=\"currentColor\" viewBox=\"0 0 20 20\"><path fill-rule=\"evenodd\" d=\"M11.3 1.046A1 1 0 0112 2v5h4a1 1 0 01.82 1.573l-7 10A1 1 0 018 18v-5H4a1 1 0 01-.82-1.573l7-10a1 1 0 011.12-.38z\" clip-rule=\"evenodd\"/></svg>\r\n+                  {/if}\r\n+                  {status === 'complete' ? 'Done' : status === 'live' ? 'Live' : 'Pending'}\r\n+                </div>\r\n               </div>\r\n \r\n               <div class=\"space-y-1.5\">\r\n                 <!-- Player 1 -->\r\n                 <div class=\"p-2 rounded bg-space-700/50 {matchSelections[match.id]?.[match.player1Id] === 'win' ? 'ring-1 ring-cyber-green' : matchSelections[match.id]?.[match.player1Id] === 'loss' ? 'opacity-60' : ''} transition-all\">\r\n                   <div class=\"flex items-center justify-between mb-1.5\">\r\n                     <div class=\"flex items-center gap-2\">\r\n-                      {#if player1?.profilePhoto}\r\n-                        <img src={player1.profilePhoto} alt=\"Profile\" class=\"w-6 h-6 rounded-full object-cover\" />\r\n-                      {:else}\r\n-                        <div class=\"w-6 h-6 rounded-full bg-gradient-to-br from-cyan-500 to-blue-500 flex items-center justify-center\">\r\n-                          <svg class=\"w-3.5 h-3.5 text-white\" fill=\"currentColor\" viewBox=\"0 0 20 20\"><path fill-rule=\"evenodd\" d=\"M10 9a3 3 0 100-6 3 3 0 000 6zm-7 9a7 7 0 1114 0H3z\" clip-rule=\"evenodd\"/></svg>\r\n-                        </div>\r\n-                      {/if}\r\n+                      <div class=\"w-6 h-6 rounded-full bg-gradient-to-br from-cyan-500 to-blue-500 flex items-center justify-center\">\r\n+                        <svg class=\"w-3.5 h-3.5 text-white\" fill=\"currentColor\" viewBox=\"0 0 20 20\"><path fill-rule=\"evenodd\" d=\"M10 9a3 3 0 100-6 3 3 0 000 6zm-7 9a7 7 0 1114 0H3z\" clip-rule=\"evenodd\"/></svg>\r\n+                      </div>\r\n                       <div>\r\n                         <div class=\"font-bold text-xs text-white\">{player1?.name || 'Unknown'}</div>\r\n                         <div class=\"text-xs text-gray-400\">{player1?.points || 0}pts</div>\r\n                       </div>\r\n@@ -464,60 +450,128 @@\n                 <!-- Player 2 -->\r\n                 <div class=\"p-2 rounded bg-space-700/50 {matchSelections[match.id]?.[match.player2Id] === 'win' ? 'ring-1 ring-cyber-green' : matchSelections[match.id]?.[match.player2Id] === 'loss' ? 'opacity-60' : ''} transition-all\">\r\n                   <div class=\"flex items-center justify-between mb-1.5\">\r\n                     <div class=\"flex items-center gap-2\">\r\n-                      {#if player2?.profilePhoto}\r\n-                        <img src={player2.profilePhoto} alt=\"Profile\" class=\"w-6 h-6 rounded-full object-cover\" />\r\n-                      {:else}\r\n-                        <div class=\"w-6 h-6 rounded-full bg-gradient-to-br from-purple-500 to-pink-500 flex items-center justify-center\">\r\n-                          <svg class=\"w-3.5 h-3.5 text-white\" fill=\"currentColor\" viewBox=\"0 0 20 20\"><path fill-rule=\"evenodd\" d=\"M10 9a3 3 0 100-6 3 3 0 000 6zm-7 9a7 7 0 1114 0H3z\" clip-rule=\"evenodd\"/></svg>\r\n-                        </div>\r\n-                      {/if}\r\n+                      <div class=\"w-6 h-6 rounded-full bg-gradient-to-br from-purple-500 to-pink-500 flex items-center justify-center\">\r\n+                        <svg class=\"w-3.5 h-3.5 text-white\" fill=\"currentColor\" viewBox=\"0 0 20 20\"><path fill-rule=\"evenodd\" d=\"M10 9a3 3 0 100-6 3 3 0 000 6zm-7 9a7 7 0 1114 0H3z\" clip-rule=\"evenodd\"/></svg>\r\n+                      </div>\r\n                       <div>\r\n                         <div class=\"font-bold text-xs text-white\">{player2?.name || 'Unknown'}</div>\r\n                         <div class=\"text-xs text-gray-400\">{player2?.points || 0}pts</div>\r\n                       </div>\r\n-                    </div>\r\n-                    {#if matchSelections[match.id]?.[match.player2Id] === 'win'}\r\n-                      <svg class=\"w-4 h-4 text-cyber-green\" fill=\"currentColor\" viewBox=\"0 0 20 20\"><path d=\"M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z\"/></svg>\r\n                     {/if}\r\n+                    <span class=\"font-bold text-xs text-white truncate\">{player1?.name || 'Unknown'}</span>\r\n+                    {#if result === 'player1'}\r\n+                      <svg class=\"w-4 h-4 text-cyber-green flex-shrink-0\" fill=\"currentColor\" viewBox=\"0 0 20 20\"><path d=\"M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z\"/></svg>\r\n+                    {/if}\r\n                   </div>\r\n                   \r\n-                  {#if !match.completed}\r\n+                  <!-- Spacer -->\r\n+                  <div class=\"w-12\"></div>\r\n+                  \r\n+                  <!-- Player 2 Info -->\r\n+                  <div class=\"flex-1 flex items-center justify-end gap-2 {result === 'player1' ? 'opacity-50' : ''}\">\r\n+                    {#if result === 'player2'}\r\n+                      <svg class=\"w-4 h-4 text-cyber-green flex-shrink-0\" fill=\"currentColor\" viewBox=\"0 0 20 20\"><path d=\"M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z\"/></svg>\r\n+                    {/if}\r\n+                    <span class=\"font-bold text-xs text-white truncate\">{player2?.name || 'Unknown'}</span>\r\n+                    {#if player2?.profilePhoto}\r\n+                      <img src={player2.profilePhoto} alt=\"Profile\" class=\"w-7 h-7 rounded-full object-cover flex-shrink-0\" />\r\n+                    {:else}\r\n+                      <div class=\"w-7 h-7 rounded-full bg-gradient-to-br from-purple-500 to-pink-500 flex items-center justify-center flex-shrink-0\">\r\n+                        <svg class=\"w-4 h-4 text-white\" fill=\"currentColor\" viewBox=\"0 0 20 20\"><path fill-rule=\"evenodd\" d=\"M10 9a3 3 0 100-6 3 3 0 000 6zm-7 9a7 7 0 1114 0H3z\" clip-rule=\"evenodd\"/></svg>\r\n+                      </div>\r\n+                    {/if}\r\n+                  </div>\r\n+                </div>\r\n+\r\n+                <!-- Submit Button -->\r\n+                {#if !match.completed && isValidScore(match.id)}\r\n+                  <div class=\"mt-3 pt-3 border-t border-space-600\">\r\n                     <button \r\n-                      onclick={() => setWinner(match.id, match.player2Id, match.player1Id)}\r\n-                      class=\"w-full py-1 px-2 text-xs rounded font-bold transition-all {matchSelections[match.id]?.[match.player2Id] === 'win' ? 'bg-gradient-to-r from-cyber-green to-emerald-500 text-space-900' : 'bg-space-600 hover:bg-cyber-green/20 text-gray-300 hover:text-cyber-green'}\"\r\n+                      onclick={() => submitMatchResult(match.id, match)}\r\n+                      class=\"w-full bg-gradient-to-r from-brand-cyan to-cyber-blue text-white font-bold py-2 px-3 rounded-lg text-sm hover:scale-102 transition-all shadow-lg shadow-brand-cyan/20\"\r\n                     >\r\n-                      {matchSelections[match.id]?.[match.player2Id] === 'win' ? '✓ Winner' : 'Winner'}\r\n+                      Submit Result ({scores.player1Score} - {scores.player2Score})\r\n                     </button>\r\n+                  </div>\r\n+                {:else if !match.completed && (scores.player1Score > 0 || scores.player2Score > 0)}\r\n+                  {@const validationError = getValidationError(match.id)}\r\n+                  {#if validationError}\r\n+                    <div class=\"mt-3 pt-3 border-t border-space-600 text-center text-xs text-yellow-500\">\r\n+                      {validationError}\r\n+                    </div>\r\n                   {/if}\r\n-                </div>\r\n+                {/if}\r\n               </div>\r\n-\r\n-              <!-- Submit Button -->\r\n-              {#if !match.completed && (matchSelections[match.id]?.[match.player1Id] || matchSelections[match.id]?.[match.player2Id])}\r\n-                <div class=\"mt-1.5\">\r\n-                  <button \r\n-                    onclick={() => submitMatchResult(match.id)}\r\n-                    class=\"w-full bg-gradient-to-r from-cyber-blue to-blue-600 text-white font-bold py-1.5 px-3 rounded text-xs hover:scale-102 transition-all\"\r\n-                  >\r\n-                    Submit Result\r\n-                  </button>\r\n-                </div>\r\n-              {/if}\r\n             </div>\r\n         {/each}\r\n+      </div>\r\n     </div>\r\n+  </div>\r\n+</div>\r\n \r\n-    <!-- Full Tournament Reset Button -->\r\n-    <div class=\"text-center pt-8 border-t border-space-600 mt-8\">\r\n-      <button\r\n-        onclick={() => handleResetTournament()}\r\n-        class=\"text-red-400/70 hover:text-red-400 text-base font-semibold transition-colors hover:underline\"\r\n-      >\r\n-        <svg class=\"w-4 h-4 inline-block mr-1\" fill=\"currentColor\" viewBox=\"0 0 20 20\"><path fill-rule=\"evenodd\" d=\"M9 2a1 1 0 00-.894.553L7.382 4H4a1 1 0 000 2v10a2 2 0 002 2h8a2 2 0 002-2V6a1 1 0 100-2h-3.382l-.724-1.447A1 1 0 0011 2H9zM7 8a1 1 0 012 0v6a1 1 0 11-2 0V8zm5-1a1 1 0 00-1 1v6a1 1 0 102 0V8a1 1 0 00-1-1z\" clip-rule=\"evenodd\"/></svg>\r\n-        Reset Entire Tournament\r\n-      </button>\r\n+<!-- Error Popup Modal -->\r\n+{#if showErrorPopup}\r\n+  <div class=\"fixed inset-0 bg-black/80 backdrop-blur-sm z-50 flex items-center justify-center p-4\">\r\n+    <div class=\"glass rounded-xl max-w-md w-full shadow-2xl border border-red-500/30\">\r\n+      <div class=\"flex items-center gap-3 p-6 border-b border-space-600\">\r\n+        <div class=\"w-12 h-12 rounded-full bg-red-500/20 flex items-center justify-center\">\r\n+          <svg class=\"w-6 h-6 text-red-500\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\" stroke-width=\"2\">\r\n+            <path stroke-linecap=\"round\" stroke-linejoin=\"round\" d=\"M6 18L18 6M6 6l12 12\"/>\r\n+          </svg>\r\n+        </div>\r\n+        <div>\r\n+          <h2 class=\"text-xl font-bold text-white\">Error</h2>\r\n+          <p class=\"text-gray-400 text-sm\">Something went wrong</p>\r\n+        </div>\r\n+      </div>\r\n+      <div class=\"p-6\">\r\n+        <p class=\"text-gray-300 mb-6\">{errorMessage}</p>\r\n+        <div class=\"flex justify-end\">\r\n+          <button\r\n+            onclick={() => showErrorPopup = false}\r\n+            class=\"bg-gradient-to-r from-brand-purple to-brand-cyan text-white font-bold px-6 py-2 rounded-lg shadow-glow-cyan hover:scale-105 transition-all duration-300\"\r\n+          >\r\n+            Got it\r\n+          </button>\r\n+        </div>\r\n+      </div>\r\n     </div>\r\n   </div>\r\n-</div>\r\n-</div>\r\n+{/if}\r\n+\r\n+<!-- Confirmation Popup Modal -->\r\n+{#if showConfirmPopup}\r\n+  <div class=\"fixed inset-0 bg-black/80 backdrop-blur-sm z-50 flex items-center justify-center p-4\">\r\n+    <div class=\"glass rounded-xl max-w-md w-full shadow-2xl border border-brand-cyan/30\">\r\n+      <div class=\"flex items-center gap-3 p-6 border-b border-space-600\">\r\n+        <div class=\"w-12 h-12 rounded-full bg-brand-cyan/20 flex items-center justify-center\">\r\n+          <svg class=\"w-6 h-6 text-brand-cyan\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\" stroke-width=\"2\">\r\n+            <path stroke-linecap=\"round\" stroke-linejoin=\"round\" d=\"M8.228 9c.549-1.165 2.03-2 3.772-2 2.21 0 4 1.343 4 3 0 1.4-1.278 2.575-3.006 2.907-.542.104-.994.54-.994 1.093m0 3h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z\"/>\r\n+          </svg>\r\n+        </div>\r\n+        <div>\r\n+          <h2 class=\"text-xl font-bold text-white\">{confirmTitle}</h2>\r\n+          <p class=\"text-gray-400 text-sm\">Please confirm</p>\r\n+        </div>\r\n+      </div>\r\n+      <div class=\"p-6\">\r\n+        <p class=\"text-gray-300 mb-6\">{confirmMessage}</p>\r\n+        <div class=\"flex justify-end gap-3\">\r\n+          <button\r\n+            onclick={cancelConfirmation}\r\n+            class=\"bg-gray-600 hover:bg-gray-500 text-white font-bold px-4 py-2 rounded-lg transition-all duration-300\"\r\n+          >\r\n+            Cancel\r\n+          </button>\r\n+          <button\r\n+            onclick={executeConfirmedAction}\r\n+            class=\"bg-gradient-to-r from-brand-purple to-brand-cyan text-white font-bold px-6 py-2 rounded-lg shadow-lg hover:scale-105 transition-all duration-300\"\r\n+          >\r\n+            {confirmButtonText}\r\n+          </button>\r\n+        </div>\r\n+      </div>\r\n+    </div>\r\n+  </div>\r\n+{/if}\r\n"
                },
                {
                    "date": 1764770232525,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1,8 +1,10 @@\n <script lang=\"ts\">\r\n   import { onMount } from 'svelte';\r\n-  import { getState, submitMatch, generateBrackets } from '$lib/api';\r\n+  import { getState, submitMatch, generateBrackets, updateGroupName, resetGroupData, resetTournament, type GameType, GAME_CONFIGS } from '$lib/api';\r\n \r\n+  let { tournamentId } = $props<{ tournamentId: string }>();\r\n+\r\n   let pods = $state([]) as any[];\r\n   let matches = $state([]) as any[];\r\n   let players = $state([]) as any[];\r\n   let tournamentState = $state('');\r\n"
                },
                {
                    "date": 1764770242996,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -62,10 +62,11 @@\n     pods = data.pods;\r\n     matches = data.matches;\r\n     players = data.players;\r\n     tournamentState = data.state;\r\n-    \r\n-    // Initialize selections from existing results\r\n+    gameType = data.gameType || 'cs16';\r\n+\r\n+    // Initialize scores from existing results\r\n     matches.forEach(m => {\r\n         if (m.result) {\r\n             // Try to get stored scores, or calculate from points\r\n             const p1Result = m.result[m.player1Id];\r\n"
                },
                {
                    "date": 1764770249507,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -225,9 +225,9 @@\n         results[match.player2Id] = { points: 1, score: player2Score };\r\n       }\r\n \r\n       console.log('[Groups] submitMatchResult - submitting results:', results);\r\n-      await submitMatch(matchId, results);\r\n+      await submitMatch(tournamentId, matchId, results);\r\n       console.log('[Groups] submitMatchResult - match submitted, reloading state');\r\n       await loadState();\r\n       console.log('[Groups] submitMatchResult complete');\r\n   }\r\n"
                },
                {
                    "date": 1764770258925,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -231,19 +231,21 @@\n       await loadState();\r\n       console.log('[Groups] submitMatchResult complete');\r\n   }\r\n \r\n-  async function handleGenerateBrackets() {\r\n-      if (confirm('Finish Group Stage and Generate Brackets?')) {\r\n-          try {\r\n-              console.log('[Groups] Generating brackets...');\r\n-              await generateBrackets();\r\n-              console.log('[Groups] Brackets generated, redirecting...');\r\n-              window.location.href = '/brackets';\r\n-          } catch (error) {\r\n-              console.error('[Groups] Error generating brackets:', error);\r\n-              alert('Failed to generate brackets. Check console for details.');\r\n-          }\r\n+  function handleGenerateBrackets() {\r\n+    confirmTitle = 'Generate Brackets';\r\n+    confirmMessage = 'Finish Group Stage and Generate Brackets? This will advance the tournament to the playoffs.';\r\n+    confirmButtonText = 'Generate';\r\n+    pendingAction = async () => {\r\n+      try {\r\n+        console.log('[Groups] Generating brackets...');\r\n+        await generateBrackets(tournamentId);\r\n+        console.log('[Groups] Brackets generated, redirecting...');\r\n+        window.location.href = `/tournament/${tournamentId}/brackets`;\r\n+      } catch (error) {\r\n+        console.error('[Groups] Error generating brackets:', error);\r\n+        showError('Failed to generate brackets. Check console for details.');\r\n       }\r\n     };\r\n     showConfirmPopup = true;\r\n   }\r\n@@ -351,9 +353,60 @@\n       </h2>\r\n       <div class=\"grid grid-cols-1 md:grid-cols-2 gap-3\">\r\n         {#each Object.entries(groupsWithPlayers) as [groupId, groupPlayers] (groupId)}\r\n           <div class=\"glass rounded-lg p-2\">\r\n-            <h3 class=\"text-xs font-bold text-cyber-blue mb-1.5 px-2\">Group {groupId}</h3>\r\n+            <!-- Group Header with Edit and Reset -->\r\n+            <div class=\"flex items-center justify-between mb-1.5 px-2\">\r\n+              {#if editingGroupId === groupId}\r\n+                <div class=\"flex items-center gap-2 flex-1\">\r\n+                  <input\r\n+                    type=\"text\"\r\n+                    bind:value={editingGroupName}\r\n+                    class=\"flex-1 px-2 py-1 text-xs bg-space-700 border border-cyber-blue rounded text-white placeholder-gray-400 focus:outline-none focus:ring-1 focus:ring-cyber-green\"\r\n+                    placeholder=\"Group name...\"\r\n+                    onkeydown={(e) => {\r\n+                      if (e.key === 'Enter') saveGroupName(groupId);\r\n+                      if (e.key === 'Escape') cancelEditingGroup();\r\n+                    }}\r\n+                  />\r\n+                  <button\r\n+                    onclick={() => saveGroupName(groupId)}\r\n+                    class=\"px-2 py-1 text-xs bg-brand-purple text-white rounded font-bold hover:bg-brand-cyan transition-colors\"\r\n+                  >\r\n+                    ✓\r\n+                  </button>\r\n+                  <button\r\n+                    onclick={cancelEditingGroup}\r\n+                    class=\"px-2 py-1 text-xs bg-gray-600 text-white rounded font-bold hover:bg-gray-500\"\r\n+                  >\r\n+                    ✕\r\n+                  </button>\r\n+                </div>\r\n+              {:else}\r\n+                <div class=\"flex items-center gap-2 flex-1\">\r\n+                  <span class=\"text-xs font-bold text-cyber-blue hover:text-cyber-green transition-colors\">\r\n+                    {getGroupDisplayName(groupId)}\r\n+                  </span>\r\n+                  {#if tournamentState === 'registration'}\r\n+                    <button\r\n+                      class=\"ml-2 px-2 py-1 text-xs bg-brand-purple text-white rounded hover:bg-brand-cyan transition-colors\"\r\n+                      onclick={() => startEditingGroup(groupId, getGroupDisplayName(groupId))}\r\n+                    >\r\n+                      Edit\r\n+                    </button>\r\n+                  {/if}\r\n+                </div>\r\n+              {/if}\r\n+              <button\r\n+                onclick={() => handleResetGroup(groupId)}\r\n+                class=\"px-2 py-1 text-xs bg-gradient-to-r from-red-600 to-orange-500 text-white rounded-lg font-bold shadow-md shadow-red-500/20 hover:shadow-red-500/40 hover:scale-105 transition-all duration-300 border border-red-400/30\"\r\n+                title=\"Reset group data\"\r\n+              >\r\n+                <svg class=\"w-3 h-3\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\" stroke-width=\"2\">\r\n+                  <path stroke-linecap=\"round\" stroke-linejoin=\"round\" d=\"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15\"/>\r\n+                </svg>\r\n+              </button>\r\n+            </div>\r\n             <table class=\"w-full text-xs\">\r\n               <thead>\r\n                 <tr class=\"border-b border-space-600\">\r\n                   <th class=\"text-left py-1 px-1 text-gray-400 font-bold text-xs\">#</th>\r\n@@ -361,8 +414,9 @@\n                   <th class=\"text-center py-1 px-1 text-gray-400 font-bold text-xs\">P</th>\r\n                   <th class=\"text-center py-1 px-1 text-gray-400 font-bold text-xs\">W</th>\r\n                   <th class=\"text-center py-1 px-1 text-gray-400 font-bold text-xs\">D</th>\r\n                   <th class=\"text-center py-1 px-1 text-gray-400 font-bold text-xs\">L</th>\r\n+                  <th class=\"text-center py-1 px-1 text-gray-400 font-bold text-xs\" title=\"{scoreLabel} - Tiebreaker\">{gameType === 'cs16' ? 'Rds' : gameType === 'ut2004' ? 'K' : 'HP'}</th>\r\n                   <th class=\"text-center py-1 px-1 text-gray-400 font-bold text-xs\">Pts</th>\r\n                 </tr>\r\n               </thead>\r\n               <tbody>\r\n@@ -372,13 +426,19 @@\n                       <div class=\"w-4 h-4 rounded-full flex items-center justify-center font-bold text-xs {index === 0 ? 'bg-gradient-to-br from-yellow-400 to-yellow-600 text-space-900' : index === 1 ? 'bg-gradient-to-br from-gray-300 to-gray-500 text-space-900' : 'bg-space-600 text-gray-400'}\">\r\n                         {index + 1}\r\n                       </div>\r\n                     </td>\r\n-                    <td class=\"py-1 px-1 font-bold text-white text-xs\">{player.name}</td>\r\n+                    <td class=\"py-1 px-1 font-bold text-white text-xs flex items-center gap-2\">\r\n+                      {#if player.profilePhoto}\r\n+                        <img src={player.profilePhoto} alt=\"Profile\" class=\"w-6 h-6 rounded-full object-cover inline-block\" />\r\n+                      {/if}\r\n+                      {player.name}\r\n+                    </td>                    \r\n                     <td class=\"text-center py-1 px-1 text-gray-400\">{(player.wins || 0) + (player.draws || 0) + (player.losses || 0)}</td>\r\n                     <td class=\"text-center py-1 px-1 text-cyber-green font-bold\">{player.wins || 0}</td>\r\n                     <td class=\"text-center py-1 px-1 text-yellow-500 font-bold\">{player.draws || 0}</td>\r\n                     <td class=\"text-center py-1 px-1 text-red-400 font-bold\">{player.losses || 0}</td>\r\n+                    <td class=\"text-center py-1 px-1 text-brand-cyan font-bold\" title=\"{scoreLabel}\">{player.totalGameScore || 0}</td>\r\n                     <td class=\"text-center py-1 px-1 text-cyber-green font-black\">{player.points || 0}</td>\r\n                   </tr>\r\n                 {/each}\r\n               </tbody>\r\n"
                },
                {
                    "date": 1764770267859,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -471,57 +471,68 @@\n                   {status === 'complete' ? 'Done' : status === 'live' ? 'Live' : 'Pending'}\r\n                 </div>\r\n               </div>\r\n \r\n-              <div class=\"space-y-1.5\">\r\n-                <!-- Player 1 -->\r\n-                <div class=\"p-2 rounded bg-space-700/50 {matchSelections[match.id]?.[match.player1Id] === 'win' ? 'ring-1 ring-cyber-green' : matchSelections[match.id]?.[match.player1Id] === 'loss' ? 'opacity-60' : ''} transition-all\">\r\n-                  <div class=\"flex items-center justify-between mb-1.5\">\r\n-                    <div class=\"flex items-center gap-2\">\r\n-                      <div class=\"w-6 h-6 rounded-full bg-gradient-to-br from-cyan-500 to-blue-500 flex items-center justify-center\">\r\n-                        <svg class=\"w-3.5 h-3.5 text-white\" fill=\"currentColor\" viewBox=\"0 0 20 20\"><path fill-rule=\"evenodd\" d=\"M10 9a3 3 0 100-6 3 3 0 000 6zm-7 9a7 7 0 1114 0H3z\" clip-rule=\"evenodd\"/></svg>\r\n-                      </div>\r\n-                      <div>\r\n-                        <div class=\"font-bold text-xs text-white\">{player1?.name || 'Unknown'}</div>\r\n-                        <div class=\"text-xs text-gray-400\">{player1?.points || 0}pts</div>\r\n-                      </div>\r\n-                    </div>\r\n-                    {#if matchSelections[match.id]?.[match.player1Id] === 'win'}\r\n-                      <svg class=\"w-4 h-4 text-cyber-green\" fill=\"currentColor\" viewBox=\"0 0 20 20\"><path d=\"M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z\"/></svg>\r\n+              <!-- Match Content -->\r\n+              <div class=\"p-3\">\r\n+                <!-- Score Display Row -->\r\n+                <div class=\"flex items-center justify-center gap-3 mb-3\">\r\n+                  <!-- Player 1 Score -->\r\n+                  <div class=\"flex-1 text-center\">\r\n+                    {#if !match.completed}\r\n+                      <input\r\n+                        type=\"number\"\r\n+                        min=\"0\"\r\n+                        max={maxScore || undefined}\r\n+                        value={scores.player1Score || ''}\r\n+                        placeholder=\"0\"\r\n+                        oninput={(e) => updateScore(match.id, 'player1', parseInt((e.target as HTMLInputElement).value) || 0)}\r\n+                        class=\"w-full text-center text-3xl font-black bg-space-600 border-2 {result === 'player1' ? 'border-cyber-green' : 'border-space-500'} rounded-lg py-2 text-white placeholder-gray-600 focus:outline-none focus:ring-2 focus:ring-brand-cyan appearance-none [&::-webkit-inner-spin-button]:appearance-none [&::-webkit-outer-spin-button]:appearance-none [-moz-appearance:textfield]\"\r\n+                      />\r\n+                    {:else}\r\n+                      <div class=\"text-3xl font-black {result === 'player1' ? 'text-cyber-green' : result === 'player2' ? 'text-gray-500' : 'text-yellow-500'}\">{scores.player1Score}</div>\r\n                     {/if}\r\n                   </div>\r\n                   \r\n-                  {#if !match.completed}\r\n-                    <button \r\n-                      onclick={() => setWinner(match.id, match.player1Id, match.player2Id)}\r\n-                      class=\"w-full py-1 px-2 text-xs rounded font-bold transition-all {matchSelections[match.id]?.[match.player1Id] === 'win' ? 'bg-gradient-to-r from-cyber-green to-emerald-500 text-space-900' : 'bg-space-600 hover:bg-cyber-green/20 text-gray-300 hover:text-cyber-green'}\"\r\n-                    >\r\n-                      {matchSelections[match.id]?.[match.player1Id] === 'win' ? '✓ Winner' : 'Winner'}\r\n-                    </button>\r\n-                  {/if}\r\n+                  <!-- VS / Result -->\r\n+                  <div class=\"flex-shrink-0 w-12 text-center\">\r\n+                    {#if result === 'tie'}\r\n+                      <span class=\"text-yellow-500 font-black text-sm\">TIE</span>\r\n+                    {:else if match.completed}\r\n+                      <span class=\"text-gray-600 font-bold text-lg\">:</span>\r\n+                    {:else}\r\n+                      <span class=\"text-gray-500 font-bold text-sm\">VS</span>\r\n+                    {/if}\r\n+                  </div>\r\n+                  \r\n+                  <!-- Player 2 Score -->\r\n+                  <div class=\"flex-1 text-center\">\r\n+                    {#if !match.completed}\r\n+                      <input\r\n+                        type=\"number\"\r\n+                        min=\"0\"\r\n+                        max={maxScore || undefined}\r\n+                        value={scores.player2Score || ''}\r\n+                        placeholder=\"0\"\r\n+                        oninput={(e) => updateScore(match.id, 'player2', parseInt((e.target as HTMLInputElement).value) || 0)}\r\n+                        class=\"w-full text-center text-3xl font-black bg-space-600 border-2 {result === 'player2' ? 'border-cyber-green' : 'border-space-500'} rounded-lg py-2 text-white placeholder-gray-600 focus:outline-none focus:ring-2 focus:ring-brand-cyan appearance-none [&::-webkit-inner-spin-button]:appearance-none [&::-webkit-outer-spin-button]:appearance-none [-moz-appearance:textfield]\"\r\n+                      />\r\n+                    {:else}\r\n+                      <div class=\"text-3xl font-black {result === 'player2' ? 'text-cyber-green' : result === 'player1' ? 'text-gray-500' : 'text-yellow-500'}\">{scores.player2Score}</div>\r\n+                    {/if}\r\n+                  </div>\r\n                 </div>\r\n \r\n-                <!-- Tie Button -->\r\n-                {#if !match.completed}\r\n-                  <button \r\n-                    onclick={() => setTie(match.id, match.player1Id, match.player2Id)}\r\n-                    class=\"w-full py-0.5 text-xs rounded font-bold transition-all {matchSelections[match.id]?.[match.player1Id] === 'tie' ? 'bg-gradient-to-r from-yellow-400 to-yellow-600 text-space-900' : 'bg-space-700 hover:bg-yellow-500/20 text-gray-300 hover:text-yellow-500'}\"\r\n-                  >\r\n-                    {matchSelections[match.id]?.[match.player1Id] === 'tie' ? '✓ Tie' : 'Tie'}\r\n-                  </button>\r\n-                {/if}\r\n-\r\n-                <!-- Player 2 -->\r\n-                <div class=\"p-2 rounded bg-space-700/50 {matchSelections[match.id]?.[match.player2Id] === 'win' ? 'ring-1 ring-cyber-green' : matchSelections[match.id]?.[match.player2Id] === 'loss' ? 'opacity-60' : ''} transition-all\">\r\n-                  <div class=\"flex items-center justify-between mb-1.5\">\r\n-                    <div class=\"flex items-center gap-2\">\r\n-                      <div class=\"w-6 h-6 rounded-full bg-gradient-to-br from-purple-500 to-pink-500 flex items-center justify-center\">\r\n-                        <svg class=\"w-3.5 h-3.5 text-white\" fill=\"currentColor\" viewBox=\"0 0 20 20\"><path fill-rule=\"evenodd\" d=\"M10 9a3 3 0 100-6 3 3 0 000 6zm-7 9a7 7 0 1114 0H3z\" clip-rule=\"evenodd\"/></svg>\r\n+                <!-- Player Names Row -->\r\n+                <div class=\"flex items-center justify-between gap-3\">\r\n+                  <!-- Player 1 Info -->\r\n+                  <div class=\"flex-1 flex items-center gap-2 {result === 'player2' ? 'opacity-50' : ''}\">\r\n+                    {#if player1?.profilePhoto}\r\n+                      <img src={player1.profilePhoto} alt=\"Profile\" class=\"w-7 h-7 rounded-full object-cover flex-shrink-0\" />\r\n+                    {:else}\r\n+                      <div class=\"w-7 h-7 rounded-full bg-gradient-to-br from-cyan-500 to-blue-500 flex items-center justify-center flex-shrink-0\">\r\n+                        <svg class=\"w-4 h-4 text-white\" fill=\"currentColor\" viewBox=\"0 0 20 20\"><path fill-rule=\"evenodd\" d=\"M10 9a3 3 0 100-6 3 3 0 000 6zm-7 9a7 7 0 1114 0H3z\" clip-rule=\"evenodd\"/></svg>\r\n                       </div>\r\n-                      <div>\r\n-                        <div class=\"font-bold text-xs text-white\">{player2?.name || 'Unknown'}</div>\r\n-                        <div class=\"text-xs text-gray-400\">{player2?.points || 0}pts</div>\r\n-                      </div>\r\n                     {/if}\r\n                     <span class=\"font-bold text-xs text-white truncate\">{player1?.name || 'Unknown'}</span>\r\n                     {#if result === 'player1'}\r\n                       <svg class=\"w-4 h-4 text-cyber-green flex-shrink-0\" fill=\"currentColor\" viewBox=\"0 0 20 20\"><path d=\"M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z\"/></svg>\r\n"
                },
                {
                    "date": 1764770278462,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -8,11 +8,110 @@\n   let matches = $state([]) as any[];\r\n   let players = $state([]) as any[];\r\n   let tournamentState = $state('');\r\n   let currentRound = $state(1);\r\n+  let gameType = $state<GameType | null>(null);\r\n \r\n-  // Local state to track UI selections before submission\r\n-  let matchSelections = $state({}) as Record<string, { [pid: string]: 'win' | 'loss' | 'tie' }>;\r\n+  // Score-based input state (player1Score, player2Score per match)\r\n+  let matchScores = $state({}) as Record<string, { player1Score: number; player2Score: number }>;\r\n+\r\n+  // Group editing state\r\n+  let editingGroupId = $state(null) as string | null;\r\n+  let editingGroupName = $state('');\r\n+\r\n+  // Popup state\r\n+  let showErrorPopup = $state(false);\r\n+  let errorMessage = $state('');\r\n+  let showConfirmPopup = $state(false);\r\n+  let confirmMessage = $state('');\r\n+  let confirmTitle = $state('');\r\n+  let confirmButtonText = $state('Confirm');\r\n+  let pendingAction = $state<(() => Promise<void>) | null>(null);\r\n+\r\n+  // Derived game config\r\n+  const gameConfig = $derived(gameType ? GAME_CONFIGS[gameType] : null);\r\n+  const scoreLabel = $derived(gameConfig?.groupStage.scoreLabel || 'Score');\r\n+  const maxScore = $derived(gameConfig?.groupStage.maxScore); // undefined = no limit\r\n+  const tieAllowed = $derived(gameConfig?.groupStage.tieAllowed ?? true);\r\n+\r\n+  // Popup helper functions\r\n+  function showError(message: string) {\r\n+    errorMessage = message;\r\n+    showErrorPopup = true;\r\n+  }\r\n+\r\n+  async function executeConfirmedAction() {\r\n+    if (pendingAction) {\r\n+      await pendingAction();\r\n+    }\r\n+    showConfirmPopup = false;\r\n+    pendingAction = null;\r\n+  }\r\n+\r\n+  function cancelConfirmation() {\r\n+    showConfirmPopup = false;\r\n+    pendingAction = null;\r\n+  }\r\n+\r\n+  // Group name editing functions\r\n+  function startEditingGroup(groupId: string, currentName: string) {\r\n+    editingGroupId = groupId;\r\n+    editingGroupName = currentName || `Group ${groupId}`;\r\n+  }\r\n+\r\n+  function cancelEditingGroup() {\r\n+    editingGroupId = null;\r\n+    editingGroupName = '';\r\n+  }\r\n+\r\n+  async function saveGroupName(groupId: string) {\r\n+    try {\r\n+      await updateGroupName(tournamentId, groupId, editingGroupName.trim());\r\n+      await loadState();\r\n+      editingGroupId = null;\r\n+      editingGroupName = '';\r\n+    } catch (error) {\r\n+      console.error('Failed to update group name:', error);\r\n+      showError('Failed to update group name');\r\n+    }\r\n+  }\r\n+\r\n+  function handleResetGroup(groupId: string) {\r\n+    confirmTitle = 'Reset Group';\r\n+    confirmMessage = 'Reset all match results for this group? This will clear all player stats in this group.';\r\n+    confirmButtonText = 'Reset';\r\n+    pendingAction = async () => {\r\n+      try {\r\n+        await resetGroupData(tournamentId, groupId);\r\n+        await loadState();\r\n+      } catch (error) {\r\n+        console.error('Failed to reset group data:', error);\r\n+        showError('Failed to reset group data');\r\n+      }\r\n+    };\r\n+    showConfirmPopup = true;\r\n+  }\r\n+\r\n+  function handleResetTournament() {\r\n+    confirmTitle = 'Reset Tournament';\r\n+    confirmMessage = 'Reset the entire tournament? This will delete ALL tournament data including players, groups, matches, and brackets. This action cannot be undone.';\r\n+    confirmButtonText = 'Reset';\r\n+    pendingAction = async () => {\r\n+      try {\r\n+        await resetTournament(tournamentId);\r\n+        window.location.href = '/';\r\n+      } catch (error) {\r\n+        console.error('Failed to reset tournament:', error);\r\n+        showError('Failed to reset tournament');\r\n+      }\r\n+    };\r\n+    showConfirmPopup = true;\r\n+  }\r\n+\r\n+  function getGroupDisplayName(groupId: string) {\r\n+    const pod = pods.find(p => p.id === groupId);\r\n+    return pod?.name || `Group ${groupId}`;\r\n+  }\r\n   \r\n   // Reactive derived values using $derived\r\n   let currentRoundMatches = $derived(getMatchesForRound(currentRound));\r\n   let groupsWithPlayers = $derived(getGroupsWithPlayers());\r\n@@ -580,8 +679,21 @@\n             </div>\r\n         {/each}\r\n       </div>\r\n     </div>\r\n+\r\n+    <!-- Full Tournament Reset Button -->\r\n+    <div class=\"text-center pt-8 border-t border-space-600 mt-8\">\r\n+      <button\r\n+        onclick={() => handleResetTournament()}\r\n+        class=\"bg-gradient-to-r from-red-600 via-red-500 to-orange-500 text-white font-bold text-sm px-6 py-2.5 rounded-xl shadow-lg shadow-red-500/30 hover:shadow-red-500/50 hover:scale-105 transition-all duration-300 border border-red-400/30\"\r\n+      >\r\n+        <svg class=\"w-4 h-4 inline-block mr-2\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\" stroke-width=\"2\">\r\n+          <path stroke-linecap=\"round\" stroke-linejoin=\"round\" d=\"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16\"/>\r\n+        </svg>\r\n+        Reset Tournament Data\r\n+      </button>\r\n+    </div>\r\n   </div>\r\n </div>\r\n \r\n <!-- Error Popup Modal -->\r\n"
                },
                {
                    "date": 1764770425084,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -175,10 +175,10 @@\n                 player2Score: p2Result?.score ?? (p2Result?.points === 3 ? 16 : p2Result?.points === 1 ? 15 : 0)\r\n             };\r\n         }\r\n     });\r\n-    \r\n-    console.log('[Groups] loadState() complete - matchSelections:', matchSelections);\r\n+\r\n+    console.log('[Groups] loadState() complete - matchScores:', matchScores);\r\n   }\r\n \r\n   function getPlayerName(id: string) {\r\n     return players.find(p => p.id === id)?.name || 'Unknown';\r\n"
                }
            ],
            "date": 1763988763215,
            "name": "Commit-0",
            "content": "<script lang=\"ts\">\r\n  import { onMount } from 'svelte';\r\n  import { getState, submitMatch, generateBrackets } from '$lib/api';\r\n\r\n  let pods = $state([]) as any[];\r\n  let matches = $state([]) as any[];\r\n  let players = $state([]) as any[];\r\n  let tournamentState = $state('');\r\n  let currentRound = $state(1);\r\n\r\n  // Local state to track UI selections before submission\r\n  let matchSelections = $state({}) as Record<string, { [pid: string]: 'win' | 'loss' | 'tie' }>;\r\n  \r\n  // Reactive derived values using $derived\r\n  let currentRoundMatches = $derived(getMatchesForRound(currentRound));\r\n  let groupsWithPlayers = $derived(getGroupsWithPlayers());\r\n  let availableRounds = $derived([...new Set(matches.map(m => m.round))].sort((a, b) => a - b));\r\n  \r\n  // Debug logging with $effect\r\n  $effect(() => {\r\n    console.log('[Groups] Reactive update - currentRound:', currentRound);\r\n    console.log('[Groups] Reactive update - matches count:', matches.length);\r\n    console.log('[Groups] Reactive update - currentRoundMatches count:', currentRoundMatches.length);\r\n    console.log('[Groups] Reactive update - matchSelections:', matchSelections);\r\n    console.log('[Groups] Reactive update - pods:', pods.length);\r\n  });\r\n\r\n  async function loadState() {\r\n    console.log('[Groups] loadState() called');\r\n    const data = await getState(tournamentId);\r\n    console.log('[Groups] loadState() received data:', {\r\n      podsCount: data.pods.length,\r\n      matchesCount: data.matches.length,\r\n      playersCount: data.players.length,\r\n      state: data.state\r\n    });\r\n    \r\n    // With $state, direct assignment triggers reactivity\r\n    pods = data.pods;\r\n    matches = data.matches;\r\n    players = data.players;\r\n    tournamentState = data.state;\r\n    \r\n    // Initialize selections from existing results\r\n    matches.forEach(m => {\r\n        if (m.result) {\r\n            matchSelections[m.id] = {};\r\n            Object.entries(m.result).forEach(([pid, res]: [string, any]) => {\r\n                if (res.points === 3) matchSelections[m.id][pid] = 'win';\r\n                else if (res.points === 1) matchSelections[m.id][pid] = 'tie';\r\n                else matchSelections[m.id][pid] = 'loss';\r\n            });\r\n        }\r\n    });\r\n    \r\n    console.log('[Groups] loadState() complete - matchSelections:', matchSelections);\r\n  }\r\n\r\n  function getPlayerName(id: string) {\r\n    return players.find(p => p.id === id)?.name || 'Unknown';\r\n  }\r\n\r\n  function getPlayer(id: string) {\r\n    return players.find(p => p.id === id);\r\n  }\r\n\r\n  function getMatchForPod(podId: string) {\r\n    return matches.find(m => m.podId === podId);\r\n  }\r\n  \r\n  function getMatchesForPod(podId: string) {\r\n    return matches.filter(m => m.podId === podId);\r\n  }\r\n  \r\n  function getMatchesForRound(round: number) {\r\n    return matches.filter(m => m.round === round);\r\n  }\r\n  \r\n  function isRoundComplete(round: number) {\r\n    const roundMatches = getMatchesForRound(round);\r\n    return roundMatches.length > 0 && roundMatches.every(m => m.completed);\r\n  }\r\n  \r\n  function getMatchStatus(match: any) {\r\n    if (!match) return 'pending';\r\n    if (match.completed) return 'complete';\r\n    if (matchSelections[match.id]) return 'live';\r\n    return 'pending';\r\n  }\r\n\r\n  function setWinner(matchId: string, winnerId: string, loserId: string) {\r\n      console.log('[Groups] setWinner called:', { matchId, winnerId, loserId });\r\n      matchSelections[matchId] = {\r\n          [winnerId]: 'win',\r\n          [loserId]: 'loss'\r\n      };\r\n      console.log('[Groups] setWinner complete - matchSelections:', matchSelections);\r\n  }\r\n\r\n  function setTie(matchId: string, p1Id: string, p2Id: string) {\r\n      console.log('[Groups] setTie called:', { matchId, p1Id, p2Id });\r\n      matchSelections[matchId] = {\r\n          [p1Id]: 'tie',\r\n          [p2Id]: 'tie'\r\n      };\r\n      console.log('[Groups] setTie complete - matchSelections:', matchSelections);\r\n  }\r\n\r\n  async function submitMatchResult(matchId: string) {\r\n      console.log('[Groups] submitMatchResult called:', matchId);\r\n      const selection = matchSelections[matchId];\r\n      if (!selection) return;\r\n\r\n      const results: any = {};\r\n      Object.entries(selection).forEach(([pid, status]) => {\r\n          let points = 0;\r\n          if (status === 'win') points = 3;\r\n          if (status === 'tie') points = 1;\r\n          results[pid] = { points };\r\n      });\r\n\r\n      console.log('[Groups] submitMatchResult - submitting results:', results);\r\n      await submitMatch(matchId, results);\r\n      console.log('[Groups] submitMatchResult - match submitted, reloading state');\r\n      await loadState();\r\n      console.log('[Groups] submitMatchResult complete');\r\n  }\r\n\r\n  async function handleGenerateBrackets() {\r\n      if (confirm('Finish Group Stage and Generate Brackets?')) {\r\n          try {\r\n              console.log('[Groups] Generating brackets...');\r\n              await generateBrackets();\r\n              console.log('[Groups] Brackets generated, redirecting...');\r\n              window.location.href = '/brackets';\r\n          } catch (error) {\r\n              console.error('[Groups] Error generating brackets:', error);\r\n              alert('Failed to generate brackets. Check console for details.');\r\n          }\r\n      }\r\n  }\r\n\r\n  function getStandings() {\r\n    return [...players].sort((a, b) => {\r\n      if (b.points !== a.points) return b.points - a.points;\r\n      // Tiebreaker: goal difference, then wins\r\n      if (b.wins !== a.wins) return b.wins - a.wins;\r\n      return 0;\r\n    });\r\n  }\r\n\r\n  // Group players by their pod/group\r\n  function getGroupsWithPlayers() {\r\n    // Get unique pod IDs for round 1 to determine groups\r\n    const round1Pods = pods.filter(p => p.round === 1);\r\n    const groups: Record<string, any[]> = {};\r\n    \r\n    round1Pods.forEach(pod => {\r\n      const groupKey = pod.id;\r\n      if (!groups[groupKey]) groups[groupKey] = [];\r\n      \r\n      // Get players directly from pod.players\r\n      pod.players.forEach((pid: string) => {\r\n        const player = getPlayer(pid);\r\n        if (player && !groups[groupKey].find(p => p.id === pid)) {\r\n          groups[groupKey].push(player);\r\n        }\r\n      });\r\n    });\r\n    \r\n    // Sort players within each group by standings\r\n    Object.keys(groups).forEach(key => {\r\n      groups[key].sort((a, b) => {\r\n        if (b.points !== a.points) return b.points - a.points;\r\n        if (b.wins !== a.wins) return b.wins - a.wins;\r\n        return 0;\r\n      });\r\n    });\r\n    \r\n    return groups;\r\n  }\r\n\r\n  onMount(loadState);\r\n</script>\r\n\r\n<div class=\"min-h-screen bg-gradient-to-br from-space-900 via-space-800 to-space-900 text-gaming-text px-3 py-3\">\r\n  <div class=\"max-w-7xl mx-auto\">\r\n    \r\n    <!-- Header -->\r\n    <div class=\"flex justify-between items-center mb-3\">\r\n      <div>\r\n        <a href=\"/\" class=\"text-gray-400 hover:text-cyber-green transition-colors mb-1 inline-block text-xs flex items-center gap-1\">\r\n          <svg class=\"w-3 h-3\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\"><path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M10 19l-7-7m0 0l7-7m-7 7h18\"/></svg>\r\n          Back\r\n        </a>\r\n        <h1 class=\"text-xl font-black gradient-text flex items-center gap-1.5\">\r\n          <svg class=\"w-5 h-5 text-cyber-pink\" fill=\"currentColor\" viewBox=\"0 0 20 20\"><path fill-rule=\"evenodd\" d=\"M12.395 2.553a1 1 0 00-1.45-.385c-.345.23-.614.558-.822.88-.214.33-.403.713-.57 1.116-.334.804-.614 1.768-.84 2.734a31.365 31.365 0 00-.613 3.58 2.64 2.64 0 01-.945-1.067c-.328-.68-.398-1.534-.398-2.654A1 1 0 005.05 6.05 6.981 6.981 0 003 11a7 7 0 1011.95-4.95c-.592-.591-.98-.985-1.348-1.467-.363-.476-.724-1.063-1.207-2.03zM12.12 15.12A3 3 0 017 13s.879.5 2.5.5c0-1 .5-4 1.25-4.5.5 1 .786 1.293 1.371 1.879A2.99 2.99 0 0113 13a2.99 2.99 0 01-.879 2.121z\" clip-rule=\"evenodd\"/></svg>\r\n          GROUP STAGE • R{currentRound}/3\r\n        </h1>\r\n      </div>\r\n      \r\n      {#if tournamentState === 'group' && matches.every(m => m.completed)}\r\n        <button \r\n          onclick={handleGenerateBrackets}\r\n          class=\"bg-gradient-to-r from-cyber-pink to-purple-600 text-white font-bold text-xs py-1.5 px-4 rounded-lg shadow-glow-pink hover:scale-105 transition-transform flex items-center gap-1.5\"\r\n        >\r\n          Playoffs\r\n          <svg class=\"w-3 h-3\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\"><path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M13 7l5 5m0 0l-5 5m5-5H6\"/></svg>\r\n        </button>\r\n      {/if}\r\n    </div>\r\n\r\n    <!-- Round Progress -->\r\n    <div class=\"glass rounded-lg p-2 mb-3\">\r\n      <div class=\"flex items-center gap-2\">\r\n        {#each availableRounds as round}\r\n          <button \r\n            onclick={() => currentRound = round}\r\n            class=\"flex-1 flex items-center justify-center gap-1.5 py-1.5 px-2 rounded {currentRound === round ? 'bg-cyber-green/20 text-cyber-green' : 'text-gray-500 hover:bg-space-700'} transition-all\"\r\n          >\r\n            <div class=\"w-6 h-6 rounded-full border {isRoundComplete(round) ? 'bg-cyber-green border-cyber-green text-space-900' : currentRound === round ? 'border-cyber-green' : 'border-gray-600'} flex items-center justify-center font-bold text-xs\">\r\n              {#if isRoundComplete(round)}\r\n                <svg class=\"w-3 h-3\" fill=\"currentColor\" viewBox=\"0 0 20 20\"><path fill-rule=\"evenodd\" d=\"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z\" clip-rule=\"evenodd\"/></svg>\r\n              {:else}\r\n                {round}\r\n              {/if}\r\n            </div>\r\n            <span class=\"font-bold text-xs\">R{round}</span>\r\n          </button>\r\n        {/each}\r\n      </div>\r\n    </div>\r\n\r\n    <!-- Group Tables Section -->\r\n    <div class=\"mb-4\">\r\n      <h2 class=\"text-base font-bold mb-2 text-white flex items-center gap-1.5\">\r\n        <svg class=\"w-4 h-4 text-cyber-blue\" fill=\"currentColor\" viewBox=\"0 0 20 20\"><path d=\"M2 11a1 1 0 011-1h2a1 1 0 011 1v5a1 1 0 01-1 1H3a1 1 0 01-1-1v-5zM8 7a1 1 0 011-1h2a1 1 0 011 1v9a1 1 0 01-1 1H9a1 1 0 01-1-1V7zM14 4a1 1 0 011-1h2a1 1 0 011 1v12a1 1 0 01-1 1h-2a1 1 0 01-1-1V4z\"/></svg>\r\n        Group Tables\r\n      </h2>\r\n      <div class=\"grid grid-cols-1 md:grid-cols-2 gap-3\">\r\n        {#each Object.entries(groupsWithPlayers) as [groupId, groupPlayers] (groupId)}\r\n          <div class=\"glass rounded-lg p-2\">\r\n            <h3 class=\"text-xs font-bold text-cyber-blue mb-1.5 px-2\">Group {groupId}</h3>\r\n            <table class=\"w-full text-xs\">\r\n              <thead>\r\n                <tr class=\"border-b border-space-600\">\r\n                  <th class=\"text-left py-1 px-1 text-gray-400 font-bold text-xs\">#</th>\r\n                  <th class=\"text-left py-1 px-1 text-gray-400 font-bold text-xs\">Player</th>\r\n                  <th class=\"text-center py-1 px-1 text-gray-400 font-bold text-xs\">P</th>\r\n                  <th class=\"text-center py-1 px-1 text-gray-400 font-bold text-xs\">W</th>\r\n                  <th class=\"text-center py-1 px-1 text-gray-400 font-bold text-xs\">D</th>\r\n                  <th class=\"text-center py-1 px-1 text-gray-400 font-bold text-xs\">L</th>\r\n                  <th class=\"text-center py-1 px-1 text-gray-400 font-bold text-xs\">Pts</th>\r\n                </tr>\r\n              </thead>\r\n              <tbody>\r\n                {#each groupPlayers as player, index (player.id)}\r\n                  <tr class=\"border-b border-space-700/50 hover:bg-space-700/30 transition-colors\">\r\n                    <td class=\"py-1 px-1\">\r\n                      <div class=\"w-4 h-4 rounded-full flex items-center justify-center font-bold text-xs {index === 0 ? 'bg-gradient-to-br from-yellow-400 to-yellow-600 text-space-900' : index === 1 ? 'bg-gradient-to-br from-gray-300 to-gray-500 text-space-900' : 'bg-space-600 text-gray-400'}\">\r\n                        {index + 1}\r\n                      </div>\r\n                    </td>\r\n                    <td class=\"py-1 px-1 font-bold text-white text-xs\">{player.name}</td>\r\n                    <td class=\"text-center py-1 px-1 text-gray-400\">{(player.wins || 0) + (player.draws || 0) + (player.losses || 0)}</td>\r\n                    <td class=\"text-center py-1 px-1 text-cyber-green font-bold\">{player.wins || 0}</td>\r\n                    <td class=\"text-center py-1 px-1 text-yellow-500 font-bold\">{player.draws || 0}</td>\r\n                    <td class=\"text-center py-1 px-1 text-red-400 font-bold\">{player.losses || 0}</td>\r\n                    <td class=\"text-center py-1 px-1 text-cyber-green font-black\">{player.points || 0}</td>\r\n                  </tr>\r\n                {/each}\r\n              </tbody>\r\n            </table>\r\n          </div>\r\n        {/each}\r\n      </div>\r\n    </div>\r\n\r\n    <!-- Matches Section -->\r\n    <div>\r\n      <h2 class=\"text-base font-bold mb-2 text-white\">Round {currentRound} Matches</h2>\r\n      <div class=\"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-2\">\r\n        {#each currentRoundMatches as match (match.id)}\r\n          {@const player1 = getPlayer(match.player1Id)}\r\n          {@const player2 = getPlayer(match.player2Id)}\r\n          {@const status = getMatchStatus(match)}\r\n            \r\n            <div class=\"glass rounded-lg p-2 relative\">\r\n              <!-- Status Badge -->\r\n              <div class=\"absolute top-1.5 right-1.5 flex items-center gap-0.5 px-1.5 py-0.5 rounded text-xs font-bold {status === 'complete' ? 'bg-cyber-green/20 text-cyber-green' : status === 'live' ? 'bg-yellow-500/20 text-yellow-500' : 'bg-gray-500/20 text-gray-400'}\">\r\n                {#if status === 'complete'}\r\n                  <svg class=\"w-2.5 h-2.5\" fill=\"currentColor\" viewBox=\"0 0 20 20\"><path fill-rule=\"evenodd\" d=\"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z\" clip-rule=\"evenodd\"/></svg>\r\n                  Done\r\n                {:else if status === 'live'}\r\n                  <svg class=\"w-2.5 h-2.5\" fill=\"currentColor\" viewBox=\"0 0 20 20\"><path fill-rule=\"evenodd\" d=\"M11.3 1.046A1 1 0 0112 2v5h4a1 1 0 01.82 1.573l-7 10A1 1 0 018 18v-5H4a1 1 0 01-.82-1.573l7-10a1 1 0 011.12-.38z\" clip-rule=\"evenodd\"/></svg>\r\n                  Live\r\n                {:else}\r\n                  Pending\r\n                {/if}\r\n              </div>\r\n\r\n              <div class=\"space-y-1.5\">\r\n                <!-- Player 1 -->\r\n                <div class=\"p-2 rounded bg-space-700/50 {matchSelections[match.id]?.[match.player1Id] === 'win' ? 'ring-1 ring-cyber-green' : matchSelections[match.id]?.[match.player1Id] === 'loss' ? 'opacity-60' : ''} transition-all\">\r\n                  <div class=\"flex items-center justify-between mb-1.5\">\r\n                    <div class=\"flex items-center gap-2\">\r\n                      <div class=\"w-6 h-6 rounded-full bg-gradient-to-br from-cyan-500 to-blue-500 flex items-center justify-center\">\r\n                        <svg class=\"w-3.5 h-3.5 text-white\" fill=\"currentColor\" viewBox=\"0 0 20 20\"><path fill-rule=\"evenodd\" d=\"M10 9a3 3 0 100-6 3 3 0 000 6zm-7 9a7 7 0 1114 0H3z\" clip-rule=\"evenodd\"/></svg>\r\n                      </div>\r\n                      <div>\r\n                        <div class=\"font-bold text-xs text-white\">{player1?.name || 'Unknown'}</div>\r\n                        <div class=\"text-xs text-gray-400\">{player1?.points || 0}pts</div>\r\n                      </div>\r\n                    </div>\r\n                    {#if matchSelections[match.id]?.[match.player1Id] === 'win'}\r\n                      <svg class=\"w-4 h-4 text-cyber-green\" fill=\"currentColor\" viewBox=\"0 0 20 20\"><path d=\"M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z\"/></svg>\r\n                    {/if}\r\n                  </div>\r\n                  \r\n                  {#if !match.completed}\r\n                    <button \r\n                      onclick={() => setWinner(match.id, match.player1Id, match.player2Id)}\r\n                      class=\"w-full py-1 px-2 text-xs rounded font-bold transition-all {matchSelections[match.id]?.[match.player1Id] === 'win' ? 'bg-gradient-to-r from-cyber-green to-emerald-500 text-space-900' : 'bg-space-600 hover:bg-cyber-green/20 text-gray-300 hover:text-cyber-green'}\"\r\n                    >\r\n                      {matchSelections[match.id]?.[match.player1Id] === 'win' ? '✓ Winner' : 'Winner'}\r\n                    </button>\r\n                  {/if}\r\n                </div>\r\n\r\n                <!-- Tie Button -->\r\n                {#if !match.completed}\r\n                  <button \r\n                    onclick={() => setTie(match.id, match.player1Id, match.player2Id)}\r\n                    class=\"w-full py-0.5 text-xs rounded font-bold transition-all {matchSelections[match.id]?.[match.player1Id] === 'tie' ? 'bg-gradient-to-r from-yellow-400 to-yellow-600 text-space-900' : 'bg-space-700 hover:bg-yellow-500/20 text-gray-300 hover:text-yellow-500'}\"\r\n                  >\r\n                    {matchSelections[match.id]?.[match.player1Id] === 'tie' ? '✓ Tie' : 'Tie'}\r\n                  </button>\r\n                {/if}\r\n\r\n                <!-- Player 2 -->\r\n                <div class=\"p-2 rounded bg-space-700/50 {matchSelections[match.id]?.[match.player2Id] === 'win' ? 'ring-1 ring-cyber-green' : matchSelections[match.id]?.[match.player2Id] === 'loss' ? 'opacity-60' : ''} transition-all\">\r\n                  <div class=\"flex items-center justify-between mb-1.5\">\r\n                    <div class=\"flex items-center gap-2\">\r\n                      <div class=\"w-6 h-6 rounded-full bg-gradient-to-br from-purple-500 to-pink-500 flex items-center justify-center\">\r\n                        <svg class=\"w-3.5 h-3.5 text-white\" fill=\"currentColor\" viewBox=\"0 0 20 20\"><path fill-rule=\"evenodd\" d=\"M10 9a3 3 0 100-6 3 3 0 000 6zm-7 9a7 7 0 1114 0H3z\" clip-rule=\"evenodd\"/></svg>\r\n                      </div>\r\n                      <div>\r\n                        <div class=\"font-bold text-xs text-white\">{player2?.name || 'Unknown'}</div>\r\n                        <div class=\"text-xs text-gray-400\">{player2?.points || 0}pts</div>\r\n                      </div>\r\n                    </div>\r\n                    {#if matchSelections[match.id]?.[match.player2Id] === 'win'}\r\n                      <svg class=\"w-4 h-4 text-cyber-green\" fill=\"currentColor\" viewBox=\"0 0 20 20\"><path d=\"M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z\"/></svg>\r\n                    {/if}\r\n                  </div>\r\n                  \r\n                  {#if !match.completed}\r\n                    <button \r\n                      onclick={() => setWinner(match.id, match.player2Id, match.player1Id)}\r\n                      class=\"w-full py-1 px-2 text-xs rounded font-bold transition-all {matchSelections[match.id]?.[match.player2Id] === 'win' ? 'bg-gradient-to-r from-cyber-green to-emerald-500 text-space-900' : 'bg-space-600 hover:bg-cyber-green/20 text-gray-300 hover:text-cyber-green'}\"\r\n                    >\r\n                      {matchSelections[match.id]?.[match.player2Id] === 'win' ? '✓ Winner' : 'Winner'}\r\n                    </button>\r\n                  {/if}\r\n                </div>\r\n              </div>\r\n\r\n              <!-- Submit Button -->\r\n              {#if !match.completed && (matchSelections[match.id]?.[match.player1Id] || matchSelections[match.id]?.[match.player2Id])}\r\n                <div class=\"mt-1.5\">\r\n                  <button \r\n                    onclick={() => submitMatchResult(match.id)}\r\n                    class=\"w-full bg-gradient-to-r from-cyber-blue to-blue-600 text-white font-bold py-1.5 px-3 rounded text-xs hover:scale-102 transition-all\"\r\n                  >\r\n                    Submit Result\r\n                  </button>\r\n                </div>\r\n              {/if}\r\n            </div>\r\n        {/each}\r\n      </div>\r\n    </div>\r\n  </div>\r\n</div>\r\n"
        }
    ]
}